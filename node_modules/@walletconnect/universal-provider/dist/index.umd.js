(function(Un,wt){typeof exports=="object"&&typeof module<"u"?wt(exports):typeof define=="function"&&define.amd?define(["exports"],wt):(Un=typeof globalThis<"u"?globalThis:Un||self,wt(Un["@walletconnect/universal-provider"]={}))})(this,function(Un){"use strict";var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function $n(n){var e=n.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}),t}var Qt={exports:{}},ci=typeof Reflect=="object"?Reflect:null,Zc=ci&&typeof ci.apply=="function"?ci.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Ps;ci&&typeof ci.ownKeys=="function"?Ps=ci.ownKeys:Object.getOwnPropertySymbols?Ps=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ps=function(e){return Object.getOwnPropertyNames(e)};function bg(n){console&&console.warn&&console.warn(n)}var Qc=Number.isNaN||function(e){return e!==e};function st(){st.init.call(this)}Qt.exports=st,Qt.exports.once=Sg,st.EventEmitter=st,st.prototype._events=void 0,st.prototype._eventsCount=0,st.prototype._maxListeners=void 0;var ef=10;function Cs(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(st,"defaultMaxListeners",{enumerable:!0,get:function(){return ef},set:function(n){if(typeof n!="number"||n<0||Qc(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");ef=n}}),st.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},st.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Qc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function tf(n){return n._maxListeners===void 0?st.defaultMaxListeners:n._maxListeners}st.prototype.getMaxListeners=function(){return tf(this)},st.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var o=e==="error",u=this._events;if(u!==void 0)o=o&&u.error===void 0;else if(!o)return!1;if(o){var h;if(t.length>0&&(h=t[0]),h instanceof Error)throw h;var l=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw l.context=h,l}var _=u[e];if(_===void 0)return!1;if(typeof _=="function")Zc(_,this,t);else for(var p=_.length,E=af(_,p),s=0;s<p;++s)Zc(E[s],this,t);return!0};function rf(n,e,t,s){var o,u,h;if(Cs(t),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),u=n._events),h=u[e]),h===void 0)h=u[e]=t,++n._eventsCount;else if(typeof h=="function"?h=u[e]=s?[t,h]:[h,t]:s?h.unshift(t):h.push(t),o=tf(n),o>0&&h.length>o&&!h.warned){h.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=n,l.type=e,l.count=h.length,bg(l)}return n}st.prototype.addListener=function(e,t){return rf(this,e,t,!1)},st.prototype.on=st.prototype.addListener,st.prototype.prependListener=function(e,t){return rf(this,e,t,!0)};function wg(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function nf(n,e,t){var s={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},o=wg.bind(s);return o.listener=t,s.wrapFn=o,o}st.prototype.once=function(e,t){return Cs(t),this.on(e,nf(this,e,t)),this},st.prototype.prependOnceListener=function(e,t){return Cs(t),this.prependListener(e,nf(this,e,t)),this},st.prototype.removeListener=function(e,t){var s,o,u,h,l;if(Cs(t),o=this._events,o===void 0)return this;if(s=o[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(u=-1,h=s.length-1;h>=0;h--)if(s[h]===t||s[h].listener===t){l=s[h].listener,u=h;break}if(u<0)return this;u===0?s.shift():mg(s,u),s.length===1&&(o[e]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this},st.prototype.off=st.prototype.removeListener,st.prototype.removeAllListeners=function(e){var t,s,o;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var u=Object.keys(s),h;for(o=0;o<u.length;++o)h=u[o],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function sf(n,e,t){var s=n._events;if(s===void 0)return[];var o=s[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?Eg(o):af(o,o.length)}st.prototype.listeners=function(e){return sf(this,e,!0)},st.prototype.rawListeners=function(e){return sf(this,e,!1)},st.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):of.call(n,e)},st.prototype.listenerCount=of;function of(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}st.prototype.eventNames=function(){return this._eventsCount>0?Ps(this._events):[]};function af(n,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=n[s];return t}function mg(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function Eg(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function Sg(n,e){return new Promise(function(t,s){function o(h){n.removeListener(e,u),s(h)}function u(){typeof n.removeListener=="function"&&n.removeListener("error",o),t([].slice.call(arguments))}uf(n,e,u,{once:!0}),e!=="error"&&Dg(n,o,{once:!0})})}function Dg(n,e,t){typeof n.on=="function"&&uf(n,"error",e,t)}function uf(n,e,t,s){if(typeof n.on=="function")s.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function o(u){s.once&&n.removeEventListener(e,o),t(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var Ts={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ua=function(n,e){return ua=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ua(n,e)};function xg(n,e){ua(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ca=function(){return ca=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},ca.apply(this,arguments)};function Og(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Ig(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(h=n[l])&&(u=(o<3?h(u):o>3?h(e,t,u):h(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function Ag(n,e){return function(t,s){e(t,s,n)}}function Pg(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Cg(n,e,t,s){function o(u){return u instanceof t?u:new t(function(h){h(u)})}return new(t||(t=Promise))(function(u,h){function l(E){try{p(s.next(E))}catch(C){h(C)}}function _(E){try{p(s.throw(E))}catch(C){h(C)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function Tg(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Rg(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function Ng(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function fa(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){h={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return u}function Lg(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(cf(arguments[e]));return n}function Fg(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],h=0,l=u.length;h<l;h++,o++)s[o]=u[h];return s}function Bi(n){return this instanceof Bi?(this.v=n,this):new Bi(n)}function Ug(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){s[D]&&(o[D]=function(T){return new Promise(function(R,q){u.push([D,T,R,q])>1||l(D,T)})})}function l(D,T){try{_(s[D](T))}catch(R){C(u[0][3],R)}}function _(D){D.value instanceof Bi?Promise.resolve(D.value.v).then(p,E):C(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function C(D,T){D(T),u.shift(),u.length&&l(u[0][0],u[0][1])}}function $g(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(h){return(t=!t)?{value:Bi(n[o](h)),done:o==="return"}:u?u(h):h}:u}}function Mg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof fa=="function"?fa(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(h){return new Promise(function(l,_){h=n[u](h),o(l,_,h.done,h.value)})}}function o(u,h,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},h)}}function Bg(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function Hg(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function jg(n){return n&&n.__esModule?n:{default:n}}function qg(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function zg(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var Kg=Object.freeze({__proto__:null,__extends:xg,get __assign(){return ca},__rest:Og,__decorate:Ig,__param:Ag,__metadata:Pg,__awaiter:Cg,__generator:Tg,__createBinding:Rg,__exportStar:Ng,__values:fa,__read:cf,__spread:Lg,__spreadArrays:Fg,__await:Bi,__asyncGenerator:Ug,__asyncDelegator:$g,__asyncValues:Mg,__makeTemplateObject:Bg,__importStar:Hg,__importDefault:jg,__classPrivateFieldGet:qg,__classPrivateFieldSet:zg}),ff=$n(Kg),Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});function Gg(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return JSON.parse(n)}catch{return n}}Hi.safeJsonParse=Gg;function Wg(n){return typeof n=="string"?n:JSON.stringify(n,(e,t)=>typeof t>"u"?null:t)}Hi.safeJsonStringify=Wg;var ji={exports:{}},hf;function Vg(){return hf||(hf=1,function(){let n;function e(){}n=e,n.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},n.prototype.setItem=function(t,s){this[t]=String(s)},n.prototype.removeItem=function(t){delete this[t]},n.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},n.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof wt<"u"&&wt.localStorage?ji.exports=wt.localStorage:typeof window<"u"&&window.localStorage?ji.exports=window.localStorage:ji.exports=new e}()),ji.exports}var ha={},qi={},lf;function Yg(){if(lf)return qi;lf=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.IKeyValueStorage=void 0;class n{}return qi.IKeyValueStorage=n,qi}var zi={},df;function kg(){if(df)return zi;df=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.parseEntry=void 0;const n=Hi;function e(t){var s;return[t[0],n.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return zi.parseEntry=e,zi}var pf;function Jg(){return pf||(pf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=ff;e.__exportStar(Yg(),n),e.__exportStar(kg(),n)}(ha)),ha}Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.KeyValueStorage=void 0;const fi=ff,gf=Hi,Xg=fi.__importDefault(Vg()),Zg=Jg();class _f{constructor(){this.localStorage=Xg.default}getKeys(){return fi.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return fi.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Zg.parseEntry)})}getItem(e){return fi.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return gf.safeJsonParse(t)})}setItem(e,t){return fi.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,gf.safeJsonStringify(t))})}removeItem(e){return fi.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Ts.KeyValueStorage=_f;var Qg=Ts.default=_f,Ki={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var la=function(n,e){return la=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},la(n,e)};function e0(n,e){la(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var da=function(){return da=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},da.apply(this,arguments)};function t0(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function r0(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(h=n[l])&&(u=(o<3?h(u):o>3?h(e,t,u):h(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function n0(n,e){return function(t,s){e(t,s,n)}}function i0(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function s0(n,e,t,s){function o(u){return u instanceof t?u:new t(function(h){h(u)})}return new(t||(t=Promise))(function(u,h){function l(E){try{p(s.next(E))}catch(C){h(C)}}function _(E){try{p(s.throw(E))}catch(C){h(C)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function o0(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function a0(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function u0(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function pa(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function yf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){h={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return u}function c0(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(yf(arguments[e]));return n}function f0(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],h=0,l=u.length;h<l;h++,o++)s[o]=u[h];return s}function Gi(n){return this instanceof Gi?(this.v=n,this):new Gi(n)}function h0(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){s[D]&&(o[D]=function(T){return new Promise(function(R,q){u.push([D,T,R,q])>1||l(D,T)})})}function l(D,T){try{_(s[D](T))}catch(R){C(u[0][3],R)}}function _(D){D.value instanceof Gi?Promise.resolve(D.value.v).then(p,E):C(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function C(D,T){D(T),u.shift(),u.length&&l(u[0][0],u[0][1])}}function l0(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(h){return(t=!t)?{value:Gi(n[o](h)),done:o==="return"}:u?u(h):h}:u}}function d0(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof pa=="function"?pa(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(h){return new Promise(function(l,_){h=n[u](h),o(l,_,h.done,h.value)})}}function o(u,h,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},h)}}function p0(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function g0(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function _0(n){return n&&n.__esModule?n:{default:n}}function y0(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function v0(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var b0=Object.freeze({__proto__:null,__extends:e0,get __assign(){return da},__rest:t0,__decorate:r0,__param:n0,__metadata:i0,__awaiter:s0,__generator:o0,__createBinding:a0,__exportStar:u0,__values:pa,__read:yf,__spread:c0,__spreadArrays:f0,__await:Gi,__asyncGenerator:h0,__asyncDelegator:l0,__asyncValues:d0,__makeTemplateObject:p0,__importStar:g0,__importDefault:_0,__classPrivateFieldGet:y0,__classPrivateFieldSet:v0}),Rs=$n(b0),Wi={},ye={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ga=function(n,e){return ga=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ga(n,e)};function w0(n,e){ga(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var _a=function(){return _a=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},_a.apply(this,arguments)};function m0(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function E0(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(h=n[l])&&(u=(o<3?h(u):o>3?h(e,t,u):h(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function S0(n,e){return function(t,s){e(t,s,n)}}function D0(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function x0(n,e,t,s){function o(u){return u instanceof t?u:new t(function(h){h(u)})}return new(t||(t=Promise))(function(u,h){function l(E){try{p(s.next(E))}catch(C){h(C)}}function _(E){try{p(s.throw(E))}catch(C){h(C)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function O0(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function I0(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function A0(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function ya(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function vf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){h={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return u}function P0(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(vf(arguments[e]));return n}function C0(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],h=0,l=u.length;h<l;h++,o++)s[o]=u[h];return s}function Vi(n){return this instanceof Vi?(this.v=n,this):new Vi(n)}function T0(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){s[D]&&(o[D]=function(T){return new Promise(function(R,q){u.push([D,T,R,q])>1||l(D,T)})})}function l(D,T){try{_(s[D](T))}catch(R){C(u[0][3],R)}}function _(D){D.value instanceof Vi?Promise.resolve(D.value.v).then(p,E):C(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function C(D,T){D(T),u.shift(),u.length&&l(u[0][0],u[0][1])}}function R0(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(h){return(t=!t)?{value:Vi(n[o](h)),done:o==="return"}:u?u(h):h}:u}}function N0(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ya=="function"?ya(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(h){return new Promise(function(l,_){h=n[u](h),o(l,_,h.done,h.value)})}}function o(u,h,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},h)}}function L0(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function F0(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function U0(n){return n&&n.__esModule?n:{default:n}}function $0(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function M0(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var B0=Object.freeze({__proto__:null,__extends:w0,get __assign(){return _a},__rest:m0,__decorate:E0,__param:S0,__metadata:D0,__awaiter:x0,__generator:O0,__createBinding:I0,__exportStar:A0,__values:ya,__read:vf,__spread:P0,__spreadArrays:C0,__await:Vi,__asyncGenerator:T0,__asyncDelegator:R0,__asyncValues:N0,__makeTemplateObject:L0,__importStar:F0,__importDefault:U0,__classPrivateFieldGet:$0,__classPrivateFieldSet:M0}),Ns=$n(B0),va={},Yi={},bf;function H0(){if(bf)return Yi;bf=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.delay=void 0;function n(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return Yi.delay=n,Yi}var Mn={},ba={},Bn={},wf;function j0(){return wf||(wf=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.ONE_THOUSAND=Bn.ONE_HUNDRED=void 0,Bn.ONE_HUNDRED=100,Bn.ONE_THOUSAND=1e3),Bn}var wa={},mf;function q0(){return mf||(mf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0,n.ONE_SECOND=1,n.FIVE_SECONDS=5,n.TEN_SECONDS=10,n.THIRTY_SECONDS=30,n.SIXTY_SECONDS=60,n.ONE_MINUTE=n.SIXTY_SECONDS,n.FIVE_MINUTES=n.ONE_MINUTE*5,n.TEN_MINUTES=n.ONE_MINUTE*10,n.THIRTY_MINUTES=n.ONE_MINUTE*30,n.SIXTY_MINUTES=n.ONE_MINUTE*60,n.ONE_HOUR=n.SIXTY_MINUTES,n.THREE_HOURS=n.ONE_HOUR*3,n.SIX_HOURS=n.ONE_HOUR*6,n.TWELVE_HOURS=n.ONE_HOUR*12,n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24,n.ONE_DAY=n.TWENTY_FOUR_HOURS,n.THREE_DAYS=n.ONE_DAY*3,n.FIVE_DAYS=n.ONE_DAY*5,n.SEVEN_DAYS=n.ONE_DAY*7,n.THIRTY_DAYS=n.ONE_DAY*30,n.ONE_WEEK=n.SEVEN_DAYS,n.TWO_WEEKS=n.ONE_WEEK*2,n.THREE_WEEKS=n.ONE_WEEK*3,n.FOUR_WEEKS=n.ONE_WEEK*4,n.ONE_YEAR=n.ONE_DAY*365}(wa)),wa}var Ef;function Sf(){return Ef||(Ef=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(j0(),n),e.__exportStar(q0(),n)}(ba)),ba}var Df;function z0(){if(Df)return Mn;Df=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.fromMiliseconds=Mn.toMiliseconds=void 0;const n=Sf();function e(s){return s*n.ONE_THOUSAND}Mn.toMiliseconds=e;function t(s){return Math.floor(s/n.ONE_THOUSAND)}return Mn.fromMiliseconds=t,Mn}var xf;function K0(){return xf||(xf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(H0(),n),e.__exportStar(z0(),n)}(va)),va}var hi={},Of;function G0(){if(Of)return hi;Of=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Watch=void 0;class n{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return hi.Watch=n,hi.default=n,hi}var ma={},ki={},If;function W0(){if(If)return ki;If=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.IWatch=void 0;class n{}return ki.IWatch=n,ki}var Af;function V0(){return Af||(Af=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Ns.__exportStar(W0(),n)}(ma)),ma}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Ns;e.__exportStar(K0(),n),e.__exportStar(G0(),n),e.__exportStar(V0(),n),e.__exportStar(Sf(),n)})(ye);var Ea={},Ji={};class Hn{}var Y0=Object.freeze({__proto__:null,IEvents:Hn}),k0=$n(Y0),Pf;function J0(){if(Pf)return Ji;Pf=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.IHeartBeat=void 0;const n=k0;class e extends n.IEvents{constructor(s){super()}}return Ji.IHeartBeat=e,Ji}var Cf;function Tf(){return Cf||(Cf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rs.__exportStar(J0(),n)}(Ea)),Ea}var Sa={},jn={},Rf;function X0(){if(Rf)return jn;Rf=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.HEARTBEAT_EVENTS=jn.HEARTBEAT_INTERVAL=void 0;const n=ye;return jn.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,jn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},jn}var Nf;function Lf(){return Nf||(Nf=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rs.__exportStar(X0(),n)}(Sa)),Sa}var Ff;function Z0(){if(Ff)return Wi;Ff=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.HeartBeat=void 0;const n=Rs,e=Qt.exports,t=ye,s=Tf(),o=Lf();class u extends s.IHeartBeat{constructor(l){super(l),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=l?.interval||o.HEARTBEAT_INTERVAL}static init(l){return n.__awaiter(this,void 0,void 0,function*(){const _=new u(l);return yield _.init(),_})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(l,_){this.events.on(l,_)}once(l,_){this.events.once(l,_)}off(l,_){this.events.off(l,_)}removeListener(l,_){this.events.removeListener(l,_)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Wi.HeartBeat=u,Wi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=Rs;e.__exportStar(Z0(),n),e.__exportStar(Tf(),n),e.__exportStar(Lf(),n)})(Ki);var Je={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Da=function(n,e){return Da=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Da(n,e)};function Q0(n,e){Da(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xa=function(){return xa=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},xa.apply(this,arguments)};function e_(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function t_(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(h=n[l])&&(u=(o<3?h(u):o>3?h(e,t,u):h(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function r_(n,e){return function(t,s){e(t,s,n)}}function n_(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function i_(n,e,t,s){function o(u){return u instanceof t?u:new t(function(h){h(u)})}return new(t||(t=Promise))(function(u,h){function l(E){try{p(s.next(E))}catch(C){h(C)}}function _(E){try{p(s.throw(E))}catch(C){h(C)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function s_(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function o_(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function a_(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Oa(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Uf(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){h={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return u}function u_(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Uf(arguments[e]));return n}function c_(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],h=0,l=u.length;h<l;h++,o++)s[o]=u[h];return s}function Xi(n){return this instanceof Xi?(this.v=n,this):new Xi(n)}function f_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){s[D]&&(o[D]=function(T){return new Promise(function(R,q){u.push([D,T,R,q])>1||l(D,T)})})}function l(D,T){try{_(s[D](T))}catch(R){C(u[0][3],R)}}function _(D){D.value instanceof Xi?Promise.resolve(D.value.v).then(p,E):C(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function C(D,T){D(T),u.shift(),u.length&&l(u[0][0],u[0][1])}}function h_(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(h){return(t=!t)?{value:Xi(n[o](h)),done:o==="return"}:u?u(h):h}:u}}function l_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Oa=="function"?Oa(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(h){return new Promise(function(l,_){h=n[u](h),o(l,_,h.done,h.value)})}}function o(u,h,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},h)}}function d_(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function p_(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function g_(n){return n&&n.__esModule?n:{default:n}}function __(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function y_(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var v_=Object.freeze({__proto__:null,__extends:Q0,get __assign(){return xa},__rest:e_,__decorate:t_,__param:r_,__metadata:n_,__awaiter:i_,__generator:s_,__createBinding:o_,__exportStar:a_,__values:Oa,__read:Uf,__spread:u_,__spreadArrays:c_,__await:Xi,__asyncGenerator:f_,__asyncDelegator:h_,__asyncValues:l_,__makeTemplateObject:d_,__importStar:p_,__importDefault:g_,__classPrivateFieldGet:__,__classPrivateFieldSet:y_}),b_=$n(v_),Ia,$f;function w_(){if($f)return Ia;$f=1;function n(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Ia=e;function e(t,s,o){var u=o&&o.stringify||n,h=1;if(typeof t=="object"&&t!==null){var l=s.length+h;if(l===1)return t;var _=new Array(l);_[0]=u(t);for(var p=1;p<l;p++)_[p]=u(s[p]);return _.join(" ")}if(typeof t!="string")return t;var E=s.length;if(E===0)return t;for(var C="",D=1-h,T=-1,R=t&&t.length||0,q=0;q<R;){if(t.charCodeAt(q)===37&&q+1<R){switch(T=T>-1?T:0,t.charCodeAt(q+1)){case 100:case 102:if(D>=E||s[D]==null)break;T<q&&(C+=t.slice(T,q)),C+=Number(s[D]),T=q+2,q++;break;case 105:if(D>=E||s[D]==null)break;T<q&&(C+=t.slice(T,q)),C+=Math.floor(Number(s[D])),T=q+2,q++;break;case 79:case 111:case 106:if(D>=E||s[D]===void 0)break;T<q&&(C+=t.slice(T,q));var K=typeof s[D];if(K==="string"){C+="'"+s[D]+"'",T=q+2,q++;break}if(K==="function"){C+=s[D].name||"<anonymous>",T=q+2,q++;break}C+=u(s[D]),T=q+2,q++;break;case 115:if(D>=E)break;T<q&&(C+=t.slice(T,q)),C+=String(s[D]),T=q+2,q++;break;case 37:T<q&&(C+=t.slice(T,q)),C+="%",T=q+2,q++,D--;break}++D}++q}return T===-1?t:(T<R&&(C+=t.slice(T)),C)}return Ia}var Aa,Mf;function m_(){if(Mf)return Aa;Mf=1;const n=w_();Aa=o;const e=P().console||{},t={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:q,wrapResponseSerializer:q,wrapErrorSerializer:q,req:R,res:R,err:D};function s(m,c){return Array.isArray(m)?m.filter(function(V){return V!=="!stdSerializers.err"}):m===!0?Object.keys(c):!1}function o(m){m=m||{},m.browser=m.browser||{};const c=m.browser.transmit;if(c&&typeof c.send!="function")throw Error("pino: transmit option must have a send function");const b=m.browser.write||e;m.browser.write&&(m.browser.asObject=!0);const V=m.serializers||{},k=s(m.browser.serialize,V);let ie=m.browser.serialize;Array.isArray(m.browser.serialize)&&m.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ie=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof b=="function"&&(b.error=b.fatal=b.warn=b.info=b.debug=b.trace=b),m.enabled===!1&&(m.level="silent");const de=m.level||"info",w=Object.create(b);w.log||(w.log=K),Object.defineProperty(w,"levelVal",{get:ee}),Object.defineProperty(w,"level",{get:X,set:G});const I={transmit:c,serialize:k,asObject:m.browser.asObject,levels:ue,timestamp:T(m)};w.levels=o.levels,w.level=de,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=K,w.serializers=V,w._serialize=k,w._stdErrSerialize=ie,w.child=W,c&&(w._logEvent=C());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function X(){return this._level}function G(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,u(I,w,"error","log"),u(I,w,"fatal","error"),u(I,w,"warn","error"),u(I,w,"info","log"),u(I,w,"debug","log"),u(I,w,"trace","log")}function W(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},k&&J.serializers&&(re.serializers=J.serializers);const we=re.serializers;if(k&&we){var oe=Object.assign({},V,we),me=m.browser.serialize===!0?Object.keys(oe):k;delete J.serializers,_([J],me,oe,this._stdErrSerialize)}function he(ve){this._childLevel=(ve._childLevel|0)+1,this.error=p(ve,J,"error"),this.fatal=p(ve,J,"fatal"),this.warn=p(ve,J,"warn"),this.info=p(ve,J,"info"),this.debug=p(ve,J,"debug"),this.trace=p(ve,J,"trace"),oe&&(this.serializers=oe,this._serialize=me),c&&(this._logEvent=C([].concat(ve._logEvent.bindings,J)))}return he.prototype=this,new he(this)}return w}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:se,epochTime:L,unixTime:M,isoTime:x});function u(m,c,b,V){const k=Object.getPrototypeOf(c);c[b]=c.levelVal>c.levels.values[b]?K:k[b]?k[b]:e[b]||e[V]||K,h(m,c,b)}function h(m,c,b){!m.transmit&&c[b]===K||(c[b]=function(V){return function(){const ie=m.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var w=0;w<ue.length;w++)ue[w]=arguments[w];if(m.serialize&&!m.asObject&&_(ue,this._serialize,this.serializers,this._stdErrSerialize),m.asObject?V.call(de,l(this,b,ue,ie)):V.apply(de,ue),m.transmit){const I=m.transmit.level||c.level,ee=o.levels.values[I],X=o.levels.values[b];if(X<ee)return;E(this,{ts:ie,methodLevel:b,methodValue:X,transmitLevel:I,transmitValue:o.levels.values[m.transmit.level||c.level],send:m.transmit.send,val:c.levelVal},ue)}}}(c[b]))}function l(m,c,b,V){m._serialize&&_(b,m._serialize,m.serializers,m._stdErrSerialize);const k=b.slice();let ie=k[0];const ue={};V&&(ue.time=V),ue.level=o.levels.values[c];let de=(m._childLevel|0)+1;if(de<1&&(de=1),ie!==null&&typeof ie=="object"){for(;de--&&typeof k[0]=="object";)Object.assign(ue,k.shift());ie=k.length?n(k.shift(),k):void 0}else typeof ie=="string"&&(ie=n(k.shift(),k));return ie!==void 0&&(ue.msg=ie),ue}function _(m,c,b,V){for(const k in m)if(V&&m[k]instanceof Error)m[k]=o.stdSerializers.err(m[k]);else if(typeof m[k]=="object"&&!Array.isArray(m[k]))for(const ie in m[k])c&&c.indexOf(ie)>-1&&ie in b&&(m[k][ie]=b[ie](m[k][ie]))}function p(m,c,b){return function(){const V=new Array(1+arguments.length);V[0]=c;for(var k=1;k<V.length;k++)V[k]=arguments[k-1];return m[b].apply(this,V)}}function E(m,c,b){const V=c.send,k=c.ts,ie=c.methodLevel,ue=c.methodValue,de=c.val,w=m._logEvent.bindings;_(b,m._serialize||Object.keys(m.serializers),m.serializers,m._stdErrSerialize===void 0?!0:m._stdErrSerialize),m._logEvent.ts=k,m._logEvent.messages=b.filter(function(I){return w.indexOf(I)===-1}),m._logEvent.level.label=ie,m._logEvent.level.value=ue,V(ie,m._logEvent,de),m._logEvent=C(w)}function C(m){return{ts:0,messages:[],bindings:m||[],level:{label:"",value:0}}}function D(m){const c={type:m.constructor.name,msg:m.message,stack:m.stack};for(const b in m)c[b]===void 0&&(c[b]=m[b]);return c}function T(m){return typeof m.timestamp=="function"?m.timestamp:m.timestamp===!1?se:L}function R(){return{}}function q(m){return m}function K(){}function se(){return!1}function L(){return Date.now()}function M(){return Math.round(Date.now()/1e3)}function x(){return new Date(Date.now()).toISOString()}function P(){function m(c){return typeof c<"u"&&c}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return m(self)||m(window)||m(this)||{}}}return Aa}var qn={},Bf;function Hf(){return Bf||(Bf=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.PINO_CUSTOM_CONTEXT_KEY=qn.PINO_LOGGER_DEFAULTS=void 0,qn.PINO_LOGGER_DEFAULTS={level:"info"},qn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),qn}var nr={},jf;function E_(){if(jf)return nr;jf=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const n=Hf();function e(l){return Object.assign(Object.assign({},l),{level:l?.level||n.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=e;function t(l,_=n.PINO_CUSTOM_CONTEXT_KEY){return l[_]||""}nr.getBrowserLoggerContext=t;function s(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){return l[p]=_,l}nr.setBrowserLoggerContext=s;function o(l,_=n.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof l.bindings>"u"?p=t(l,_):p=l.bindings().context||"",p}nr.getLoggerContext=o;function u(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const E=o(l,p);return E.trim()?`${E}/${_}`:_}nr.formatChildLoggerContext=u;function h(l,_,p=n.PINO_CUSTOM_CONTEXT_KEY){const E=u(l,_,p),C=l.child({context:E});return s(C,E,p)}return nr.generateChildLogger=h,nr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const e=b_,t=e.__importDefault(m_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(Hf(),n),e.__exportStar(E_(),n)})(Je);class S_ extends Hn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class D_ extends Hn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class x_{constructor(e,t){this.logger=e,this.core=t}}class O_ extends Hn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class I_ extends Hn{constructor(e){super()}}class A_{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}}class P_ extends Hn{constructor(e,t){super(),this.relayer=e,this.logger=t}}class C_ extends Hn{constructor(e,t){super(),this.core=e,this.logger=t}}class T_{constructor(e,t){this.projectId=e,this.logger=t}}class R_{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class N_{constructor(e){this.client=e}}const L_=n=>JSON.stringify(n,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),F_=n=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=n.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Pa(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return F_(n)}catch{return n}}function Zi(n){return typeof n=="string"?n:L_(n)||""}var Ca={},li={},Ls={},Fs={};Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.BrowserRandomSource=void 0;const qf=65536;class U_{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=qf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,qf)));return t}}Fs.BrowserRandomSource=U_;function $_(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Us={},Er={};Object.defineProperty(Er,"__esModule",{value:!0});function M_(n){for(var e=0;e<n.length;e++)n[e]=0;return n}Er.wipe=M_;var B_={},H_=Object.freeze({__proto__:null,default:B_}),j_=$n(H_);Object.defineProperty(Us,"__esModule",{value:!0}),Us.NodeRandomSource=void 0;const q_=Er;class z_{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof $_<"u"){const e=j_;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,q_.wipe)(t),s}}Us.NodeRandomSource=z_,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.SystemRandomSource=void 0;const K_=Fs,G_=Us;class W_{constructor(){if(this.isAvailable=!1,this.name="",this._source=new K_.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new G_.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Ls.SystemRandomSource=W_;var Ne={},zf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});function e(l,_){var p=l>>>16&65535,E=l&65535,C=_>>>16&65535,D=_&65535;return E*D+(p*D+E*C<<16>>>0)|0}n.mul=Math.imul||e;function t(l,_){return l+_|0}n.add=t;function s(l,_){return l-_|0}n.sub=s;function o(l,_){return l<<_|l>>>32-_}n.rotl=o;function u(l,_){return l<<32-_|l>>>_}n.rotr=u;function h(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l}n.isInteger=Number.isInteger||h,n.MAX_SAFE_INTEGER=9007199254740991,n.isSafeInteger=function(l){return n.isInteger(l)&&l>=-n.MAX_SAFE_INTEGER&&l<=n.MAX_SAFE_INTEGER}})(zf),Object.defineProperty(Ne,"__esModule",{value:!0});var Kf=zf;function V_(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])<<16>>16}Ne.readInt16BE=V_;function Y_(n,e){return e===void 0&&(e=0),(n[e+0]<<8|n[e+1])>>>0}Ne.readUint16BE=Y_;function k_(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])<<16>>16}Ne.readInt16LE=k_;function J_(n,e){return e===void 0&&(e=0),(n[e+1]<<8|n[e])>>>0}Ne.readUint16LE=J_;function Gf(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>8,e[t+1]=n>>>0,e}Ne.writeUint16BE=Gf,Ne.writeInt16BE=Gf;function Wf(n,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e}Ne.writeUint16LE=Wf,Ne.writeInt16LE=Wf;function Ta(n,e){return e===void 0&&(e=0),n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}Ne.readInt32BE=Ta;function Ra(n,e){return e===void 0&&(e=0),(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}Ne.readUint32BE=Ra;function Na(n,e){return e===void 0&&(e=0),n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]}Ne.readInt32LE=Na;function La(n,e){return e===void 0&&(e=0),(n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e])>>>0}Ne.readUint32LE=La;function $s(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>24,e[t+1]=n>>>16,e[t+2]=n>>>8,e[t+3]=n>>>0,e}Ne.writeUint32BE=$s,Ne.writeInt32BE=$s;function Ms(n,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=n>>>0,e[t+1]=n>>>8,e[t+2]=n>>>16,e[t+3]=n>>>24,e}Ne.writeUint32LE=Ms,Ne.writeInt32LE=Ms;function X_(n,e){e===void 0&&(e=0);var t=Ta(n,e),s=Ta(n,e+4);return t*4294967296+s-(s>>31)*4294967296}Ne.readInt64BE=X_;function Z_(n,e){e===void 0&&(e=0);var t=Ra(n,e),s=Ra(n,e+4);return t*4294967296+s}Ne.readUint64BE=Z_;function Q_(n,e){e===void 0&&(e=0);var t=Na(n,e),s=Na(n,e+4);return s*4294967296+t-(t>>31)*4294967296}Ne.readInt64LE=Q_;function ey(n,e){e===void 0&&(e=0);var t=La(n,e),s=La(n,e+4);return s*4294967296+t}Ne.readUint64LE=ey;function Vf(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),$s(n/4294967296>>>0,e,t),$s(n>>>0,e,t+4),e}Ne.writeUint64BE=Vf,Ne.writeInt64BE=Vf;function Yf(n,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Ms(n>>>0,e,t),Ms(n/4294967296>>>0,e,t+4),e}Ne.writeUint64LE=Yf,Ne.writeInt64LE=Yf;function ty(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,u=n/8+t-1;u>=t;u--)s+=e[u]*o,o*=256;return s}Ne.readUintBE=ty;function ry(n,e,t){if(t===void 0&&(t=0),n%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(n/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,u=t;u<t+n/8;u++)s+=e[u]*o,o*=256;return s}Ne.readUintLE=ry;function ny(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Kf.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,u=n/8+s-1;u>=s;u--)t[u]=e/o&255,o*=256;return t}Ne.writeUintBE=ny;function iy(n,e,t,s){if(t===void 0&&(t=new Uint8Array(n/8)),s===void 0&&(s=0),n%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Kf.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,u=s;u<s+n/8;u++)t[u]=e/o&255,o*=256;return t}Ne.writeUintLE=iy;function sy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e)}Ne.readFloat32BE=sy;function oy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat32(e,!0)}Ne.readFloat32LE=oy;function ay(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e)}Ne.readFloat64BE=ay;function uy(n,e){e===void 0&&(e=0);var t=new DataView(n.buffer,n.byteOffset,n.byteLength);return t.getFloat64(e,!0)}Ne.readFloat64LE=uy;function cy(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n),e}Ne.writeFloat32BE=cy;function fy(n,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,n,!0),e}Ne.writeFloat32LE=fy;function hy(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n),e}Ne.writeFloat64BE=hy;function ly(n,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,n,!0),e}Ne.writeFloat64LE=ly,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;const e=Ls,t=Ne,s=Er;n.defaultRandomSource=new e.SystemRandomSource;function o(p,E=n.defaultRandomSource){return E.randomBytes(p)}n.randomBytes=o;function u(p=n.defaultRandomSource){const E=o(4,p),C=(0,t.readUint32LE)(E);return(0,s.wipe)(E),C}n.randomUint32=u;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(p,E=h,C=n.defaultRandomSource){if(E.length<2)throw new Error("randomString charset is too short");if(E.length>256)throw new Error("randomString charset is too long");let D="";const T=E.length,R=256-256%T;for(;p>0;){const q=o(Math.ceil(p*256/R),C);for(let K=0;K<q.length&&p>0;K++){const se=q[K];se<R&&(D+=E.charAt(se%T),p--)}(0,s.wipe)(q)}return D}n.randomString=l;function _(p,E=h,C=n.defaultRandomSource){const D=Math.ceil(p/(Math.log(E.length)/Math.LN2));return l(D,E,C)}n.randomStringForEntropy=_}(li);var kf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ne,t=Er;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},l.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[E++],p--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(E=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,E,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[E++],p--;return this},l.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,E=this._bufferLength,C=p/536870912|0,D=p<<3,T=p%128<112?128:256;this._buffer[E]=128;for(var R=E+1;R<T-8;R++)this._buffer[R]=0;e.writeUint32BE(C,this._buffer,T-8),e.writeUint32BE(D,this._buffer,T-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)e.writeUint32BE(this._stateHi[R],_,R*8),e.writeUint32BE(this._stateLo[R],_,R*8+4);return this},l.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},l}();n.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(l,_,p,E,C,D,T){for(var R=p[0],q=p[1],K=p[2],se=p[3],L=p[4],M=p[5],x=p[6],P=p[7],m=E[0],c=E[1],b=E[2],V=E[3],k=E[4],ie=E[5],ue=E[6],de=E[7],w,I,ee,X,G,W,J,re;T>=128;){for(var we=0;we<16;we++){var oe=8*we+D;l[we]=e.readUint32BE(C,oe),_[we]=e.readUint32BE(C,oe+4)}for(var we=0;we<80;we++){var me=R,he=q,ve=K,j=se,H=L,F=M,d=x,A=P,ae=m,le=c,xe=b,qe=V,Ge=k,$e=ie,gt=ue,_t=de;if(w=P,I=de,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=(L>>>14|k<<32-14)^(L>>>18|k<<32-18)^(k>>>41-32|L<<32-(41-32)),I=(k>>>14|L<<32-14)^(k>>>18|L<<32-18)^(L>>>41-32|k<<32-(41-32)),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=L&M^~L&x,I=k&ie^~k&ue,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=o[we*2],I=o[we*2+1],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=l[we%16],I=_[we%16],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,ee=J&65535|re<<16,X=G&65535|W<<16,w=ee,I=X,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=(R>>>28|m<<32-28)^(m>>>34-32|R<<32-(34-32))^(m>>>39-32|R<<32-(39-32)),I=(m>>>28|R<<32-28)^(R>>>34-32|m<<32-(34-32))^(R>>>39-32|m<<32-(39-32)),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,w=R&q^R&K^q&K,I=m&c^m&b^c&b,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,A=J&65535|re<<16,_t=G&65535|W<<16,w=j,I=qe,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=ee,I=X,G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,j=J&65535|re<<16,qe=G&65535|W<<16,q=me,K=he,se=ve,L=j,M=H,x=F,P=d,R=A,c=ae,b=le,V=xe,k=qe,ie=Ge,ue=$e,de=gt,m=_t,we%16===15)for(var oe=0;oe<16;oe++)w=l[oe],I=_[oe],G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=l[(oe+9)%16],I=_[(oe+9)%16],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,ee=l[(oe+1)%16],X=_[(oe+1)%16],w=(ee>>>1|X<<32-1)^(ee>>>8|X<<32-8)^ee>>>7,I=(X>>>1|ee<<32-1)^(X>>>8|ee<<32-8)^(X>>>7|ee<<32-7),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,ee=l[(oe+14)%16],X=_[(oe+14)%16],w=(ee>>>19|X<<32-19)^(X>>>61-32|ee<<32-(61-32))^ee>>>6,I=(X>>>19|ee<<32-19)^(ee>>>61-32|X<<32-(61-32))^(X>>>6|ee<<32-6),G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,l[oe]=J&65535|re<<16,_[oe]=G&65535|W<<16}w=R,I=m,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[0],I=E[0],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[0]=R=J&65535|re<<16,E[0]=m=G&65535|W<<16,w=q,I=c,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[1],I=E[1],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[1]=q=J&65535|re<<16,E[1]=c=G&65535|W<<16,w=K,I=b,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[2],I=E[2],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[2]=K=J&65535|re<<16,E[2]=b=G&65535|W<<16,w=se,I=V,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[3],I=E[3],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[3]=se=J&65535|re<<16,E[3]=V=G&65535|W<<16,w=L,I=k,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[4],I=E[4],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[4]=L=J&65535|re<<16,E[4]=k=G&65535|W<<16,w=M,I=ie,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[5],I=E[5],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[5]=M=J&65535|re<<16,E[5]=ie=G&65535|W<<16,w=x,I=ue,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[6],I=E[6],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[6]=x=J&65535|re<<16,E[6]=ue=G&65535|W<<16,w=P,I=de,G=I&65535,W=I>>>16,J=w&65535,re=w>>>16,w=p[7],I=E[7],G+=I&65535,W+=I>>>16,J+=w&65535,re+=w>>>16,W+=G>>>16,J+=W>>>16,re+=J>>>16,p[7]=P=J&65535|re<<16,E[7]=de=G&65535|W<<16,D+=128,T-=128}return D}function h(l){var _=new s;_.update(l);var p=_.digest();return _.clean(),p}n.hash=h})(kf),function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const e=li,t=kf,s=Er;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function o(j){const H=new Float64Array(16);if(j)for(let F=0;F<j.length;F++)H[F]=j[F];return H}const u=new Uint8Array(32);u[0]=9;const h=o(),l=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),D=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(j,H){for(let F=0;F<16;F++)j[F]=H[F]|0}function R(j){let H=1;for(let F=0;F<16;F++){let d=j[F]+H+65535;H=Math.floor(d/65536),j[F]=d-H*65536}j[0]+=H-1+37*(H-1)}function q(j,H,F){const d=~(F-1);for(let A=0;A<16;A++){const ae=d&(j[A]^H[A]);j[A]^=ae,H[A]^=ae}}function K(j,H){const F=o(),d=o();for(let A=0;A<16;A++)d[A]=H[A];R(d),R(d),R(d);for(let A=0;A<2;A++){F[0]=d[0]-65517;for(let le=1;le<15;le++)F[le]=d[le]-65535-(F[le-1]>>16&1),F[le-1]&=65535;F[15]=d[15]-32767-(F[14]>>16&1);const ae=F[15]>>16&1;F[14]&=65535,q(d,F,1-ae)}for(let A=0;A<16;A++)j[2*A]=d[A]&255,j[2*A+1]=d[A]>>8}function se(j,H){let F=0;for(let d=0;d<32;d++)F|=j[d]^H[d];return(1&F-1>>>8)-1}function L(j,H){const F=new Uint8Array(32),d=new Uint8Array(32);return K(F,j),K(d,H),se(F,d)}function M(j){const H=new Uint8Array(32);return K(H,j),H[0]&1}function x(j,H){for(let F=0;F<16;F++)j[F]=H[2*F]+(H[2*F+1]<<8);j[15]&=32767}function P(j,H,F){for(let d=0;d<16;d++)j[d]=H[d]+F[d]}function m(j,H,F){for(let d=0;d<16;d++)j[d]=H[d]-F[d]}function c(j,H,F){let d,A,ae=0,le=0,xe=0,qe=0,Ge=0,$e=0,gt=0,_t=0,Be=0,Oe=0,Le=0,Fe=0,He=0,Ae=0,Ue=0,De=0,Pe=0,ze=0,Ie=0,We=0,Ye=0,et=0,tt=0,Xe=0,ur=0,_r=0,Zr=0,cr=0,un=0,xn=0,kn=0,St=F[0],yt=F[1],Dt=F[2],xt=F[3],mt=F[4],vt=F[5],Mt=F[6],Bt=F[7],Ot=F[8],Ht=F[9],It=F[10],Tt=F[11],At=F[12],lt=F[13],jt=F[14],qt=F[15];d=H[0],ae+=d*St,le+=d*yt,xe+=d*Dt,qe+=d*xt,Ge+=d*mt,$e+=d*vt,gt+=d*Mt,_t+=d*Bt,Be+=d*Ot,Oe+=d*Ht,Le+=d*It,Fe+=d*Tt,He+=d*At,Ae+=d*lt,Ue+=d*jt,De+=d*qt,d=H[1],le+=d*St,xe+=d*yt,qe+=d*Dt,Ge+=d*xt,$e+=d*mt,gt+=d*vt,_t+=d*Mt,Be+=d*Bt,Oe+=d*Ot,Le+=d*Ht,Fe+=d*It,He+=d*Tt,Ae+=d*At,Ue+=d*lt,De+=d*jt,Pe+=d*qt,d=H[2],xe+=d*St,qe+=d*yt,Ge+=d*Dt,$e+=d*xt,gt+=d*mt,_t+=d*vt,Be+=d*Mt,Oe+=d*Bt,Le+=d*Ot,Fe+=d*Ht,He+=d*It,Ae+=d*Tt,Ue+=d*At,De+=d*lt,Pe+=d*jt,ze+=d*qt,d=H[3],qe+=d*St,Ge+=d*yt,$e+=d*Dt,gt+=d*xt,_t+=d*mt,Be+=d*vt,Oe+=d*Mt,Le+=d*Bt,Fe+=d*Ot,He+=d*Ht,Ae+=d*It,Ue+=d*Tt,De+=d*At,Pe+=d*lt,ze+=d*jt,Ie+=d*qt,d=H[4],Ge+=d*St,$e+=d*yt,gt+=d*Dt,_t+=d*xt,Be+=d*mt,Oe+=d*vt,Le+=d*Mt,Fe+=d*Bt,He+=d*Ot,Ae+=d*Ht,Ue+=d*It,De+=d*Tt,Pe+=d*At,ze+=d*lt,Ie+=d*jt,We+=d*qt,d=H[5],$e+=d*St,gt+=d*yt,_t+=d*Dt,Be+=d*xt,Oe+=d*mt,Le+=d*vt,Fe+=d*Mt,He+=d*Bt,Ae+=d*Ot,Ue+=d*Ht,De+=d*It,Pe+=d*Tt,ze+=d*At,Ie+=d*lt,We+=d*jt,Ye+=d*qt,d=H[6],gt+=d*St,_t+=d*yt,Be+=d*Dt,Oe+=d*xt,Le+=d*mt,Fe+=d*vt,He+=d*Mt,Ae+=d*Bt,Ue+=d*Ot,De+=d*Ht,Pe+=d*It,ze+=d*Tt,Ie+=d*At,We+=d*lt,Ye+=d*jt,et+=d*qt,d=H[7],_t+=d*St,Be+=d*yt,Oe+=d*Dt,Le+=d*xt,Fe+=d*mt,He+=d*vt,Ae+=d*Mt,Ue+=d*Bt,De+=d*Ot,Pe+=d*Ht,ze+=d*It,Ie+=d*Tt,We+=d*At,Ye+=d*lt,et+=d*jt,tt+=d*qt,d=H[8],Be+=d*St,Oe+=d*yt,Le+=d*Dt,Fe+=d*xt,He+=d*mt,Ae+=d*vt,Ue+=d*Mt,De+=d*Bt,Pe+=d*Ot,ze+=d*Ht,Ie+=d*It,We+=d*Tt,Ye+=d*At,et+=d*lt,tt+=d*jt,Xe+=d*qt,d=H[9],Oe+=d*St,Le+=d*yt,Fe+=d*Dt,He+=d*xt,Ae+=d*mt,Ue+=d*vt,De+=d*Mt,Pe+=d*Bt,ze+=d*Ot,Ie+=d*Ht,We+=d*It,Ye+=d*Tt,et+=d*At,tt+=d*lt,Xe+=d*jt,ur+=d*qt,d=H[10],Le+=d*St,Fe+=d*yt,He+=d*Dt,Ae+=d*xt,Ue+=d*mt,De+=d*vt,Pe+=d*Mt,ze+=d*Bt,Ie+=d*Ot,We+=d*Ht,Ye+=d*It,et+=d*Tt,tt+=d*At,Xe+=d*lt,ur+=d*jt,_r+=d*qt,d=H[11],Fe+=d*St,He+=d*yt,Ae+=d*Dt,Ue+=d*xt,De+=d*mt,Pe+=d*vt,ze+=d*Mt,Ie+=d*Bt,We+=d*Ot,Ye+=d*Ht,et+=d*It,tt+=d*Tt,Xe+=d*At,ur+=d*lt,_r+=d*jt,Zr+=d*qt,d=H[12],He+=d*St,Ae+=d*yt,Ue+=d*Dt,De+=d*xt,Pe+=d*mt,ze+=d*vt,Ie+=d*Mt,We+=d*Bt,Ye+=d*Ot,et+=d*Ht,tt+=d*It,Xe+=d*Tt,ur+=d*At,_r+=d*lt,Zr+=d*jt,cr+=d*qt,d=H[13],Ae+=d*St,Ue+=d*yt,De+=d*Dt,Pe+=d*xt,ze+=d*mt,Ie+=d*vt,We+=d*Mt,Ye+=d*Bt,et+=d*Ot,tt+=d*Ht,Xe+=d*It,ur+=d*Tt,_r+=d*At,Zr+=d*lt,cr+=d*jt,un+=d*qt,d=H[14],Ue+=d*St,De+=d*yt,Pe+=d*Dt,ze+=d*xt,Ie+=d*mt,We+=d*vt,Ye+=d*Mt,et+=d*Bt,tt+=d*Ot,Xe+=d*Ht,ur+=d*It,_r+=d*Tt,Zr+=d*At,cr+=d*lt,un+=d*jt,xn+=d*qt,d=H[15],De+=d*St,Pe+=d*yt,ze+=d*Dt,Ie+=d*xt,We+=d*mt,Ye+=d*vt,et+=d*Mt,tt+=d*Bt,Xe+=d*Ot,ur+=d*Ht,_r+=d*It,Zr+=d*Tt,cr+=d*At,un+=d*lt,xn+=d*jt,kn+=d*qt,ae+=38*Pe,le+=38*ze,xe+=38*Ie,qe+=38*We,Ge+=38*Ye,$e+=38*et,gt+=38*tt,_t+=38*Xe,Be+=38*ur,Oe+=38*_r,Le+=38*Zr,Fe+=38*cr,He+=38*un,Ae+=38*xn,Ue+=38*kn,A=1,d=ae+A+65535,A=Math.floor(d/65536),ae=d-A*65536,d=le+A+65535,A=Math.floor(d/65536),le=d-A*65536,d=xe+A+65535,A=Math.floor(d/65536),xe=d-A*65536,d=qe+A+65535,A=Math.floor(d/65536),qe=d-A*65536,d=Ge+A+65535,A=Math.floor(d/65536),Ge=d-A*65536,d=$e+A+65535,A=Math.floor(d/65536),$e=d-A*65536,d=gt+A+65535,A=Math.floor(d/65536),gt=d-A*65536,d=_t+A+65535,A=Math.floor(d/65536),_t=d-A*65536,d=Be+A+65535,A=Math.floor(d/65536),Be=d-A*65536,d=Oe+A+65535,A=Math.floor(d/65536),Oe=d-A*65536,d=Le+A+65535,A=Math.floor(d/65536),Le=d-A*65536,d=Fe+A+65535,A=Math.floor(d/65536),Fe=d-A*65536,d=He+A+65535,A=Math.floor(d/65536),He=d-A*65536,d=Ae+A+65535,A=Math.floor(d/65536),Ae=d-A*65536,d=Ue+A+65535,A=Math.floor(d/65536),Ue=d-A*65536,d=De+A+65535,A=Math.floor(d/65536),De=d-A*65536,ae+=A-1+37*(A-1),A=1,d=ae+A+65535,A=Math.floor(d/65536),ae=d-A*65536,d=le+A+65535,A=Math.floor(d/65536),le=d-A*65536,d=xe+A+65535,A=Math.floor(d/65536),xe=d-A*65536,d=qe+A+65535,A=Math.floor(d/65536),qe=d-A*65536,d=Ge+A+65535,A=Math.floor(d/65536),Ge=d-A*65536,d=$e+A+65535,A=Math.floor(d/65536),$e=d-A*65536,d=gt+A+65535,A=Math.floor(d/65536),gt=d-A*65536,d=_t+A+65535,A=Math.floor(d/65536),_t=d-A*65536,d=Be+A+65535,A=Math.floor(d/65536),Be=d-A*65536,d=Oe+A+65535,A=Math.floor(d/65536),Oe=d-A*65536,d=Le+A+65535,A=Math.floor(d/65536),Le=d-A*65536,d=Fe+A+65535,A=Math.floor(d/65536),Fe=d-A*65536,d=He+A+65535,A=Math.floor(d/65536),He=d-A*65536,d=Ae+A+65535,A=Math.floor(d/65536),Ae=d-A*65536,d=Ue+A+65535,A=Math.floor(d/65536),Ue=d-A*65536,d=De+A+65535,A=Math.floor(d/65536),De=d-A*65536,ae+=A-1+37*(A-1),j[0]=ae,j[1]=le,j[2]=xe,j[3]=qe,j[4]=Ge,j[5]=$e,j[6]=gt,j[7]=_t,j[8]=Be,j[9]=Oe,j[10]=Le,j[11]=Fe,j[12]=He,j[13]=Ae,j[14]=Ue,j[15]=De}function b(j,H){c(j,H,H)}function V(j,H){const F=o();let d;for(d=0;d<16;d++)F[d]=H[d];for(d=253;d>=0;d--)b(F,F),d!==2&&d!==4&&c(F,F,H);for(d=0;d<16;d++)j[d]=F[d]}function k(j,H){const F=o();let d;for(d=0;d<16;d++)F[d]=H[d];for(d=250;d>=0;d--)b(F,F),d!==1&&c(F,F,H);for(d=0;d<16;d++)j[d]=F[d]}function ie(j,H){const F=o(),d=o(),A=o(),ae=o(),le=o(),xe=o(),qe=o(),Ge=o(),$e=o();m(F,j[1],j[0]),m($e,H[1],H[0]),c(F,F,$e),P(d,j[0],j[1]),P($e,H[0],H[1]),c(d,d,$e),c(A,j[3],H[3]),c(A,A,p),c(ae,j[2],H[2]),P(ae,ae,ae),m(le,d,F),m(xe,ae,A),P(qe,ae,A),P(Ge,d,F),c(j[0],le,xe),c(j[1],Ge,qe),c(j[2],qe,xe),c(j[3],le,Ge)}function ue(j,H,F){for(let d=0;d<4;d++)q(j[d],H[d],F)}function de(j,H){const F=o(),d=o(),A=o();V(A,H[2]),c(F,H[0],A),c(d,H[1],A),K(j,d),j[31]^=M(F)<<7}function w(j,H,F){T(j[0],h),T(j[1],l),T(j[2],l),T(j[3],h);for(let d=255;d>=0;--d){const A=F[d/8|0]>>(d&7)&1;ue(j,H,A),ie(H,j),ie(j,j),ue(j,H,A)}}function I(j,H){const F=[o(),o(),o(),o()];T(F[0],E),T(F[1],C),T(F[2],l),c(F[3],E,C),w(j,F,H)}function ee(j){if(j.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const H=(0,t.hash)(j);H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(32),d=[o(),o(),o(),o()];I(d,H),de(F,d);const A=new Uint8Array(64);return A.set(j),A.set(F,32),{publicKey:F,secretKey:A}}n.generateKeyPairFromSeed=ee;function X(j){const H=(0,e.randomBytes)(32,j),F=ee(H);return(0,s.wipe)(H),F}n.generateKeyPair=X;function G(j){if(j.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}n.extractPublicKeyFromSecretKey=G;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(j,H){let F,d,A,ae;for(d=63;d>=32;--d){for(F=0,A=d-32,ae=d-12;A<ae;++A)H[A]+=F-16*H[d]*W[A-(d-32)],F=Math.floor((H[A]+128)/256),H[A]-=F*256;H[A]+=F,H[d]=0}for(F=0,A=0;A<32;A++)H[A]+=F-(H[31]>>4)*W[A],F=H[A]>>8,H[A]&=255;for(A=0;A<32;A++)H[A]-=F*W[A];for(d=0;d<32;d++)H[d+1]+=H[d]>>8,j[d]=H[d]&255}function re(j){const H=new Float64Array(64);for(let F=0;F<64;F++)H[F]=j[F];for(let F=0;F<64;F++)j[F]=0;J(j,H)}function we(j,H){const F=new Float64Array(64),d=[o(),o(),o(),o()],A=(0,t.hash)(j.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const ae=new Uint8Array(64);ae.set(A.subarray(32),32);const le=new t.SHA512;le.update(ae.subarray(32)),le.update(H);const xe=le.digest();le.clean(),re(xe),I(d,xe),de(ae,d),le.reset(),le.update(ae.subarray(0,32)),le.update(j.subarray(32)),le.update(H);const qe=le.digest();re(qe);for(let Ge=0;Ge<32;Ge++)F[Ge]=xe[Ge];for(let Ge=0;Ge<32;Ge++)for(let $e=0;$e<32;$e++)F[Ge+$e]+=qe[Ge]*A[$e];return J(ae.subarray(32),F),ae}n.sign=we;function oe(j,H){const F=o(),d=o(),A=o(),ae=o(),le=o(),xe=o(),qe=o();return T(j[2],l),x(j[1],H),b(A,j[1]),c(ae,A,_),m(A,A,j[2]),P(ae,j[2],ae),b(le,ae),b(xe,le),c(qe,xe,le),c(F,qe,A),c(F,F,ae),k(F,F),c(F,F,A),c(F,F,ae),c(F,F,ae),c(j[0],F,ae),b(d,j[0]),c(d,d,ae),L(d,A)&&c(j[0],j[0],D),b(d,j[0]),c(d,d,ae),L(d,A)?-1:(M(j[0])===H[31]>>7&&m(j[0],h,j[0]),c(j[3],j[0],j[1]),0)}function me(j,H,F){const d=new Uint8Array(32),A=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(F.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(oe(ae,j))return!1;const le=new t.SHA512;le.update(F.subarray(0,32)),le.update(j),le.update(H);const xe=le.digest();return re(xe),w(A,ae,xe),I(ae,F.subarray(32)),ie(A,ae),de(d,A),!se(F,d)}n.verify=me;function he(j){let H=[o(),o(),o(),o()];if(oe(H,j))throw new Error("Ed25519: invalid public key");let F=o(),d=o(),A=H[1];P(F,l,A),m(d,l,A),V(d,d),c(F,F,d);let ae=new Uint8Array(32);return K(ae,F),ae}n.convertPublicKeyToX25519=he;function ve(j){const H=(0,t.hash)(j.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const F=new Uint8Array(H.subarray(0,32));return(0,s.wipe)(H),F}n.convertSecretKeyToX25519=ve}(Ca);const dy="EdDSA",py="JWT",Jf=".",Xf="base64url",gy="utf8",_y="utf8",yy=":",vy="did",by="key",Zf="base58btc",wy="z",my="K36",Ey=32;function Fa(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Qf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Fa(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ua(n,e){e||(e=n.reduce((o,u)=>o+u.length,0));const t=Qf(e);let s=0;for(const o of n)t.set(o,s),s+=o.length;return Fa(t)}function Sy(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var u=n.charAt(o),h=u.charCodeAt(0);if(t[h]!==255)throw new TypeError(u+" is ambiguous");t[h]=o}var l=n.length,_=n.charAt(0),p=Math.log(l)/Math.log(256),E=Math.log(256)/Math.log(l);function C(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var q=0,K=0,se=0,L=R.length;se!==L&&R[se]===0;)se++,q++;for(var M=(L-se)*E+1>>>0,x=new Uint8Array(M);se!==L;){for(var P=R[se],m=0,c=M-1;(P!==0||m<K)&&c!==-1;c--,m++)P+=256*x[c]>>>0,x[c]=P%l>>>0,P=P/l>>>0;if(P!==0)throw new Error("Non-zero carry");K=m,se++}for(var b=M-K;b!==M&&x[b]===0;)b++;for(var V=_.repeat(q);b<M;++b)V+=n.charAt(x[b]);return V}function D(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var q=0;if(R[q]!==" "){for(var K=0,se=0;R[q]===_;)K++,q++;for(var L=(R.length-q)*p+1>>>0,M=new Uint8Array(L);R[q];){var x=t[R.charCodeAt(q)];if(x===255)return;for(var P=0,m=L-1;(x!==0||P<se)&&m!==-1;m--,P++)x+=l*M[m]>>>0,M[m]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");se=P,q++}if(R[q]!==" "){for(var c=L-se;c!==L&&M[c]===0;)c++;for(var b=new Uint8Array(K+(L-c)),V=K;c!==L;)b[V++]=M[c++];return b}}}function T(R){var q=D(R);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:C,decodeUnsafe:D,decode:T}}var Dy=Sy,xy=Dy;const eh=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Oy=n=>new TextEncoder().encode(n),Iy=n=>new TextDecoder().decode(n);class Ay{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Py{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return th(this,e)}}class Cy{constructor(e){this.decoders=e}or(e){return th(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const th=(n,e)=>new Cy({...n.decoders||{[n.prefix]:n},...e.decoders||{[e.prefix]:e}});class Ty{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Ay(e,t,s),this.decoder=new Py(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Bs=({name:n,prefix:e,encode:t,decode:s})=>new Ty(n,e,t,s),Qi=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=xy(t,e);return Bs({prefix:n,name:e,encode:s,decode:u=>eh(o(u))})},Ry=(n,e,t,s)=>{const o={};for(let E=0;E<e.length;++E)o[e[E]]=E;let u=n.length;for(;n[u-1]==="=";)--u;const h=new Uint8Array(u*t/8|0);let l=0,_=0,p=0;for(let E=0;E<u;++E){const C=o[n[E]];if(C===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|C,l+=t,l>=8&&(l-=8,h[p++]=255&_>>l)}if(l>=t||255&_<<8-l)throw new SyntaxError("Unexpected end of data");return h},Ny=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let u="",h=0,l=0;for(let _=0;_<n.length;++_)for(l=l<<8|n[_],h+=8;h>t;)h-=t,u+=e[o&l>>h];if(h&&(u+=e[o&l<<t-h]),s)for(;u.length*t&7;)u+="=";return u},Jt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>Bs({prefix:e,name:n,encode(o){return Ny(o,s,t)},decode(o){return Ry(o,s,t,n)}}),Ly=Bs({prefix:"\0",name:"identity",encode:n=>Iy(n),decode:n=>Oy(n)});var Fy=Object.freeze({__proto__:null,identity:Ly});const Uy=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $y=Object.freeze({__proto__:null,base2:Uy});const My=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var By=Object.freeze({__proto__:null,base8:My});const Hy=Qi({prefix:"9",name:"base10",alphabet:"0123456789"});var jy=Object.freeze({__proto__:null,base10:Hy});const qy=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zy=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ky=Object.freeze({__proto__:null,base16:qy,base16upper:zy});const Gy=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Wy=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vy=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yy=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ky=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jy=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xy=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zy=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qy=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var e1=Object.freeze({__proto__:null,base32:Gy,base32upper:Wy,base32pad:Vy,base32padupper:Yy,base32hex:ky,base32hexupper:Jy,base32hexpad:Xy,base32hexpadupper:Zy,base32z:Qy});const t1=Qi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),r1=Qi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var n1=Object.freeze({__proto__:null,base36:t1,base36upper:r1});const i1=Qi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s1=Qi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var o1=Object.freeze({__proto__:null,base58btc:i1,base58flickr:s1});const a1=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),u1=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),c1=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),f1=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var h1=Object.freeze({__proto__:null,base64:a1,base64pad:u1,base64url:c1,base64urlpad:f1});const rh=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),l1=rh.reduce((n,e,t)=>(n[t]=e,n),[]),d1=rh.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function p1(n){return n.reduce((e,t)=>(e+=l1[t],e),"")}function g1(n){const e=[];for(const t of n){const s=d1[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const _1=Bs({prefix:"\u{1F680}",name:"base256emoji",encode:p1,decode:g1});var y1=Object.freeze({__proto__:null,base256emoji:_1}),v1=ih,nh=128,b1=127,w1=~b1,m1=Math.pow(2,31);function ih(n,e,t){e=e||[],t=t||0;for(var s=t;n>=m1;)e[t++]=n&255|nh,n/=128;for(;n&w1;)e[t++]=n&255|nh,n>>>=7;return e[t]=n|0,ih.bytes=t-s+1,e}var E1=$a,S1=128,sh=127;function $a(n,s){var t=0,s=s||0,o=0,u=s,h,l=n.length;do{if(u>=l)throw $a.bytes=0,new RangeError("Could not decode varint");h=n[u++],t+=o<28?(h&sh)<<o:(h&sh)*Math.pow(2,o),o+=7}while(h>=S1);return $a.bytes=u-s,t}var D1=Math.pow(2,7),x1=Math.pow(2,14),O1=Math.pow(2,21),I1=Math.pow(2,28),A1=Math.pow(2,35),P1=Math.pow(2,42),C1=Math.pow(2,49),T1=Math.pow(2,56),R1=Math.pow(2,63),N1=function(n){return n<D1?1:n<x1?2:n<O1?3:n<I1?4:n<A1?5:n<P1?6:n<C1?7:n<T1?8:n<R1?9:10},L1={encode:v1,decode:E1,encodingLength:N1},oh=L1;const ah=(n,e,t=0)=>(oh.encode(n,e,t),e),uh=n=>oh.encodingLength(n),Ma=(n,e)=>{const t=e.byteLength,s=uh(n),o=s+uh(t),u=new Uint8Array(o+t);return ah(n,u,0),ah(t,u,s),u.set(e,o),new F1(n,t,e,u)};class F1{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const ch=({name:n,code:e,encode:t})=>new U1(n,e,t);class U1{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Ma(this.code,t):t.then(s=>Ma(this.code,s))}else throw Error("Unknown type, must be binary type")}}const fh=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),$1=ch({name:"sha2-256",code:18,encode:fh("SHA-256")}),M1=ch({name:"sha2-512",code:19,encode:fh("SHA-512")});var B1=Object.freeze({__proto__:null,sha256:$1,sha512:M1});const hh=0,H1="identity",lh=eh;var j1=Object.freeze({__proto__:null,identity:{code:hh,name:H1,encode:lh,digest:n=>Ma(hh,lh(n))}});new TextEncoder,new TextDecoder;const dh={...Fy,...$y,...By,...jy,...Ky,...e1,...n1,...o1,...h1,...y1};({...B1,...j1});function ph(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const gh=ph("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Ba=ph("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=Qf(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),_h={utf8:gh,"utf-8":gh,hex:dh.base16,latin1:Ba,ascii:Ba,binary:Ba,...dh};function ir(n,e="utf8"){const t=_h[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):t.encoder.encode(n).substring(1)}function pr(n,e="utf8"){const t=_h[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Fa(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}function Hs(n){return ir(pr(Zi(n),gy),Xf)}function yh(n){const e=pr(my,Zf),t=wy+ir(Ua([e,n]),Zf);return[vy,by,t].join(yy)}function q1(n){return ir(n,Xf)}function z1(n){return pr([Hs(n.header),Hs(n.payload)].join(Jf),_y)}function K1(n){return[Hs(n.header),Hs(n.payload),q1(n.signature)].join(Jf)}function vh(n=li.randomBytes(Ey)){return Ca.generateKeyPairFromSeed(n)}async function G1(n,e,t,s,o=ye.fromMiliseconds(Date.now())){const u={alg:dy,typ:py},h=yh(s.publicKey),l=o+t,_={iss:h,sub:n,aud:e,iat:o,exp:l},p=z1({header:u,payload:_}),E=Ca.sign(s.secretKey,p);return K1({header:u,payload:_,signature:E})}var Ha={},js={};Object.defineProperty(js,"__esModule",{value:!0});var er=Ne,ja=Er,W1=20;function V1(n,e,t){for(var s=1634760805,o=857760878,u=2036477234,h=1797285236,l=t[3]<<24|t[2]<<16|t[1]<<8|t[0],_=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],C=t[19]<<24|t[18]<<16|t[17]<<8|t[16],D=t[23]<<24|t[22]<<16|t[21]<<8|t[20],T=t[27]<<24|t[26]<<16|t[25]<<8|t[24],R=t[31]<<24|t[30]<<16|t[29]<<8|t[28],q=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],se=e[11]<<24|e[10]<<16|e[9]<<8|e[8],L=e[15]<<24|e[14]<<16|e[13]<<8|e[12],M=s,x=o,P=u,m=h,c=l,b=_,V=p,k=E,ie=C,ue=D,de=T,w=R,I=q,ee=K,X=se,G=L,W=0;W<W1;W+=2)M=M+c|0,I^=M,I=I>>>32-16|I<<16,ie=ie+I|0,c^=ie,c=c>>>32-12|c<<12,x=x+b|0,ee^=x,ee=ee>>>32-16|ee<<16,ue=ue+ee|0,b^=ue,b=b>>>32-12|b<<12,P=P+V|0,X^=P,X=X>>>32-16|X<<16,de=de+X|0,V^=de,V=V>>>32-12|V<<12,m=m+k|0,G^=m,G=G>>>32-16|G<<16,w=w+G|0,k^=w,k=k>>>32-12|k<<12,P=P+V|0,X^=P,X=X>>>32-8|X<<8,de=de+X|0,V^=de,V=V>>>32-7|V<<7,m=m+k|0,G^=m,G=G>>>32-8|G<<8,w=w+G|0,k^=w,k=k>>>32-7|k<<7,x=x+b|0,ee^=x,ee=ee>>>32-8|ee<<8,ue=ue+ee|0,b^=ue,b=b>>>32-7|b<<7,M=M+c|0,I^=M,I=I>>>32-8|I<<8,ie=ie+I|0,c^=ie,c=c>>>32-7|c<<7,M=M+b|0,G^=M,G=G>>>32-16|G<<16,de=de+G|0,b^=de,b=b>>>32-12|b<<12,x=x+V|0,I^=x,I=I>>>32-16|I<<16,w=w+I|0,V^=w,V=V>>>32-12|V<<12,P=P+k|0,ee^=P,ee=ee>>>32-16|ee<<16,ie=ie+ee|0,k^=ie,k=k>>>32-12|k<<12,m=m+c|0,X^=m,X=X>>>32-16|X<<16,ue=ue+X|0,c^=ue,c=c>>>32-12|c<<12,P=P+k|0,ee^=P,ee=ee>>>32-8|ee<<8,ie=ie+ee|0,k^=ie,k=k>>>32-7|k<<7,m=m+c|0,X^=m,X=X>>>32-8|X<<8,ue=ue+X|0,c^=ue,c=c>>>32-7|c<<7,x=x+V|0,I^=x,I=I>>>32-8|I<<8,w=w+I|0,V^=w,V=V>>>32-7|V<<7,M=M+b|0,G^=M,G=G>>>32-8|G<<8,de=de+G|0,b^=de,b=b>>>32-7|b<<7;er.writeUint32LE(M+s|0,n,0),er.writeUint32LE(x+o|0,n,4),er.writeUint32LE(P+u|0,n,8),er.writeUint32LE(m+h|0,n,12),er.writeUint32LE(c+l|0,n,16),er.writeUint32LE(b+_|0,n,20),er.writeUint32LE(V+p|0,n,24),er.writeUint32LE(k+E|0,n,28),er.writeUint32LE(ie+C|0,n,32),er.writeUint32LE(ue+D|0,n,36),er.writeUint32LE(de+T|0,n,40),er.writeUint32LE(w+R|0,n,44),er.writeUint32LE(I+q|0,n,48),er.writeUint32LE(ee+K|0,n,52),er.writeUint32LE(X+se|0,n,56),er.writeUint32LE(G+L|0,n,60)}function bh(n,e,t,s,o){if(o===void 0&&(o=0),n.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var u,h;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=new Uint8Array(16),h=u.length-e.length,u.set(e,h)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");u=e,h=o}for(var l=new Uint8Array(64),_=0;_<t.length;_+=64){V1(l,u,n);for(var p=_;p<_+64&&p<t.length;p++)s[p]=t[p]^l[p-_];k1(u,0,h)}return ja.wipe(l),o===0&&ja.wipe(u),s}js.streamXOR=bh;function Y1(n,e,t,s){return s===void 0&&(s=0),ja.wipe(t),bh(n,e,t,t,s)}js.stream=Y1;function k1(n,e,t){for(var s=1;t--;)s=s+(n[e]&255)|0,n[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var wh={},wn={};Object.defineProperty(wn,"__esModule",{value:!0});function J1(n,e,t){return~(n-1)&e|n-1&t}wn.select=J1;function X1(n,e){return(n|0)-(e|0)-1>>>31&1}wn.lessOrEqual=X1;function mh(n,e){if(n.length!==e.length)return 0;for(var t=0,s=0;s<n.length;s++)t|=n[s]^e[s];return 1&t-1>>>8}wn.compare=mh;function Z1(n,e){return n.length===0||e.length===0?!1:mh(n,e)!==0}wn.equal=Z1,function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=wn,t=Er;n.DIGEST_LENGTH=16;var s=function(){function h(l){this.digestLength=n.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var _=l[0]|l[1]<<8;this._r[0]=_&8191;var p=l[2]|l[3]<<8;this._r[1]=(_>>>13|p<<3)&8191;var E=l[4]|l[5]<<8;this._r[2]=(p>>>10|E<<6)&7939;var C=l[6]|l[7]<<8;this._r[3]=(E>>>7|C<<9)&8191;var D=l[8]|l[9]<<8;this._r[4]=(C>>>4|D<<12)&255,this._r[5]=D>>>1&8190;var T=l[10]|l[11]<<8;this._r[6]=(D>>>14|T<<2)&8191;var R=l[12]|l[13]<<8;this._r[7]=(T>>>11|R<<5)&8065;var q=l[14]|l[15]<<8;this._r[8]=(R>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=l[16]|l[17]<<8,this._pad[1]=l[18]|l[19]<<8,this._pad[2]=l[20]|l[21]<<8,this._pad[3]=l[22]|l[23]<<8,this._pad[4]=l[24]|l[25]<<8,this._pad[5]=l[26]|l[27]<<8,this._pad[6]=l[28]|l[29]<<8,this._pad[7]=l[30]|l[31]<<8}return h.prototype._blocks=function(l,_,p){for(var E=this._fin?0:2048,C=this._h[0],D=this._h[1],T=this._h[2],R=this._h[3],q=this._h[4],K=this._h[5],se=this._h[6],L=this._h[7],M=this._h[8],x=this._h[9],P=this._r[0],m=this._r[1],c=this._r[2],b=this._r[3],V=this._r[4],k=this._r[5],ie=this._r[6],ue=this._r[7],de=this._r[8],w=this._r[9];p>=16;){var I=l[_+0]|l[_+1]<<8;C+=I&8191;var ee=l[_+2]|l[_+3]<<8;D+=(I>>>13|ee<<3)&8191;var X=l[_+4]|l[_+5]<<8;T+=(ee>>>10|X<<6)&8191;var G=l[_+6]|l[_+7]<<8;R+=(X>>>7|G<<9)&8191;var W=l[_+8]|l[_+9]<<8;q+=(G>>>4|W<<12)&8191,K+=W>>>1&8191;var J=l[_+10]|l[_+11]<<8;se+=(W>>>14|J<<2)&8191;var re=l[_+12]|l[_+13]<<8;L+=(J>>>11|re<<5)&8191;var we=l[_+14]|l[_+15]<<8;M+=(re>>>8|we<<8)&8191,x+=we>>>5|E;var oe=0,me=oe;me+=C*P,me+=D*(5*w),me+=T*(5*de),me+=R*(5*ue),me+=q*(5*ie),oe=me>>>13,me&=8191,me+=K*(5*k),me+=se*(5*V),me+=L*(5*b),me+=M*(5*c),me+=x*(5*m),oe+=me>>>13,me&=8191;var he=oe;he+=C*m,he+=D*P,he+=T*(5*w),he+=R*(5*de),he+=q*(5*ue),oe=he>>>13,he&=8191,he+=K*(5*ie),he+=se*(5*k),he+=L*(5*V),he+=M*(5*b),he+=x*(5*c),oe+=he>>>13,he&=8191;var ve=oe;ve+=C*c,ve+=D*m,ve+=T*P,ve+=R*(5*w),ve+=q*(5*de),oe=ve>>>13,ve&=8191,ve+=K*(5*ue),ve+=se*(5*ie),ve+=L*(5*k),ve+=M*(5*V),ve+=x*(5*b),oe+=ve>>>13,ve&=8191;var j=oe;j+=C*b,j+=D*c,j+=T*m,j+=R*P,j+=q*(5*w),oe=j>>>13,j&=8191,j+=K*(5*de),j+=se*(5*ue),j+=L*(5*ie),j+=M*(5*k),j+=x*(5*V),oe+=j>>>13,j&=8191;var H=oe;H+=C*V,H+=D*b,H+=T*c,H+=R*m,H+=q*P,oe=H>>>13,H&=8191,H+=K*(5*w),H+=se*(5*de),H+=L*(5*ue),H+=M*(5*ie),H+=x*(5*k),oe+=H>>>13,H&=8191;var F=oe;F+=C*k,F+=D*V,F+=T*b,F+=R*c,F+=q*m,oe=F>>>13,F&=8191,F+=K*P,F+=se*(5*w),F+=L*(5*de),F+=M*(5*ue),F+=x*(5*ie),oe+=F>>>13,F&=8191;var d=oe;d+=C*ie,d+=D*k,d+=T*V,d+=R*b,d+=q*c,oe=d>>>13,d&=8191,d+=K*m,d+=se*P,d+=L*(5*w),d+=M*(5*de),d+=x*(5*ue),oe+=d>>>13,d&=8191;var A=oe;A+=C*ue,A+=D*ie,A+=T*k,A+=R*V,A+=q*b,oe=A>>>13,A&=8191,A+=K*c,A+=se*m,A+=L*P,A+=M*(5*w),A+=x*(5*de),oe+=A>>>13,A&=8191;var ae=oe;ae+=C*de,ae+=D*ue,ae+=T*ie,ae+=R*k,ae+=q*V,oe=ae>>>13,ae&=8191,ae+=K*b,ae+=se*c,ae+=L*m,ae+=M*P,ae+=x*(5*w),oe+=ae>>>13,ae&=8191;var le=oe;le+=C*w,le+=D*de,le+=T*ue,le+=R*ie,le+=q*k,oe=le>>>13,le&=8191,le+=K*V,le+=se*b,le+=L*c,le+=M*m,le+=x*P,oe+=le>>>13,le&=8191,oe=(oe<<2)+oe|0,oe=oe+me|0,me=oe&8191,oe=oe>>>13,he+=oe,C=me,D=he,T=ve,R=j,q=H,K=F,se=d,L=A,M=ae,x=le,_+=16,p-=16}this._h[0]=C,this._h[1]=D,this._h[2]=T,this._h[3]=R,this._h[4]=q,this._h[5]=K,this._h[6]=se,this._h[7]=L,this._h[8]=M,this._h[9]=x},h.prototype.finish=function(l,_){_===void 0&&(_=0);var p=new Uint16Array(10),E,C,D,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(E=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=E,E=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=E*5,E=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=E,E=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=E,p[0]=this._h[0]+5,E=p[0]>>>13,p[0]&=8191,T=1;T<10;T++)p[T]=this._h[T]+E,E=p[T]>>>13,p[T]&=8191;for(p[9]-=1<<13,C=(E^1)-1,T=0;T<10;T++)p[T]&=C;for(C=~C,T=0;T<10;T++)this._h[T]=this._h[T]&C|p[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,D=this._h[0]+this._pad[0],this._h[0]=D&65535,T=1;T<8;T++)D=(this._h[T]+this._pad[T]|0)+(D>>>16)|0,this._h[T]=D&65535;return l[_+0]=this._h[0]>>>0,l[_+1]=this._h[0]>>>8,l[_+2]=this._h[1]>>>0,l[_+3]=this._h[1]>>>8,l[_+4]=this._h[2]>>>0,l[_+5]=this._h[2]>>>8,l[_+6]=this._h[3]>>>0,l[_+7]=this._h[3]>>>8,l[_+8]=this._h[4]>>>0,l[_+9]=this._h[4]>>>8,l[_+10]=this._h[5]>>>0,l[_+11]=this._h[5]>>>8,l[_+12]=this._h[6]>>>0,l[_+13]=this._h[6]>>>8,l[_+14]=this._h[7]>>>0,l[_+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(l){var _=0,p=l.length,E;if(this._leftover){E=16-this._leftover,E>p&&(E=p);for(var C=0;C<E;C++)this._buffer[this._leftover+C]=l[_+C];if(p-=E,_+=E,this._leftover+=E,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(E=p-p%16,this._blocks(l,_,E),_+=E,p-=E),p){for(var C=0;C<p;C++)this._buffer[this._leftover+C]=l[_+C];this._leftover+=p}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var l=new Uint8Array(16);return this.finish(l),l},h.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();n.Poly1305=s;function o(h,l){var _=new s(h);_.update(l);var p=_.digest();return _.clean(),p}n.oneTimeAuth=o;function u(h,l){return h.length!==n.DIGEST_LENGTH||l.length!==n.DIGEST_LENGTH?!1:e.equal(h,l)}n.equal=u}(wh),function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=js,t=wh,s=Er,o=Ne,u=wn;n.KEY_LENGTH=32,n.NONCE_LENGTH=12,n.TAG_LENGTH=16;var h=new Uint8Array(16),l=function(){function _(p){if(this.nonceLength=n.NONCE_LENGTH,this.tagLength=n.TAG_LENGTH,p.length!==n.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return _.prototype.seal=function(p,E,C,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(p,T.length-p.length);var R=new Uint8Array(32);e.stream(this._key,T,R,4);var q=E.length+this.tagLength,K;if(D){if(D.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");K=D}else K=new Uint8Array(q);return e.streamXOR(this._key,T,E,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),R,K.subarray(0,K.length-this.tagLength),C),s.wipe(T),K},_.prototype.open=function(p,E,C,D){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(E.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(p,T.length-p.length);var R=new Uint8Array(32);e.stream(this._key,T,R,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,R,E.subarray(0,E.length-this.tagLength),C),!u.equal(q,E.subarray(E.length-this.tagLength,E.length)))return null;var K=E.length-this.tagLength,se;if(D){if(D.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");se=D}else se=new Uint8Array(K);return e.streamXOR(this._key,T,E.subarray(0,E.length-this.tagLength),se,4),s.wipe(T),se},_.prototype.clean=function(){return s.wipe(this._key),this},_.prototype._authenticate=function(p,E,C,D){var T=new t.Poly1305(E);D&&(T.update(D),D.length%16>0&&T.update(h.subarray(D.length%16))),T.update(C),C.length%16>0&&T.update(h.subarray(C.length%16));var R=new Uint8Array(8);D&&o.writeUint64LE(D.length,R),T.update(R),o.writeUint64LE(C.length,R),T.update(R);for(var q=T.digest(),K=0;K<q.length;K++)p[K]=q[K];T.clean(),s.wipe(q),s.wipe(R)},_}();n.ChaCha20Poly1305=l}(Ha);var Eh={},es={},qa={};Object.defineProperty(qa,"__esModule",{value:!0});function Q1(n){return typeof n.saveState<"u"&&typeof n.restoreState<"u"&&typeof n.cleanSavedState<"u"}qa.isSerializableHash=Q1,Object.defineProperty(es,"__esModule",{value:!0});var Yr=qa,ev=wn,tv=Er,Sh=function(){function n(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),Yr.isSerializableHash(this._inner)&&Yr.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),tv.wipe(s)}return n.prototype.reset=function(){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.clean=function(){Yr.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Yr.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},n.prototype.update=function(e){return this._inner.update(e),this},n.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},n.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},n.prototype.saveState=function(){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},n.prototype.restoreState=function(e){if(!Yr.isSerializableHash(this._inner)||!Yr.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},n.prototype.cleanSavedState=function(e){if(!Yr.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},n}();es.HMAC=Sh;function rv(n,e,t){var s=new Sh(n,e);s.update(t);var o=s.digest();return s.clean(),o}es.hmac=rv,es.equal=ev.equal,Object.defineProperty(Eh,"__esModule",{value:!0});var Dh=es,xh=Er,nv=function(){function n(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var u=Dh.hmac(this._hash,s,t);this._hmac=new Dh.HMAC(e,u),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},n.prototype.clean=function(){this._hmac.clean(),xh.wipe(this._buffer),xh.wipe(this._counter),this._bufpos=0},n}(),iv=Eh.HKDF=nv,qs={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var e=Ne,t=Er;n.DIGEST_LENGTH=32,n.BLOCK_SIZE=64;var s=function(){function l(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return l.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},l.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},l.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},l.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var E=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=_[E++],p--;this._bufferLength===this.blockSize&&(u(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(E=u(this._temp,this._state,_,E,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[E++],p--;return this},l.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,E=this._bufferLength,C=p/536870912|0,D=p<<3,T=p%64<56?64:128;this._buffer[E]=128;for(var R=E+1;R<T-8;R++)this._buffer[R]=0;e.writeUint32BE(C,this._buffer,T-8),e.writeUint32BE(D,this._buffer,T-4),u(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var R=0;R<this.digestLength/4;R++)e.writeUint32BE(this._state[R],_,R*4);return this},l.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},l.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},l.prototype.restoreState=function(_){return this._state.set(_.state),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},l.prototype.cleanSavedState=function(_){t.wipe(_.state),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},l}();n.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function u(l,_,p,E,C){for(;C>=64;){for(var D=_[0],T=_[1],R=_[2],q=_[3],K=_[4],se=_[5],L=_[6],M=_[7],x=0;x<16;x++){var P=E+x*4;l[x]=e.readUint32BE(p,P)}for(var x=16;x<64;x++){var m=l[x-2],c=(m>>>17|m<<32-17)^(m>>>19|m<<32-19)^m>>>10;m=l[x-15];var b=(m>>>7|m<<32-7)^(m>>>18|m<<32-18)^m>>>3;l[x]=(c+l[x-7]|0)+(b+l[x-16]|0)}for(var x=0;x<64;x++){var c=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&se^~K&L)|0)+(M+(o[x]+l[x]|0)|0)|0,b=((D>>>2|D<<32-2)^(D>>>13|D<<32-13)^(D>>>22|D<<32-22))+(D&T^D&R^T&R)|0;M=L,L=se,se=K,K=q+c|0,q=R,R=T,T=D,D=c+b|0}_[0]+=D,_[1]+=T,_[2]+=R,_[3]+=q,_[4]+=K,_[5]+=se,_[6]+=L,_[7]+=M,E+=64,C-=64}return E}function h(l){var _=new s;_.update(l);var p=_.digest();return _.clean(),p}n.hash=h})(qs);var za={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;const e=li,t=Er;n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=32,n.SHARED_KEY_LENGTH=32;function s(x){const P=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)P[m]=x[m];return P}const o=new Uint8Array(32);o[0]=9;const u=s([56129,1]);function h(x){let P=1;for(let m=0;m<16;m++){let c=x[m]+P+65535;P=Math.floor(c/65536),x[m]=c-P*65536}x[0]+=P-1+37*(P-1)}function l(x,P,m){const c=~(m-1);for(let b=0;b<16;b++){const V=c&(x[b]^P[b]);x[b]^=V,P[b]^=V}}function _(x,P){const m=s(),c=s();for(let b=0;b<16;b++)c[b]=P[b];h(c),h(c),h(c);for(let b=0;b<2;b++){m[0]=c[0]-65517;for(let k=1;k<15;k++)m[k]=c[k]-65535-(m[k-1]>>16&1),m[k-1]&=65535;m[15]=c[15]-32767-(m[14]>>16&1);const V=m[15]>>16&1;m[14]&=65535,l(c,m,1-V)}for(let b=0;b<16;b++)x[2*b]=c[b]&255,x[2*b+1]=c[b]>>8}function p(x,P){for(let m=0;m<16;m++)x[m]=P[2*m]+(P[2*m+1]<<8);x[15]&=32767}function E(x,P,m){for(let c=0;c<16;c++)x[c]=P[c]+m[c]}function C(x,P,m){for(let c=0;c<16;c++)x[c]=P[c]-m[c]}function D(x,P,m){let c,b,V=0,k=0,ie=0,ue=0,de=0,w=0,I=0,ee=0,X=0,G=0,W=0,J=0,re=0,we=0,oe=0,me=0,he=0,ve=0,j=0,H=0,F=0,d=0,A=0,ae=0,le=0,xe=0,qe=0,Ge=0,$e=0,gt=0,_t=0,Be=m[0],Oe=m[1],Le=m[2],Fe=m[3],He=m[4],Ae=m[5],Ue=m[6],De=m[7],Pe=m[8],ze=m[9],Ie=m[10],We=m[11],Ye=m[12],et=m[13],tt=m[14],Xe=m[15];c=P[0],V+=c*Be,k+=c*Oe,ie+=c*Le,ue+=c*Fe,de+=c*He,w+=c*Ae,I+=c*Ue,ee+=c*De,X+=c*Pe,G+=c*ze,W+=c*Ie,J+=c*We,re+=c*Ye,we+=c*et,oe+=c*tt,me+=c*Xe,c=P[1],k+=c*Be,ie+=c*Oe,ue+=c*Le,de+=c*Fe,w+=c*He,I+=c*Ae,ee+=c*Ue,X+=c*De,G+=c*Pe,W+=c*ze,J+=c*Ie,re+=c*We,we+=c*Ye,oe+=c*et,me+=c*tt,he+=c*Xe,c=P[2],ie+=c*Be,ue+=c*Oe,de+=c*Le,w+=c*Fe,I+=c*He,ee+=c*Ae,X+=c*Ue,G+=c*De,W+=c*Pe,J+=c*ze,re+=c*Ie,we+=c*We,oe+=c*Ye,me+=c*et,he+=c*tt,ve+=c*Xe,c=P[3],ue+=c*Be,de+=c*Oe,w+=c*Le,I+=c*Fe,ee+=c*He,X+=c*Ae,G+=c*Ue,W+=c*De,J+=c*Pe,re+=c*ze,we+=c*Ie,oe+=c*We,me+=c*Ye,he+=c*et,ve+=c*tt,j+=c*Xe,c=P[4],de+=c*Be,w+=c*Oe,I+=c*Le,ee+=c*Fe,X+=c*He,G+=c*Ae,W+=c*Ue,J+=c*De,re+=c*Pe,we+=c*ze,oe+=c*Ie,me+=c*We,he+=c*Ye,ve+=c*et,j+=c*tt,H+=c*Xe,c=P[5],w+=c*Be,I+=c*Oe,ee+=c*Le,X+=c*Fe,G+=c*He,W+=c*Ae,J+=c*Ue,re+=c*De,we+=c*Pe,oe+=c*ze,me+=c*Ie,he+=c*We,ve+=c*Ye,j+=c*et,H+=c*tt,F+=c*Xe,c=P[6],I+=c*Be,ee+=c*Oe,X+=c*Le,G+=c*Fe,W+=c*He,J+=c*Ae,re+=c*Ue,we+=c*De,oe+=c*Pe,me+=c*ze,he+=c*Ie,ve+=c*We,j+=c*Ye,H+=c*et,F+=c*tt,d+=c*Xe,c=P[7],ee+=c*Be,X+=c*Oe,G+=c*Le,W+=c*Fe,J+=c*He,re+=c*Ae,we+=c*Ue,oe+=c*De,me+=c*Pe,he+=c*ze,ve+=c*Ie,j+=c*We,H+=c*Ye,F+=c*et,d+=c*tt,A+=c*Xe,c=P[8],X+=c*Be,G+=c*Oe,W+=c*Le,J+=c*Fe,re+=c*He,we+=c*Ae,oe+=c*Ue,me+=c*De,he+=c*Pe,ve+=c*ze,j+=c*Ie,H+=c*We,F+=c*Ye,d+=c*et,A+=c*tt,ae+=c*Xe,c=P[9],G+=c*Be,W+=c*Oe,J+=c*Le,re+=c*Fe,we+=c*He,oe+=c*Ae,me+=c*Ue,he+=c*De,ve+=c*Pe,j+=c*ze,H+=c*Ie,F+=c*We,d+=c*Ye,A+=c*et,ae+=c*tt,le+=c*Xe,c=P[10],W+=c*Be,J+=c*Oe,re+=c*Le,we+=c*Fe,oe+=c*He,me+=c*Ae,he+=c*Ue,ve+=c*De,j+=c*Pe,H+=c*ze,F+=c*Ie,d+=c*We,A+=c*Ye,ae+=c*et,le+=c*tt,xe+=c*Xe,c=P[11],J+=c*Be,re+=c*Oe,we+=c*Le,oe+=c*Fe,me+=c*He,he+=c*Ae,ve+=c*Ue,j+=c*De,H+=c*Pe,F+=c*ze,d+=c*Ie,A+=c*We,ae+=c*Ye,le+=c*et,xe+=c*tt,qe+=c*Xe,c=P[12],re+=c*Be,we+=c*Oe,oe+=c*Le,me+=c*Fe,he+=c*He,ve+=c*Ae,j+=c*Ue,H+=c*De,F+=c*Pe,d+=c*ze,A+=c*Ie,ae+=c*We,le+=c*Ye,xe+=c*et,qe+=c*tt,Ge+=c*Xe,c=P[13],we+=c*Be,oe+=c*Oe,me+=c*Le,he+=c*Fe,ve+=c*He,j+=c*Ae,H+=c*Ue,F+=c*De,d+=c*Pe,A+=c*ze,ae+=c*Ie,le+=c*We,xe+=c*Ye,qe+=c*et,Ge+=c*tt,$e+=c*Xe,c=P[14],oe+=c*Be,me+=c*Oe,he+=c*Le,ve+=c*Fe,j+=c*He,H+=c*Ae,F+=c*Ue,d+=c*De,A+=c*Pe,ae+=c*ze,le+=c*Ie,xe+=c*We,qe+=c*Ye,Ge+=c*et,$e+=c*tt,gt+=c*Xe,c=P[15],me+=c*Be,he+=c*Oe,ve+=c*Le,j+=c*Fe,H+=c*He,F+=c*Ae,d+=c*Ue,A+=c*De,ae+=c*Pe,le+=c*ze,xe+=c*Ie,qe+=c*We,Ge+=c*Ye,$e+=c*et,gt+=c*tt,_t+=c*Xe,V+=38*he,k+=38*ve,ie+=38*j,ue+=38*H,de+=38*F,w+=38*d,I+=38*A,ee+=38*ae,X+=38*le,G+=38*xe,W+=38*qe,J+=38*Ge,re+=38*$e,we+=38*gt,oe+=38*_t,b=1,c=V+b+65535,b=Math.floor(c/65536),V=c-b*65536,c=k+b+65535,b=Math.floor(c/65536),k=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=w+b+65535,b=Math.floor(c/65536),w=c-b*65536,c=I+b+65535,b=Math.floor(c/65536),I=c-b*65536,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=J+b+65535,b=Math.floor(c/65536),J=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,V+=b-1+37*(b-1),b=1,c=V+b+65535,b=Math.floor(c/65536),V=c-b*65536,c=k+b+65535,b=Math.floor(c/65536),k=c-b*65536,c=ie+b+65535,b=Math.floor(c/65536),ie=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=w+b+65535,b=Math.floor(c/65536),w=c-b*65536,c=I+b+65535,b=Math.floor(c/65536),I=c-b*65536,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=X+b+65535,b=Math.floor(c/65536),X=c-b*65536,c=G+b+65535,b=Math.floor(c/65536),G=c-b*65536,c=W+b+65535,b=Math.floor(c/65536),W=c-b*65536,c=J+b+65535,b=Math.floor(c/65536),J=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,c=we+b+65535,b=Math.floor(c/65536),we=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,V+=b-1+37*(b-1),x[0]=V,x[1]=k,x[2]=ie,x[3]=ue,x[4]=de,x[5]=w,x[6]=I,x[7]=ee,x[8]=X,x[9]=G,x[10]=W,x[11]=J,x[12]=re,x[13]=we,x[14]=oe,x[15]=me}function T(x,P){D(x,P,P)}function R(x,P){const m=s();for(let c=0;c<16;c++)m[c]=P[c];for(let c=253;c>=0;c--)T(m,m),c!==2&&c!==4&&D(m,m,P);for(let c=0;c<16;c++)x[c]=m[c]}function q(x,P){const m=new Uint8Array(32),c=new Float64Array(80),b=s(),V=s(),k=s(),ie=s(),ue=s(),de=s();for(let X=0;X<31;X++)m[X]=x[X];m[31]=x[31]&127|64,m[0]&=248,p(c,P);for(let X=0;X<16;X++)V[X]=c[X];b[0]=ie[0]=1;for(let X=254;X>=0;--X){const G=m[X>>>3]>>>(X&7)&1;l(b,V,G),l(k,ie,G),E(ue,b,k),C(b,b,k),E(k,V,ie),C(V,V,ie),T(ie,ue),T(de,b),D(b,k,b),D(k,V,ue),E(ue,b,k),C(b,b,k),T(V,b),C(k,ie,de),D(b,k,u),E(b,b,ie),D(k,k,b),D(b,ie,de),D(ie,V,c),T(V,ue),l(b,V,G),l(k,ie,G)}for(let X=0;X<16;X++)c[X+16]=b[X],c[X+32]=k[X],c[X+48]=V[X],c[X+64]=ie[X];const w=c.subarray(32),I=c.subarray(16);R(w,w),D(I,I,w);const ee=new Uint8Array(32);return _(ee,I),ee}n.scalarMult=q;function K(x){return q(x,o)}n.scalarMultBase=K;function se(x){if(x.length!==n.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`);const P=new Uint8Array(x);return{publicKey:K(P),secretKey:P}}n.generateKeyPairFromSeed=se;function L(x){const P=(0,e.randomBytes)(32,x),m=se(P);return(0,t.wipe)(P),m}n.generateKeyPair=L;function M(x,P,m=!1){if(x.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(P.length!==n.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=q(x,P);if(m){let b=0;for(let V=0;V<c.length;V++)b|=c[V];if(b===0)throw new Error("X25519: invalid shared key")}return c}n.sharedKey=M})(za);var Oh=function(n,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,u;s<o;s++)(u||!(s in e))&&(u||(u=Array.prototype.slice.call(e,0,s)),u[s]=e[s]);return n.concat(u||Array.prototype.slice.call(e))},sv=function(){function n(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return n}(),ov=function(){function n(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return n}(),av=function(){function n(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return n}(),uv=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),cv=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),fv=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,hv=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ih=3,lv=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",fv]],Ah=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function dv(n){return n?Ph(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new cv:typeof navigator<"u"?Ph(navigator.userAgent):_v()}function pv(n){return n!==""&&lv.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var u=o.exec(n);return!!u&&[s,u]},!1)}function Ph(n){var e=pv(n);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new uv;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<Ih&&(o=Oh(Oh([],o,!0),yv(Ih-o.length),!0)):o=[];var u=o.join("."),h=gv(n),l=hv.exec(n);return l&&l[1]?new av(t,u,h,l[1]):new sv(t,u,h)}function gv(n){for(var e=0,t=Ah.length;e<t;e++){var s=Ah[e],o=s[0],u=s[1],h=u.exec(n);if(h)return o}return null}function _v(){var n=typeof process<"u"&&process.version;return n?new ov(process.version.slice(1)):null}function yv(n){for(var e=[],t=0;t<n;t++)e.push("0");return e}var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.getLocalStorage=ht.getLocalStorageOrThrow=ht.getCrypto=ht.getCryptoOrThrow=Th=ht.getLocation=ht.getLocationOrThrow=Ka=ht.getNavigator=ht.getNavigatorOrThrow=Ch=ht.getDocument=ht.getDocumentOrThrow=ht.getFromWindowOrThrow=ht.getFromWindow=void 0;function zn(n){let e;return typeof window<"u"&&typeof window[n]<"u"&&(e=window[n]),e}ht.getFromWindow=zn;function di(n){const e=zn(n);if(!e)throw new Error(`${n} is not defined in Window`);return e}ht.getFromWindowOrThrow=di;function vv(){return di("document")}ht.getDocumentOrThrow=vv;function bv(){return zn("document")}var Ch=ht.getDocument=bv;function wv(){return di("navigator")}ht.getNavigatorOrThrow=wv;function mv(){return zn("navigator")}var Ka=ht.getNavigator=mv;function Ev(){return di("location")}ht.getLocationOrThrow=Ev;function Sv(){return zn("location")}var Th=ht.getLocation=Sv;function Dv(){return di("crypto")}ht.getCryptoOrThrow=Dv;function xv(){return zn("crypto")}ht.getCrypto=xv;function Ov(){return di("localStorage")}ht.getLocalStorageOrThrow=Ov;function Iv(){return zn("localStorage")}ht.getLocalStorage=Iv;var Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});var Rh=Ga.getWindowMetadata=void 0;const Nh=ht;function Av(){let n,e;try{n=Nh.getDocumentOrThrow(),e=Nh.getLocationOrThrow()}catch{return null}function t(){const C=n.getElementsByTagName("link"),D=[];for(let T=0;T<C.length;T++){const R=C[T],q=R.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const K=R.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let se=e.protocol+"//"+e.host;if(K.indexOf("/")===0)se+=K;else{const L=e.pathname.split("/");L.pop();const M=L.join("/");se+=M+"/"+K}D.push(se)}else if(K.indexOf("//")===0){const se=e.protocol+K;D.push(se)}else D.push(K)}}return D}function s(...C){const D=n.getElementsByTagName("meta");for(let T=0;T<D.length;T++){const R=D[T],q=["itemprop","property","name"].map(K=>R.getAttribute(K)).filter(K=>K?C.includes(K):!1);if(q.length&&q){const K=R.getAttribute("content");if(K)return K}}return""}function o(){let C=s("name","og:site_name","og:title","twitter:title");return C||(C=n.title),C}function u(){return s("description","og:description","twitter:description","keywords")}const h=o(),l=u(),_=e.origin,p=t();return{description:l,url:_,icons:p,name:h}}Rh=Ga.getWindowMetadata=Av;var ts={},Pv=n=>encodeURIComponent(n).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Lh="%[a-f0-9]{2}",Fh=new RegExp("("+Lh+")|([^%]+?)","gi"),Uh=new RegExp("("+Lh+")+","gi");function Wa(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;var t=n.slice(0,e),s=n.slice(e);return Array.prototype.concat.call([],Wa(t),Wa(s))}function Cv(n){try{return decodeURIComponent(n)}catch{for(var e=n.match(Fh)||[],t=1;t<e.length;t++)n=Wa(e,t).join(""),e=n.match(Fh)||[];return n}}function Tv(n){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},t=Uh.exec(n);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=Cv(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Uh.exec(n)}e["%C2"]="\uFFFD";for(var o=Object.keys(e),u=0;u<o.length;u++){var h=o[u];n=n.replace(new RegExp(h,"g"),e[h])}return n}var Rv=function(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return n=n.replace(/\+/g," "),decodeURIComponent(n)}catch{return Tv(n)}},Nv=(n,e)=>{if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[n];const t=n.indexOf(e);return t===-1?[n]:[n.slice(0,t),n.slice(t+e.length)]},Lv=function(n,e){for(var t={},s=Object.keys(n),o=Array.isArray(e),u=0;u<s.length;u++){var h=s[u],l=n[h];(o?e.indexOf(h)!==-1:e(h,l,n))&&(t[h]=l)}return t};(function(n){const e=Pv,t=Rv,s=Nv,o=Lv,u=L=>L==null,h=Symbol("encodeFragmentIdentifier");function l(L){switch(L.arrayFormat){case"index":return M=>(x,P)=>{const m=x.length;return P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),"[",m,"]"].join("")]:[...x,[E(M,L),"[",E(m,L),"]=",E(P,L)].join("")]};case"bracket":return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),"[]"].join("")]:[...x,[E(M,L),"[]=",E(P,L)].join("")];case"colon-list-separator":return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,[E(M,L),":list="].join("")]:[...x,[E(M,L),":list=",E(P,L)].join("")];case"comma":case"separator":case"bracket-separator":{const M=L.arrayFormat==="bracket-separator"?"[]=":"=";return x=>(P,m)=>m===void 0||L.skipNull&&m===null||L.skipEmptyString&&m===""?P:(m=m===null?"":m,P.length===0?[[E(x,L),M,E(m,L)].join("")]:[[P,E(m,L)].join(L.arrayFormatSeparator)])}default:return M=>(x,P)=>P===void 0||L.skipNull&&P===null||L.skipEmptyString&&P===""?x:P===null?[...x,E(M,L)]:[...x,[E(M,L),"=",E(P,L)].join("")]}}function _(L){let M;switch(L.arrayFormat){case"index":return(x,P,m)=>{if(M=/\[(\d*)\]$/.exec(x),x=x.replace(/\[\d*\]$/,""),!M){m[x]=P;return}m[x]===void 0&&(m[x]={}),m[x][M[1]]=P};case"bracket":return(x,P,m)=>{if(M=/(\[\])$/.exec(x),x=x.replace(/\[\]$/,""),!M){m[x]=P;return}if(m[x]===void 0){m[x]=[P];return}m[x]=[].concat(m[x],P)};case"colon-list-separator":return(x,P,m)=>{if(M=/(:list)$/.exec(x),x=x.replace(/:list$/,""),!M){m[x]=P;return}if(m[x]===void 0){m[x]=[P];return}m[x]=[].concat(m[x],P)};case"comma":case"separator":return(x,P,m)=>{const c=typeof P=="string"&&P.includes(L.arrayFormatSeparator),b=typeof P=="string"&&!c&&C(P,L).includes(L.arrayFormatSeparator);P=b?C(P,L):P;const V=c||b?P.split(L.arrayFormatSeparator).map(k=>C(k,L)):P===null?P:C(P,L);m[x]=V};case"bracket-separator":return(x,P,m)=>{const c=/(\[\])$/.test(x);if(x=x.replace(/\[\]$/,""),!c){m[x]=P&&C(P,L);return}const b=P===null?[]:P.split(L.arrayFormatSeparator).map(V=>C(V,L));if(m[x]===void 0){m[x]=b;return}m[x]=[].concat(m[x],b)};default:return(x,P,m)=>{if(m[x]===void 0){m[x]=P;return}m[x]=[].concat(m[x],P)}}}function p(L){if(typeof L!="string"||L.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(L,M){return M.encode?M.strict?e(L):encodeURIComponent(L):L}function C(L,M){return M.decode?t(L):L}function D(L){return Array.isArray(L)?L.sort():typeof L=="object"?D(Object.keys(L)).sort((M,x)=>Number(M)-Number(x)).map(M=>L[M]):L}function T(L){const M=L.indexOf("#");return M!==-1&&(L=L.slice(0,M)),L}function R(L){let M="";const x=L.indexOf("#");return x!==-1&&(M=L.slice(x)),M}function q(L){L=T(L);const M=L.indexOf("?");return M===-1?"":L.slice(M+1)}function K(L,M){return M.parseNumbers&&!Number.isNaN(Number(L))&&typeof L=="string"&&L.trim()!==""?L=Number(L):M.parseBooleans&&L!==null&&(L.toLowerCase()==="true"||L.toLowerCase()==="false")&&(L=L.toLowerCase()==="true"),L}function se(L,M){M=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},M),p(M.arrayFormatSeparator);const x=_(M),P=Object.create(null);if(typeof L!="string"||(L=L.trim().replace(/^[?#&]/,""),!L))return P;for(const m of L.split("&")){if(m==="")continue;let[c,b]=s(M.decode?m.replace(/\+/g," "):m,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(M.arrayFormat)?b:C(b,M),x(C(c,M),b,P)}for(const m of Object.keys(P)){const c=P[m];if(typeof c=="object"&&c!==null)for(const b of Object.keys(c))c[b]=K(c[b],M);else P[m]=K(c,M)}return M.sort===!1?P:(M.sort===!0?Object.keys(P).sort():Object.keys(P).sort(M.sort)).reduce((m,c)=>{const b=P[c];return Boolean(b)&&typeof b=="object"&&!Array.isArray(b)?m[c]=D(b):m[c]=b,m},Object.create(null))}n.extract=q,n.parse=se,n.stringify=(L,M)=>{if(!L)return"";M=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},M),p(M.arrayFormatSeparator);const x=b=>M.skipNull&&u(L[b])||M.skipEmptyString&&L[b]==="",P=l(M),m={};for(const b of Object.keys(L))x(b)||(m[b]=L[b]);const c=Object.keys(m);return M.sort!==!1&&c.sort(M.sort),c.map(b=>{const V=L[b];return V===void 0?"":V===null?E(b,M):Array.isArray(V)?V.length===0&&M.arrayFormat==="bracket-separator"?E(b,M)+"[]":V.reduce(P(b),[]).join("&"):E(b,M)+"="+E(V,M)}).filter(b=>b.length>0).join("&")},n.parseUrl=(L,M)=>{M=Object.assign({decode:!0},M);const[x,P]=s(L,"#");return Object.assign({url:x.split("?")[0]||"",query:se(q(L),M)},M&&M.parseFragmentIdentifier&&P?{fragmentIdentifier:C(P,M)}:{})},n.stringifyUrl=(L,M)=>{M=Object.assign({encode:!0,strict:!0,[h]:!0},M);const x=T(L.url).split("?")[0]||"",P=n.extract(L.url),m=n.parse(P,{sort:!1}),c=Object.assign(m,L.query);let b=n.stringify(c,M);b&&(b=`?${b}`);let V=R(L.url);return L.fragmentIdentifier&&(V=`#${M[h]?E(L.fragmentIdentifier,M):L.fragmentIdentifier}`),`${x}${b}${V}`},n.pick=(L,M,x)=>{x=Object.assign({parseFragmentIdentifier:!0,[h]:!1},x);const{url:P,query:m,fragmentIdentifier:c}=n.parseUrl(L,x);return n.stringifyUrl({url:P,query:o(m,M),fragmentIdentifier:c},x)},n.exclude=(L,M,x)=>{const P=Array.isArray(M)?m=>!M.includes(m):(m,c)=>!M(m,c);return n.pick(L,P,x)}})(ts);const Fv={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function $h(n,e){return n.includes(":")?[n]:e.chains||[]}const Mh="base10",sr="base16",Va="base64pad",Ya="utf8",Bh=0,Kn=1,Uv=0,Hh=1,ka=12,Ja=32;function $v(){const n=za.generateKeyPair();return{privateKey:ir(n.secretKey,sr),publicKey:ir(n.publicKey,sr)}}function Xa(){const n=li.randomBytes(Ja);return ir(n,sr)}function Mv(n,e){const t=za.sharedKey(pr(n,sr),pr(e,sr)),s=new iv(qs.SHA256,t).expand(Ja);return ir(s,sr)}function Bv(n){const e=qs.hash(pr(n,sr));return ir(e,sr)}function pi(n){const e=qs.hash(pr(n,Ya));return ir(e,sr)}function Hv(n){return pr(`${n}`,Mh)}function rs(n){return Number(ir(n,Mh))}function jv(n){const e=Hv(typeof n.type<"u"?n.type:Bh);if(rs(e)===Kn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof n.senderPublicKey<"u"?pr(n.senderPublicKey,sr):void 0,s=typeof n.iv<"u"?pr(n.iv,sr):li.randomBytes(ka),o=new Ha.ChaCha20Poly1305(pr(n.symKey,sr)).seal(s,pr(n.message,Ya));return zv({type:e,sealed:o,iv:s,senderPublicKey:t})}function qv(n){const e=new Ha.ChaCha20Poly1305(pr(n.symKey,sr)),{sealed:t,iv:s}=zs(n.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return ir(o,Ya)}function zv(n){if(rs(n.type)===Kn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ir(Ua([n.type,n.senderPublicKey,n.iv,n.sealed]),Va)}return ir(Ua([n.type,n.iv,n.sealed]),Va)}function zs(n){const e=pr(n,Va),t=e.slice(Uv,Hh),s=Hh;if(rs(t)===Kn){const l=s+Ja,_=l+ka,p=e.slice(s,l),E=e.slice(l,_),C=e.slice(_);return{type:t,sealed:C,iv:E,senderPublicKey:p}}const o=s+ka,u=e.slice(s,o),h=e.slice(o);return{type:t,sealed:h,iv:u}}function Kv(n,e){const t=zs(n);return jh({type:rs(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ir(t.senderPublicKey,sr):void 0,receiverPublicKey:e?.receiverPublicKey})}function jh(n){const e=n?.type||Bh;if(e===Kn){if(typeof n?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof n?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:n?.senderPublicKey,receiverPublicKey:n?.receiverPublicKey}}function qh(n){return n.type===Kn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var Gv=Object.defineProperty,zh=Object.getOwnPropertySymbols,Wv=Object.prototype.hasOwnProperty,Vv=Object.prototype.propertyIsEnumerable,Kh=(n,e,t)=>e in n?Gv(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Gh=(n,e)=>{for(var t in e||(e={}))Wv.call(e,t)&&Kh(n,t,e[t]);if(zh)for(var t of zh(e))Vv.call(e,t)&&Kh(n,t,e[t]);return n};const Yv="ReactNative",Gn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},kv="js";function Za(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Wh(){return!Ch()&&!!Ka()&&navigator.product===Yv}function Qa(){return!Za()&&!!Ka()}function Vh(){return Wh()?Gn.reactNative:Za()?Gn.node:Qa()?Gn.browser:Gn.unknown}function Jv(n,e){let t=ts.parse(n);return t=Gh(Gh({},t),e),n=ts.stringify(t),n}function Xv(){return Rh()||{name:"",description:"",url:"",icons:[""]}}function Zv(){const n=dv();if(n===null)return"unknown";const e=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[e,n.name,n.version].join("-"):[e,n.version].join("-")}function Qv(){var n;const e=Vh();return e===Gn.browser?[e,((n=Th())==null?void 0:n.host)||"unknown"].join(":"):e}function eb(n,e,t){const s=Zv(),o=Qv();return[[n,e].join("-"),[kv,t].join("-"),s,o].join("/")}function tb({protocol:n,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:u,useOnCloseEvent:h}){const l=t.split("?"),_=eb(n,e,s),p={auth:o,ua:_,projectId:u,useOnCloseEvent:h||void 0},E=Jv(l[1]||"",p);return l[0]+"?"+E}function Wn(n,e){return n.filter(t=>e.includes(t)).length===n.length}function Yh(n){return Object.fromEntries(n.entries())}function kh(n){return new Map(Object.entries(n))}function gi(n=ye.FIVE_MINUTES,e){const t=ye.toMiliseconds(n||ye.FIVE_MINUTES);let s,o,u;return{resolve:h=>{u&&s&&(clearTimeout(u),s(h))},reject:h=>{u&&o&&(clearTimeout(u),o(h))},done:()=>new Promise((h,l)=>{u=setTimeout(()=>{l(new Error(e))},t),s=h,o=l})}}function Ks(n,e,t){return new Promise(async(s,o)=>{const u=setTimeout(()=>o(new Error(t)),e);try{const h=await n;s(h)}catch(h){o(h)}clearTimeout(u)})}function Jh(n,e){if(typeof e=="string"&&e.startsWith(`${n}:`))return e;if(n.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(n.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${n}`)}function rb(n){return Jh("topic",n)}function nb(n){return Jh("id",n)}function Xh(n){const[e,t]=n.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function kr(n,e){return ye.fromMiliseconds((e||Date.now())+ye.toMiliseconds(n))}function mn(n){return Date.now()>=ye.toMiliseconds(n)}function Ft(n,e){return`${n}${e?`:${e}`:""}`}function eu(n=[],e=[]){return[...new Set([...n,...e])]}const ib="irn";function tu(n){return n?.relay||{protocol:ib}}function Gs(n){const e=Fv[n];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${n}`);return e}var sb=Object.defineProperty,Zh=Object.getOwnPropertySymbols,ob=Object.prototype.hasOwnProperty,ab=Object.prototype.propertyIsEnumerable,Qh=(n,e,t)=>e in n?sb(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ub=(n,e)=>{for(var t in e||(e={}))ob.call(e,t)&&Qh(n,t,e[t]);if(Zh)for(var t of Zh(e))ab.call(e,t)&&Qh(n,t,e[t]);return n};function cb(n,e="-"){const t={},s="relay"+e;return Object.keys(n).forEach(o=>{if(o.startsWith(s)){const u=o.replace(s,""),h=n[o];t[u]=h}}),t}function fb(n){const e=n.indexOf(":"),t=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,e),o=n.substring(e+1,t).split("@"),u=typeof t<"u"?n.substring(t):"",h=ts.parse(u);return{protocol:s,topic:hb(o[0]),version:parseInt(o[1],10),symKey:h.symKey,relay:cb(h)}}function hb(n){return n.startsWith("//")?n.substring(2):n}function lb(n,e="-"){const t="relay",s={};return Object.keys(n).forEach(o=>{const u=t+e+o;n[o]&&(s[u]=n[o])}),s}function db(n){return`${n.protocol}:${n.topic}@${n.version}?`+ts.stringify(ub({symKey:n.symKey},lb(n.relay)))}function _i(n){const e=[];return n.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function pb(n){const e=[];return Object.values(n).forEach(t=>{e.push(..._i(t.accounts))}),e}function gb(n,e){const t=[];return Object.values(n).forEach(s=>{_i(s.accounts).includes(e)&&t.push(...s.methods)}),t}function _b(n,e){const t=[];return Object.values(n).forEach(s=>{_i(s.accounts).includes(e)&&t.push(...s.events)}),t}function yb(n,e){const t=Vs(n,e);if(t)throw new Error(t.message);const s={};for(const[o,u]of Object.entries(n))s[o]={methods:u.methods,events:u.events,chains:u.accounts.map(h=>`${h.split(":")[0]}:${h.split(":")[1]}`)};return s}function el(n){return n.includes(":")}function Ws(n){return el(n)?n.split(":")[0]:n}const vb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},bb={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function fe(n,e){const{message:t,code:s}=bb[n];return{message:e?`${t} ${e}`:t,code:s}}function Ut(n,e){const{message:t,code:s}=vb[n];return{message:e?`${t} ${e}`:t,code:s}}function yi(n,e){return Array.isArray(n)?typeof e<"u"&&n.length?n.every(e):!0:!1}function vi(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function or(n){return typeof n>"u"}function Vt(n,e){return e&&or(n)?!0:typeof n=="string"&&Boolean(n.trim().length)}function ru(n,e){return e&&or(n)?!0:typeof n=="number"&&!isNaN(n)}function wb(n,e){const{requiredNamespaces:t}=e,s=Object.keys(n.namespaces),o=Object.keys(t);let u=!0;return Wn(o,s)?(s.forEach(h=>{const{accounts:l,methods:_,events:p}=n.namespaces[h],E=_i(l),C=t[h];(!Wn($h(h,C),E)||!Wn(C.methods,_)||!Wn(C.events,p))&&(u=!1)}),u):!1}function nu(n){return Vt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function mb(n){if(Vt(n,!1)&&n.includes(":")){const e=n.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&nu(t)}}return!1}function Eb(n){if(Vt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Sb(n){var e;return(e=n?.proposer)==null?void 0:e.publicKey}function Db(n){return n?.topic}function xb(n,e){let t=null;return Vt(n?.publicKey,!1)||(t=fe("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function tl(n){let e=!0;return yi(n)?n.length&&(e=n.every(t=>Vt(t,!1))):e=!1,e}function Ob(n,e,t){let s=null;return yi(e)?e.forEach(o=>{s||(!nu(o)||!o.includes(n))&&(s=Ut("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):s=Ut("UNSUPPORTED_CHAINS",`${t}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),s}function Ib(n,e){let t=null;return Object.entries(n).forEach(([s,o])=>{if(t)return;const u=Ob(s,$h(s,o),`${e} requiredNamespace`);u&&(t=u)}),t}function Ab(n,e){let t=null;return yi(n)?n.forEach(s=>{t||mb(s)||(t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=Ut("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function Pb(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=Ab(s?.accounts,`${e} namespace`);o&&(t=o)}),t}function Cb(n,e){let t=null;return tl(n?.methods)?tl(n?.events)||(t=Ut("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ut("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function rl(n,e){let t=null;return Object.values(n).forEach(s=>{if(t)return;const o=Cb(s,`${e}, namespace`);o&&(t=o)}),t}function Tb(n,e,t){let s=null;if(n&&vi(n)){const o=rl(n,e);o&&(s=o);const u=Ib(n,e);u&&(s=u)}else s=fe("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Vs(n,e){let t=null;if(n&&vi(n)){const s=rl(n,e);s&&(t=s);const o=Pb(n,e);o&&(t=o)}else t=fe("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function nl(n){return Vt(n.protocol,!0)}function Rb(n,e){let t=!1;return e&&!n?t=!0:n&&yi(n)&&n.length&&n.forEach(s=>{t=nl(s)}),t}function Nb(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function Lb(n){return!(!n||typeof n!="object"||!n.code||!ru(n.code,!1)||!n.message||!Vt(n.message,!1))}function Fb(n){return!(or(n)||!Vt(n.method,!1))}function Ub(n){return!(or(n)||or(n.result)&&or(n.error)||!ru(n.id,!1)||!Vt(n.jsonrpc,!1))}function $b(n){return!(or(n)||!Vt(n.name,!1))}function il(n,e){return!(!nu(e)||!pb(n).includes(e))}function Mb(n,e,t){return Vt(t,!1)?gb(n,e).includes(t):!1}function Bb(n,e,t){return Vt(t,!1)?_b(n,e).includes(t):!1}function sl(n,e,t){let s=null;const o=Hb(n),u=jb(e),h=Object.keys(o),l=Object.keys(u),_=ol(Object.keys(n)),p=ol(Object.keys(e)),E=_.filter(C=>!p.includes(C));return E.length&&(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(e).toString()}`)),Wn(h,l)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${l.toString()}`)),Object.keys(e).forEach(C=>{if(!C.includes(":")||s)return;const D=_i(e[C].accounts);D.includes(C)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${C}
        Required: ${C}
        Approved: ${D.toString()}`))}),h.forEach(C=>{s||(Wn(o[C].methods,u[C].methods)?Wn(o[C].events,u[C].events)||(s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${C}`)):s=fe("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${C}`))}),s}function Hb(n){const e={};return Object.keys(n).forEach(t=>{var s;t.includes(":")?e[t]=n[t]:(s=n[t].chains)==null||s.forEach(o=>{e[o]={methods:n[t].methods,events:n[t].events}})}),e}function ol(n){return[...new Set(n.map(e=>e.includes(":")?e.split(":")[0]:e))]}function jb(n){const e={};return Object.keys(n).forEach(t=>{if(t.includes(":"))e[t]=n[t];else{const s=_i(n[t].accounts);s?.forEach(o=>{e[o]={accounts:n[t].accounts.filter(u=>u.includes(`${o}:`)),methods:n[t].methods,events:n[t].events}})}}),e}function qb(n,e){return ru(n,!1)&&n<=e.max&&n>=e.min}const zb="PARSE_ERROR",Kb="INVALID_REQUEST",Gb="METHOD_NOT_FOUND",Wb="INVALID_PARAMS",al="INTERNAL_ERROR",iu="SERVER_ERROR",Vb=[-32700,-32600,-32601,-32602,-32603],ns={[zb]:{code:-32700,message:"Parse error"},[Kb]:{code:-32600,message:"Invalid Request"},[Gb]:{code:-32601,message:"Method not found"},[Wb]:{code:-32602,message:"Invalid params"},[al]:{code:-32603,message:"Internal error"},[iu]:{code:-32e3,message:"Server error"}},ul=iu;function Yb(n){return Vb.includes(n)}function cl(n){return Object.keys(ns).includes(n)?ns[n]:ns[ul]}function kb(n){const e=Object.values(ns).find(t=>t.code===n);return e||ns[ul]}function fl(n,e,t){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):n}var hl={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var su=function(n,e){return su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},su(n,e)};function Jb(n,e){su(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ou=function(){return ou=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var u in t)Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u])}return e},ou.apply(this,arguments)};function Xb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(t[s[o]]=n[s[o]]);return t}function Zb(n,e,t,s){var o=arguments.length,u=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(h=n[l])&&(u=(o<3?h(u):o>3?h(e,t,u):h(e,t))||u);return o>3&&u&&Object.defineProperty(e,t,u),u}function Qb(n,e){return function(t,s){e(t,s,n)}}function ew(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function tw(n,e,t,s){function o(u){return u instanceof t?u:new t(function(h){h(u)})}return new(t||(t=Promise))(function(u,h){function l(E){try{p(s.next(E))}catch(C){h(C)}}function _(E){try{p(s.throw(E))}catch(C){h(C)}}function p(E){E.done?u(E.value):o(E.value).then(l,_)}p((s=s.apply(n,e||[])).next())})}function rw(n,e){var t={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,o,u,h;return h={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function l(p){return function(E){return _([p,E])}}function _(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(u=t.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){t.label=p[1];break}if(p[0]===6&&t.label<u[1]){t.label=u[1],u=p;break}if(u&&t.label<u[2]){t.label=u[2],t.ops.push(p);break}u[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(E){p=[6,E],o=0}finally{s=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function nw(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]}function iw(n,e){for(var t in n)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function au(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ll(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),o,u=[],h;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)u.push(o.value)}catch(l){h={error:l}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(h)throw h.error}}return u}function sw(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(ll(arguments[e]));return n}function ow(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),o=0,e=0;e<t;e++)for(var u=arguments[e],h=0,l=u.length;h<l;h++,o++)s[o]=u[h];return s}function is(n){return this instanceof is?(this.v=n,this):new is(n)}function aw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(D){s[D]&&(o[D]=function(T){return new Promise(function(R,q){u.push([D,T,R,q])>1||l(D,T)})})}function l(D,T){try{_(s[D](T))}catch(R){C(u[0][3],R)}}function _(D){D.value instanceof is?Promise.resolve(D.value.v).then(p,E):C(u[0][2],D)}function p(D){l("next",D)}function E(D){l("throw",D)}function C(D,T){D(T),u.shift(),u.length&&l(u[0][0],u[0][1])}}function uw(n){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,u){e[o]=n[o]?function(h){return(t=!t)?{value:is(n[o](h)),done:o==="return"}:u?u(h):h}:u}}function cw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof au=="function"?au(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(u){t[u]=n[u]&&function(h){return new Promise(function(l,_){h=n[u](h),o(l,_,h.done,h.value)})}}function o(u,h,l,_){Promise.resolve(_).then(function(p){u({value:p,done:l})},h)}}function fw(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}function hw(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e.default=n,e}function lw(n){return n&&n.__esModule?n:{default:n}}function dw(n,e){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return e.get(n)}function pw(n,e,t){if(!e.has(n))throw new TypeError("attempted to set private field on non-instance");return e.set(n,t),t}var gw=Object.freeze({__proto__:null,__extends:Jb,get __assign(){return ou},__rest:Xb,__decorate:Zb,__param:Qb,__metadata:ew,__awaiter:tw,__generator:rw,__createBinding:nw,__exportStar:iw,__values:au,__read:ll,__spread:sw,__spreadArrays:ow,__await:is,__asyncGenerator:aw,__asyncDelegator:uw,__asyncValues:cw,__makeTemplateObject:fw,__importStar:hw,__importDefault:lw,__classPrivateFieldGet:dw,__classPrivateFieldSet:pw}),_w=$n(gw),sn={},dl;function yw(){if(dl)return sn;dl=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.isBrowserCryptoAvailable=sn.getSubtleCrypto=sn.getBrowerCrypto=void 0;function n(){return wt?.crypto||wt?.msCrypto||{}}sn.getBrowerCrypto=n;function e(){const s=n();return s.subtle||s.webkitSubtle}sn.getSubtleCrypto=e;function t(){return!!n()&&!!e()}return sn.isBrowserCryptoAvailable=t,sn}var on={},pl;function vw(){if(pl)return on;pl=1,Object.defineProperty(on,"__esModule",{value:!0}),on.isBrowser=on.isNode=on.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}on.isReactNative=n;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}on.isNode=e;function t(){return!n()&&!e()}return on.isBrowser=t,on}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const e=_w;e.__exportStar(yw(),n),e.__exportStar(vw(),n)})(hl);function gl(n=3){const e=Date.now()*Math.pow(10,n),t=Math.floor(Math.random()*Math.pow(10,n));return e+t}function _l(n=6){return BigInt(gl(n))}function Ys(n,e,t){return{id:t||gl(),jsonrpc:"2.0",method:n,params:e}}function uu(n,e){return{id:n,jsonrpc:"2.0",result:e}}function ks(n,e,t){return{id:n,jsonrpc:"2.0",error:bw(e,t)}}function bw(n,e){return typeof n>"u"?cl(al):(typeof n=="string"&&(n=Object.assign(Object.assign({},cl(iu)),{message:n})),typeof e<"u"&&(n.data=e),Yb(n.code)&&(n=kb(n.code)),n)}class ww{}class mw extends ww{constructor(){super()}}class Ew extends mw{constructor(e){super()}}const Sw="^https?:",Dw="^wss?:";function xw(n){const e=n.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function yl(n,e){const t=xw(n);return typeof t>"u"?!1:new RegExp(e).test(t)}function vl(n){return yl(n,Sw)}function bl(n){return yl(n,Dw)}function Ow(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function wl(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function cu(n){return wl(n)&&"method"in n}function Js(n){return wl(n)&&(an(n)||jr(n))}function an(n){return"result"in n}function jr(n){return"error"in n}class En extends Ew{constructor(e){super(e),this.events=new Qt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ys(e.method,e.params||[],e.id||_l().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(u){o(u)}this.events.on(`${e.id}`,u=>{jr(u)?o(u.error):s(u.result)});try{await this.connection.send(e,t)}catch(u){o(u)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Js(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ml=10,Iw=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Aw=()=>typeof window<"u",Pw=Iw();class Cw{constructor(e){if(this.url=e,this.events=new Qt.exports.EventEmitter,this.registering=!1,!bl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Zi(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!bl(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=hl.isReactNative()?void 0:{rejectUnauthorized:!Ow(e)},u=new Pw(e,[],o);Aw()?u.onerror=h=>{const l=h;s(this.emitError(l.error))}:u.on("error",h=>{s(this.emitError(h))}),u.onopen=()=>{this.onOpen(u),t(u)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Pa(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),u=ks(e,o);this.events.emit("payload",u)}parseError(e,t=this.url){return fl(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ml&&this.events.setMaxListeners(ml)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}var fu={exports:{}};(function(n,e){var t=200,s="__lodash_hash_undefined__",o=1,u=2,h=9007199254740991,l="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",E="[object Boolean]",C="[object Date]",D="[object Error]",T="[object Function]",R="[object GeneratorFunction]",q="[object Map]",K="[object Number]",se="[object Null]",L="[object Object]",M="[object Promise]",x="[object Proxy]",P="[object RegExp]",m="[object Set]",c="[object String]",b="[object Symbol]",V="[object Undefined]",k="[object WeakMap]",ie="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",w="[object Float64Array]",I="[object Int8Array]",ee="[object Int16Array]",X="[object Int32Array]",G="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",we=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,me=/^(?:0|[1-9]\d*)$/,he={};he[de]=he[w]=he[I]=he[ee]=he[X]=he[G]=he[W]=he[J]=he[re]=!0,he[l]=he[_]=he[ie]=he[E]=he[ue]=he[C]=he[D]=he[T]=he[q]=he[K]=he[L]=he[P]=he[m]=he[c]=he[k]=!1;var ve=typeof wt=="object"&&wt&&wt.Object===Object&&wt,j=typeof self=="object"&&self&&self.Object===Object&&self,H=ve||j||Function("return this")(),F=e&&!e.nodeType&&e,d=F&&!0&&n&&!n.nodeType&&n,A=d&&d.exports===F,ae=A&&ve.process,le=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),xe=le&&le.isTypedArray;function qe(S,$){for(var te=-1,pe=S==null?0:S.length,ut=0,Te=[];++te<pe;){var dt=S[te];$(dt,te,S)&&(Te[ut++]=dt)}return Te}function Ge(S,$){for(var te=-1,pe=$.length,ut=S.length;++te<pe;)S[ut+te]=$[te];return S}function $e(S,$){for(var te=-1,pe=S==null?0:S.length;++te<pe;)if($(S[te],te,S))return!0;return!1}function gt(S,$){for(var te=-1,pe=Array(S);++te<S;)pe[te]=$(te);return pe}function _t(S){return function($){return S($)}}function Be(S,$){return S.has($)}function Oe(S,$){return S?.[$]}function Le(S){var $=-1,te=Array(S.size);return S.forEach(function(pe,ut){te[++$]=[ut,pe]}),te}function Fe(S,$){return function(te){return S($(te))}}function He(S){var $=-1,te=Array(S.size);return S.forEach(function(pe){te[++$]=pe}),te}var Ae=Array.prototype,Ue=Function.prototype,De=Object.prototype,Pe=H["__core-js_shared__"],ze=Ue.toString,Ie=De.hasOwnProperty,We=function(){var S=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),Ye=De.toString,et=RegExp("^"+ze.call(Ie).replace(we,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=A?H.Buffer:void 0,Xe=H.Symbol,ur=H.Uint8Array,_r=De.propertyIsEnumerable,Zr=Ae.splice,cr=Xe?Xe.toStringTag:void 0,un=Object.getOwnPropertySymbols,xn=tt?tt.isBuffer:void 0,kn=Fe(Object.keys,Object),St=Sr(H,"DataView"),yt=Sr(H,"Map"),Dt=Sr(H,"Promise"),xt=Sr(H,"Set"),mt=Sr(H,"WeakMap"),vt=Sr(Object,"create"),Mt=fn(St),Bt=fn(yt),Ot=fn(Dt),Ht=fn(xt),It=fn(mt),Tt=Xe?Xe.prototype:void 0,At=Tt?Tt.valueOf:void 0;function lt(S){var $=-1,te=S==null?0:S.length;for(this.clear();++$<te;){var pe=S[$];this.set(pe[0],pe[1])}}function jt(){this.__data__=vt?vt(null):{},this.size=0}function qt(S){var $=this.has(S)&&delete this.__data__[S];return this.size-=$?1:0,$}function Au(S){var $=this.__data__;if(vt){var te=$[S];return te===s?void 0:te}return Ie.call($,S)?$[S]:void 0}function Pu(S){var $=this.__data__;return vt?$[S]!==void 0:Ie.call($,S)}function Cu(S,$){var te=this.__data__;return this.size+=this.has(S)?0:1,te[S]=vt&&$===void 0?s:$,this}lt.prototype.clear=jt,lt.prototype.delete=qt,lt.prototype.get=Au,lt.prototype.has=Pu,lt.prototype.set=Cu;function Rr(S){var $=-1,te=S==null?0:S.length;for(this.clear();++$<te;){var pe=S[$];this.set(pe[0],pe[1])}}function Tu(){this.__data__=[],this.size=0}function Ru(S){var $=this.__data__,te=Jn($,S);if(te<0)return!1;var pe=$.length-1;return te==pe?$.pop():Zr.call($,te,1),--this.size,!0}function Nu(S){var $=this.__data__,te=Jn($,S);return te<0?void 0:$[te][1]}function Lu(S){return Jn(this.__data__,S)>-1}function Fu(S,$){var te=this.__data__,pe=Jn(te,S);return pe<0?(++this.size,te.push([S,$])):te[pe][1]=$,this}Rr.prototype.clear=Tu,Rr.prototype.delete=Ru,Rr.prototype.get=Nu,Rr.prototype.has=Lu,Rr.prototype.set=Fu;function cn(S){var $=-1,te=S==null?0:S.length;for(this.clear();++$<te;){var pe=S[$];this.set(pe[0],pe[1])}}function bi(){this.size=0,this.__data__={hash:new lt,map:new(yt||Rr),string:new lt}}function Uu(S){var $=On(this,S).delete(S);return this.size-=$?1:0,$}function wi(S){return On(this,S).get(S)}function $u(S){return On(this,S).has(S)}function Mu(S,$){var te=On(this,S),pe=te.size;return te.set(S,$),this.size+=te.size==pe?0:1,this}cn.prototype.clear=bi,cn.prototype.delete=Uu,cn.prototype.get=wi,cn.prototype.has=$u,cn.prototype.set=Mu;function mi(S){var $=-1,te=S==null?0:S.length;for(this.__data__=new cn;++$<te;)this.add(S[$])}function no(S){return this.__data__.set(S,s),this}function io(S){return this.__data__.has(S)}mi.prototype.add=mi.prototype.push=no,mi.prototype.has=io;function qr(S){var $=this.__data__=new Rr(S);this.size=$.size}function Bu(){this.__data__=new Rr,this.size=0}function Hu(S){var $=this.__data__,te=$.delete(S);return this.size=$.size,te}function ju(S){return this.__data__.get(S)}function qu(S){return this.__data__.has(S)}function so(S,$){var te=this.__data__;if(te instanceof Rr){var pe=te.__data__;if(!yt||pe.length<t-1)return pe.push([S,$]),this.size=++te.size,this;te=this.__data__=new cn(pe)}return te.set(S,$),this.size=te.size,this}qr.prototype.clear=Bu,qr.prototype.delete=Hu,qr.prototype.get=ju,qr.prototype.has=qu,qr.prototype.set=so;function oo(S,$){var te=Di(S),pe=!te&&bo(S),ut=!te&&!pe&&ls(S),Te=!te&&!pe&&!ut&&Eo(S),dt=te||pe||ut||Te,zt=dt?gt(S.length,String):[],Ze=zt.length;for(var ct in S)($||Ie.call(S,ct))&&!(dt&&(ct=="length"||ut&&(ct=="offset"||ct=="parent")||Te&&(ct=="buffer"||ct=="byteLength"||ct=="byteOffset")||po(ct,Ze)))&&zt.push(ct);return zt}function Jn(S,$){for(var te=S.length;te--;)if(vo(S[te][0],$))return te;return-1}function fs(S,$,te){var pe=$(S);return Di(S)?pe:Ge(pe,te(S))}function Xn(S){return S==null?S===void 0?V:se:cr&&cr in Object(S)?ho(S):Gu(S)}function hs(S){return Qn(S)&&Xn(S)==l}function Zn(S,$,te,pe,ut){return S===$?!0:S==null||$==null||!Qn(S)&&!Qn($)?S!==S&&$!==$:ao(S,$,te,pe,Zn,ut)}function ao(S,$,te,pe,ut,Te){var dt=Di(S),zt=Di($),Ze=dt?_:Qr(S),ct=zt?_:Qr($);Ze=Ze==l?L:Ze,ct=ct==l?L:ct;var Rt=Ze==L,yr=ct==L,Kt=Ze==ct;if(Kt&&ls(S)){if(!ls($))return!1;dt=!0,Rt=!1}if(Kt&&!Rt)return Te||(Te=new qr),dt||Eo(S)?Ei(S,$,te,pe,ut,Te):Ku(S,$,Ze,te,pe,ut,Te);if(!(te&o)){var pt=Rt&&Ie.call(S,"__wrapped__"),fr=yr&&Ie.call($,"__wrapped__");if(pt||fr){var zr=pt?S.value():S,Nr=fr?$.value():$;return Te||(Te=new qr),ut(zr,Nr,te,pe,Te)}}return Kt?(Te||(Te=new qr),fo(S,$,te,pe,ut,Te)):!1}function zu(S){if(!mo(S)||_o(S))return!1;var $=xi(S)?et:oe;return $.test(fn(S))}function uo(S){return Qn(S)&&wo(S.length)&&!!he[Xn(S)]}function co(S){if(!yo(S))return kn(S);var $=[];for(var te in Object(S))Ie.call(S,te)&&te!="constructor"&&$.push(te);return $}function Ei(S,$,te,pe,ut,Te){var dt=te&o,zt=S.length,Ze=$.length;if(zt!=Ze&&!(dt&&Ze>zt))return!1;var ct=Te.get(S);if(ct&&Te.get($))return ct==$;var Rt=-1,yr=!0,Kt=te&u?new mi:void 0;for(Te.set(S,$),Te.set($,S);++Rt<zt;){var pt=S[Rt],fr=$[Rt];if(pe)var zr=dt?pe(fr,pt,Rt,$,S,Te):pe(pt,fr,Rt,S,$,Te);if(zr!==void 0){if(zr)continue;yr=!1;break}if(Kt){if(!$e($,function(Nr,en){if(!Be(Kt,en)&&(pt===Nr||ut(pt,Nr,te,pe,Te)))return Kt.push(en)})){yr=!1;break}}else if(!(pt===fr||ut(pt,fr,te,pe,Te))){yr=!1;break}}return Te.delete(S),Te.delete($),yr}function Ku(S,$,te,pe,ut,Te,dt){switch(te){case ue:if(S.byteLength!=$.byteLength||S.byteOffset!=$.byteOffset)return!1;S=S.buffer,$=$.buffer;case ie:return!(S.byteLength!=$.byteLength||!Te(new ur(S),new ur($)));case E:case C:case K:return vo(+S,+$);case D:return S.name==$.name&&S.message==$.message;case P:case c:return S==$+"";case q:var zt=Le;case m:var Ze=pe&o;if(zt||(zt=He),S.size!=$.size&&!Ze)return!1;var ct=dt.get(S);if(ct)return ct==$;pe|=u,dt.set(S,$);var Rt=Ei(zt(S),zt($),pe,ut,Te,dt);return dt.delete(S),Rt;case b:if(At)return At.call(S)==At.call($)}return!1}function fo(S,$,te,pe,ut,Te){var dt=te&o,zt=Si(S),Ze=zt.length,ct=Si($),Rt=ct.length;if(Ze!=Rt&&!dt)return!1;for(var yr=Ze;yr--;){var Kt=zt[yr];if(!(dt?Kt in $:Ie.call($,Kt)))return!1}var pt=Te.get(S);if(pt&&Te.get($))return pt==$;var fr=!0;Te.set(S,$),Te.set($,S);for(var zr=dt;++yr<Ze;){Kt=zt[yr];var Nr=S[Kt],en=$[Kt];if(pe)var ds=dt?pe(en,Nr,Kt,$,S,Te):pe(Nr,en,Kt,S,$,Te);if(!(ds===void 0?Nr===en||ut(Nr,en,te,pe,Te):ds)){fr=!1;break}zr||(zr=Kt=="constructor")}if(fr&&!zr){var ei=S.constructor,Yt=$.constructor;ei!=Yt&&"constructor"in S&&"constructor"in $&&!(typeof ei=="function"&&ei instanceof ei&&typeof Yt=="function"&&Yt instanceof Yt)&&(fr=!1)}return Te.delete(S),Te.delete($),fr}function Si(S){return fs(S,Yu,lo)}function On(S,$){var te=S.__data__;return go($)?te[typeof $=="string"?"string":"hash"]:te.map}function Sr(S,$){var te=Oe(S,$);return zu(te)?te:void 0}function ho(S){var $=Ie.call(S,cr),te=S[cr];try{S[cr]=void 0;var pe=!0}catch{}var ut=Ye.call(S);return pe&&($?S[cr]=te:delete S[cr]),ut}var lo=un?function(S){return S==null?[]:(S=Object(S),qe(un(S),function($){return _r.call(S,$)}))}:at,Qr=Xn;(St&&Qr(new St(new ArrayBuffer(1)))!=ue||yt&&Qr(new yt)!=q||Dt&&Qr(Dt.resolve())!=M||xt&&Qr(new xt)!=m||mt&&Qr(new mt)!=k)&&(Qr=function(S){var $=Xn(S),te=$==L?S.constructor:void 0,pe=te?fn(te):"";if(pe)switch(pe){case Mt:return ue;case Bt:return q;case Ot:return M;case Ht:return m;case It:return k}return $});function po(S,$){return $=$??h,!!$&&(typeof S=="number"||me.test(S))&&S>-1&&S%1==0&&S<$}function go(S){var $=typeof S;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?S!=="__proto__":S===null}function _o(S){return!!We&&We in S}function yo(S){var $=S&&S.constructor,te=typeof $=="function"&&$.prototype||De;return S===te}function Gu(S){return Ye.call(S)}function fn(S){if(S!=null){try{return ze.call(S)}catch{}try{return S+""}catch{}}return""}function vo(S,$){return S===$||S!==S&&$!==$}var bo=hs(function(){return arguments}())?hs:function(S){return Qn(S)&&Ie.call(S,"callee")&&!_r.call(S,"callee")},Di=Array.isArray;function Wu(S){return S!=null&&wo(S.length)&&!xi(S)}var ls=xn||ot;function Vu(S,$){return Zn(S,$)}function xi(S){if(!mo(S))return!1;var $=Xn(S);return $==T||$==R||$==p||$==x}function wo(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=h}function mo(S){var $=typeof S;return S!=null&&($=="object"||$=="function")}function Qn(S){return S!=null&&typeof S=="object"}var Eo=xe?_t(xe):uo;function Yu(S){return Wu(S)?oo(S):co(S)}function at(){return[]}function ot(){return!1}n.exports=Vu})(fu,fu.exports);var Tw=fu.exports,Rw=Object.defineProperty,El=Object.getOwnPropertySymbols,Nw=Object.prototype.hasOwnProperty,Lw=Object.prototype.propertyIsEnumerable,Sl=(n,e,t)=>e in n?Rw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ar=(n,e)=>{for(var t in e||(e={}))Nw.call(e,t)&&Sl(n,t,e[t]);if(El)for(var t of El(e))Lw.call(e,t)&&Sl(n,t,e[t]);return n};function Fw(n,e){if(n.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<n.length;o++){var u=n.charAt(o),h=u.charCodeAt(0);if(t[h]!==255)throw new TypeError(u+" is ambiguous");t[h]=o}var l=n.length,_=n.charAt(0),p=Math.log(l)/Math.log(256),E=Math.log(256)/Math.log(l);function C(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var q=0,K=0,se=0,L=R.length;se!==L&&R[se]===0;)se++,q++;for(var M=(L-se)*E+1>>>0,x=new Uint8Array(M);se!==L;){for(var P=R[se],m=0,c=M-1;(P!==0||m<K)&&c!==-1;c--,m++)P+=256*x[c]>>>0,x[c]=P%l>>>0,P=P/l>>>0;if(P!==0)throw new Error("Non-zero carry");K=m,se++}for(var b=M-K;b!==M&&x[b]===0;)b++;for(var V=_.repeat(q);b<M;++b)V+=n.charAt(x[b]);return V}function D(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var q=0;if(R[q]!==" "){for(var K=0,se=0;R[q]===_;)K++,q++;for(var L=(R.length-q)*p+1>>>0,M=new Uint8Array(L);R[q];){var x=t[R.charCodeAt(q)];if(x===255)return;for(var P=0,m=L-1;(x!==0||P<se)&&m!==-1;m--,P++)x+=l*M[m]>>>0,M[m]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");se=P,q++}if(R[q]!==" "){for(var c=L-se;c!==L&&M[c]===0;)c++;for(var b=new Uint8Array(K+(L-c)),V=K;c!==L;)b[V++]=M[c++];return b}}}function T(R){var q=D(R);if(q)return q;throw new Error(`Non-${e} character`)}return{encode:C,decodeUnsafe:D,decode:T}}var Uw=Fw,$w=Uw;const Dl=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},Mw=n=>new TextEncoder().encode(n),Bw=n=>new TextDecoder().decode(n);class Hw{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class jw{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return xl(this,e)}}class qw{constructor(e){this.decoders=e}or(e){return xl(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xl=(n,e)=>new qw(ar(ar({},n.decoders||{[n.prefix]:n}),e.decoders||{[e.prefix]:e}));class zw{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new Hw(e,t,s),this.decoder=new jw(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xs=({name:n,prefix:e,encode:t,decode:s})=>new zw(n,e,t,s),ss=({prefix:n,name:e,alphabet:t})=>{const{encode:s,decode:o}=$w(t,e);return Xs({prefix:n,name:e,encode:s,decode:u=>Dl(o(u))})},Kw=(n,e,t,s)=>{const o={};for(let E=0;E<e.length;++E)o[e[E]]=E;let u=n.length;for(;n[u-1]==="=";)--u;const h=new Uint8Array(u*t/8|0);let l=0,_=0,p=0;for(let E=0;E<u;++E){const C=o[n[E]];if(C===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<t|C,l+=t,l>=8&&(l-=8,h[p++]=255&_>>l)}if(l>=t||255&_<<8-l)throw new SyntaxError("Unexpected end of data");return h},Gw=(n,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let u="",h=0,l=0;for(let _=0;_<n.length;++_)for(l=l<<8|n[_],h+=8;h>t;)h-=t,u+=e[o&l>>h];if(h&&(u+=e[o&l<<t-h]),s)for(;u.length*t&7;)u+="=";return u},Xt=({name:n,prefix:e,bitsPerChar:t,alphabet:s})=>Xs({prefix:e,name:n,encode(o){return Gw(o,s,t)},decode(o){return Kw(o,s,t,n)}}),Ww=Xs({prefix:"\0",name:"identity",encode:n=>Bw(n),decode:n=>Mw(n)});var Vw=Object.freeze({__proto__:null,identity:Ww});const Yw=Xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var kw=Object.freeze({__proto__:null,base2:Yw});const Jw=Xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Xw=Object.freeze({__proto__:null,base8:Jw});const Zw=ss({prefix:"9",name:"base10",alphabet:"0123456789"});var Qw=Object.freeze({__proto__:null,base10:Zw});const em=Xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tm=Xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var rm=Object.freeze({__proto__:null,base16:em,base16upper:tm});const nm=Xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),im=Xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sm=Xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),om=Xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),am=Xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),um=Xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cm=Xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fm=Xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hm=Xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lm=Object.freeze({__proto__:null,base32:nm,base32upper:im,base32pad:sm,base32padupper:om,base32hex:am,base32hexupper:um,base32hexpad:cm,base32hexpadupper:fm,base32z:hm});const dm=ss({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pm=ss({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var gm=Object.freeze({__proto__:null,base36:dm,base36upper:pm});const _m=ss({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ym=ss({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vm=Object.freeze({__proto__:null,base58btc:_m,base58flickr:ym});const bm=Xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wm=Xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mm=Xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Em=Xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Sm=Object.freeze({__proto__:null,base64:bm,base64pad:wm,base64url:mm,base64urlpad:Em});const Ol=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Dm=Ol.reduce((n,e,t)=>(n[t]=e,n),[]),xm=Ol.reduce((n,e,t)=>(n[e.codePointAt(0)]=t,n),[]);function Om(n){return n.reduce((e,t)=>(e+=Dm[t],e),"")}function Im(n){const e=[];for(const t of n){const s=xm[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const Am=Xs({prefix:"\u{1F680}",name:"base256emoji",encode:Om,decode:Im});var Pm=Object.freeze({__proto__:null,base256emoji:Am}),Cm=Al,Il=128,Tm=127,Rm=~Tm,Nm=Math.pow(2,31);function Al(n,e,t){e=e||[],t=t||0;for(var s=t;n>=Nm;)e[t++]=n&255|Il,n/=128;for(;n&Rm;)e[t++]=n&255|Il,n>>>=7;return e[t]=n|0,Al.bytes=t-s+1,e}var Lm=hu,Fm=128,Pl=127;function hu(n,s){var t=0,s=s||0,o=0,u=s,h,l=n.length;do{if(u>=l)throw hu.bytes=0,new RangeError("Could not decode varint");h=n[u++],t+=o<28?(h&Pl)<<o:(h&Pl)*Math.pow(2,o),o+=7}while(h>=Fm);return hu.bytes=u-s,t}var Um=Math.pow(2,7),$m=Math.pow(2,14),Mm=Math.pow(2,21),Bm=Math.pow(2,28),Hm=Math.pow(2,35),jm=Math.pow(2,42),qm=Math.pow(2,49),zm=Math.pow(2,56),Km=Math.pow(2,63),Gm=function(n){return n<Um?1:n<$m?2:n<Mm?3:n<Bm?4:n<Hm?5:n<jm?6:n<qm?7:n<zm?8:n<Km?9:10},Wm={encode:Cm,decode:Lm,encodingLength:Gm},Cl=Wm;const Tl=(n,e,t=0)=>(Cl.encode(n,e,t),e),Rl=n=>Cl.encodingLength(n),lu=(n,e)=>{const t=e.byteLength,s=Rl(n),o=s+Rl(t),u=new Uint8Array(o+t);return Tl(n,u,0),Tl(t,u,s),u.set(e,o),new Vm(n,t,e,u)};class Vm{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Nl=({name:n,code:e,encode:t})=>new Ym(n,e,t);class Ym{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?lu(this.code,t):t.then(s=>lu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Ll=n=>async e=>new Uint8Array(await crypto.subtle.digest(n,e)),km=Nl({name:"sha2-256",code:18,encode:Ll("SHA-256")}),Jm=Nl({name:"sha2-512",code:19,encode:Ll("SHA-512")});var Xm=Object.freeze({__proto__:null,sha256:km,sha512:Jm});const Fl=0,Zm="identity",Ul=Dl;var Qm=Object.freeze({__proto__:null,identity:{code:Fl,name:Zm,encode:Ul,digest:n=>lu(Fl,Ul(n))}});new TextEncoder,new TextDecoder;const $l=ar(ar(ar(ar(ar(ar(ar(ar(ar(ar({},Vw),kw),Xw),Qw),rm),lm),gm),vm),Sm),Pm);ar(ar({},Xm),Qm);function Ml(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function eE(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ml(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Bl(n,e,t,s){return{name:n,prefix:e,encoder:{name:n,prefix:e,encode:t},decoder:{decode:s}}}const Hl=Bl("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),du=Bl("ascii","a",n=>{let e="a";for(let t=0;t<n.length;t++)e+=String.fromCharCode(n[t]);return e},n=>{n=n.substring(1);const e=eE(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}),tE=ar({utf8:Hl,"utf-8":Hl,hex:$l.base16,latin1:du,ascii:du,binary:du},$l);function rE(n,e="utf8"){const t=tE[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ml(globalThis.Buffer.from(n,"utf-8")):t.decoder.decode(`${t.prefix}${n}`)}const jl="wc",nE=2,pu="core",Sn=`${jl}@${2}:${pu}:`,iE={name:pu,logger:"error"},sE={database:":memory:"},oE="crypto",ql="client_ed25519_seed",aE=ye.ONE_DAY,uE="keychain",cE="0.3",fE="messages",hE="0.3",lE=ye.SIX_HOURS,dE="publisher",zl="irn",pE="error",Kl="wss://relay.walletconnect.com",gE="relayer",$t={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},_E="_subscription",os={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},yE=ye.ONE_SECOND/2,vE="y",bE=1e4,wE="0.3",Jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},mE="subscription",EE="0.3",SE=ye.FIVE_SECONDS*1e3,DE="pairing",xE="0.3",as={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},Xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},OE="history",IE="0.3",AE="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},PE="0.3",gu="verify-api",Gl="https://verify.walletconnect.com";class CE{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=uE,this.version=cE,this.initialized=!1,this.storagePrefix=Sn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:u}=fe("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Yh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?kh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class TE{constructor(e,t,s){this.core=e,this.logger=t,this.name=oE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),u=vh(o);return yh(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=$v();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const u=await this.getClientSeed(),h=vh(u),l=Xa();return await G1(l,o,aE,h)},this.generateSharedKey=(o,u,h)=>{this.isInitialized();const l=this.getPrivateKey(o),_=Mv(l,u);return this.setSymKey(_,h)},this.setSymKey=async(o,u)=>{this.isInitialized();const h=u||Bv(o);return await this.keychain.set(h,o),h},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,u,h)=>{this.isInitialized();const l=jh(h),_=Zi(u);if(qh(l)){const D=l.senderPublicKey,T=l.receiverPublicKey;o=await this.generateSharedKey(D,T)}const p=this.getSymKey(o),{type:E,senderPublicKey:C}=l;return jv({type:E,symKey:p,message:_,senderPublicKey:C})},this.decode=async(o,u,h)=>{this.isInitialized();const l=Kv(u,h);if(qh(l)){const E=l.receiverPublicKey,C=l.senderPublicKey;o=await this.generateSharedKey(E,C)}const _=this.getSymKey(o),p=qv({symKey:_,encoded:u});return Pa(p)},this.getPayloadType=o=>{const u=zs(o);return rs(u.type)},this.getPayloadSenderPublicKey=o=>{const u=zs(o);return u.senderPublicKey?ir(u.senderPublicKey,sr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new CE(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ql)}catch{e=Xa(),await this.keychain.set(ql,e)}return rE(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class RE extends x_{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=fE,this.version=hE,this.initialized=!1,this.storagePrefix=Sn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const u=pi(o);let h=this.messages.get(s);return typeof h>"u"&&(h={}),typeof h[u]<"u"||(h[u]=o,this.messages.set(s,h),await this.persist()),u},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const u=this.get(s),h=pi(o);return typeof u[h]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Yh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?kh(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class NE extends O_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Qt.exports.EventEmitter,this.name=dE,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(s,o,u)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}});try{const h=u?.ttl||lE,l=tu(u),_=u?.prompt||!1,p=u?.tag||0,E=u?.id||_l().toString(),C={topic:s,message:o,opts:{ttl:h,relay:l,prompt:_,tag:p,id:E}};this.queue.set(E,C);try{await await Ks(this.rpcPublish(s,o,h,l,_,p,E),this.publishTimeout),this.relayer.events.emit($t.publish,C)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit($t.connection_stalled);return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:u}})}catch(h){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(h),h}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,u,h,l){var _,p,E,C;const D={method:Gs(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:u,tag:h},id:l};return or((_=D.params)==null?void 0:_.prompt)&&((p=D.params)==null||delete p.prompt),or((E=D.params)==null?void 0:E.tag)&&((C=D.params)==null||delete C.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ki.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()}),this.relayer.on($t.message_ack,e=>{this.onPublish(e.id.toString())})}}class LE{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(u=>u!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var FE=Object.defineProperty,UE=Object.defineProperties,$E=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,BE=Object.prototype.propertyIsEnumerable,Vl=(n,e,t)=>e in n?FE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,us=(n,e)=>{for(var t in e||(e={}))ME.call(e,t)&&Vl(n,t,e[t]);if(Wl)for(var t of Wl(e))BE.call(e,t)&&Vl(n,t,e[t]);return n},_u=(n,e)=>UE(n,$E(e));class HE extends P_{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new LE,this.events=new Qt.exports.EventEmitter,this.name=mE,this.version=EE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Sn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const u=tu(o),h={topic:s,relay:u};this.pending.set(s,h);const l=await this.rpcSubscribe(s,u);return this.onSubscribe(l,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),l}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,u)=>{const h=new ye.Watch;h.start(this.pendingSubscriptionWatchLabel);const l=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(l),h.stop(this.pendingSubscriptionWatchLabel),o(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=SE&&(clearInterval(l),h.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=tu(s);await this.rpcUnsubscribe(e,t,o);const u=Ut("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Gs(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ks(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit($t.connection_stalled)}return pi(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Gs(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ks(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit($t.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Gs(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,_u(us({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,us({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,us({},t)),this.topicMap.set(t.topic,e),this.events.emit(Jr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Jr.deleted,_u(us({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Jr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Jr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);yi(t)&&this.onBatchSubscribe(t.map((s,o)=>_u(us({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Ki.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on($t.connect,async()=>{await this.onConnect()}),this.relayer.on($t.disconnect,()=>{this.onDisconnect()}),this.events.on(Jr.created,async e=>{const t=Jr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Jr.deleted,async e=>{const t=Jr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var jE=Object.defineProperty,Yl=Object.getOwnPropertySymbols,qE=Object.prototype.hasOwnProperty,zE=Object.prototype.propertyIsEnumerable,kl=(n,e,t)=>e in n?jE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,KE=(n,e)=>{for(var t in e||(e={}))qE.call(e,t)&&kl(n,t,e[t]);if(Yl)for(var t of Yl(e))zE.call(e,t)&&kl(n,t,e[t]);return n};class GE extends I_{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Qt.exports.EventEmitter,this.name=gE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||pE})),this.messages=new RE(this.logger,e.core),this.subscriber=new HE(this,this.logger),this.publisher=new NE(this,this.logger),this.relayUrl=e?.relayUrl||Kl,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},bE)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){this.isInitialized();let s="";return await Promise.all([new Promise(o=>{this.subscriber.once(Jr.created,u=>{u.topic===e&&o()})}),new Promise(async o=>{s=await this.subscriber.subscribe(e,t),o()})]),s}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit($t.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(Jr.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,s)=>{await Ks(this.provider.connect(),5e3,"socket stalled").catch(o=>s(o)).then(()=>t()).finally(()=>this.removeListener($t.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once($t.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.events.emit($t.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(t=>{this.provider.once(os.disconnect,()=>{t()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new En(new Cw(tb({sdkVersion:vE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,s):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),cu(e)){if(!e.method.endsWith(_E))return;const t=e.params,{topic:s,message:o,publishedAt:u}=t.data,h={topic:s,message:o,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(KE({type:"event",event:t.id},h)),this.events.emit(t.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}else Js(e)&&this.events.emit($t.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit($t.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=uu(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(os.payload,e=>this.onProviderPayload(e)),this.provider.on(os.connect,()=>{this.events.emit($t.connect)}),this.provider.on(os.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(os.error,e=>{this.logger.error(e),this.events.emit($t.error,e)})}registerEventListeners(){this.events.on($t.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit($t.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ye.toMiliseconds(yE))}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var WE=Object.defineProperty,Jl=Object.getOwnPropertySymbols,VE=Object.prototype.hasOwnProperty,YE=Object.prototype.propertyIsEnumerable,Xl=(n,e,t)=>e in n?WE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Zl=(n,e)=>{for(var t in e||(e={}))VE.call(e,t)&&Xl(n,t,e[t]);if(Jl)for(var t of Jl(e))YE.call(e,t)&&Xl(n,t,e[t]);return n};class Zs extends A_{constructor(e,t,s,o=Sn,u=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=wE,this.cached=[],this.initialized=!1,this.storagePrefix=Sn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!or(h)?this.map.set(this.getKey(h),h):Sb(h)?this.map.set(h.id,h):Db(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,l)=>{this.isInitialized(),this.map.has(h)?await this.update(h,l):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:l}),this.map.set(h,l),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(l=>Object.keys(h).every(_=>Tw(l[_],h[_]))):this.values),this.update=async(h,l)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:l});const _=Zl(Zl({},this.getData(h)),l);this.map.set(h,_),await this.persist()},this.delete=async(h,l)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:l}),this.map.delete(h),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=u}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class kE{constructor(e,t){this.core=e,this.logger=t,this.name=DE,this.version=xE,this.events=new Qt.exports,this.initialized=!1,this.storagePrefix=Sn,this.ignoredPayloadTypes=[Kn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Xa(),o=await this.core.crypto.setSymKey(s),u=kr(ye.FIVE_MINUTES),h={protocol:zl},l={topic:o,expiry:u,relay:h,active:!1},_=db({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:h});return await this.pairings.set(o,l),await this.core.relayer.subscribe(o),this.core.expirer.set(o,u),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:u,relay:h}=fb(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const l=kr(ye.FIVE_MINUTES),_={topic:o,relay:h,expiry:l,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(u,o),await this.core.relayer.subscribe(o,{relay:h}),this.core.expirer.set(o,l),s.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:s})=>{this.isInitialized();const o=kr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const u=await this.sendRequest(o,"wc_pairingPing",{}),{done:h,resolve:l,reject:_}=gi();this.events.once(Ft("pairing_ping",u),({error:p})=>{p?_(p):l()}),await h()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Ut("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,u)=>{const h=Ys(o,u),l=await this.core.crypto.encode(s,h),_=as[o].req;return this.core.history.set(s,h),this.core.relayer.publish(s,l,_),h.id},this.sendResult=async(s,o,u)=>{const h=uu(s,u),l=await this.core.crypto.encode(o,h),_=await this.core.history.get(o,s),p=as[_.request.method].res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(h)},this.sendError=async(s,o,u)=>{const h=ks(s,u),l=await this.core.crypto.encode(o,h),_=await this.core.history.get(o,s),p=as[_.request.method]?as[_.request.method].res:as.unregistered_method.res;await this.core.relayer.publish(o,l,p),await this.core.history.resolve(h)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Ut("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>mn(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:u}=s,h=u.method;if(this.pairings.keys.includes(o))switch(h){case"wc_pairingPing":return this.onPairingPingRequest(o,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,u);default:return this.onUnknownRpcMethodRequest(o,u)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:u}=s,h=(await this.core.history.get(o,u.id)).request.method;if(this.pairings.keys.includes(o))switch(h){case"wc_pairingPing":return this.onPairingPingResponse(o,u);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(s,o)=>{const{id:u}=o;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit("pairing_ping",{id:u,topic:s})}catch(h){await this.sendError(u,s,h),this.logger.error(h)}},this.onPairingPingResponse=(s,o)=>{const{id:u}=o;setTimeout(()=>{an(o)?this.events.emit(Ft("pairing_ping",u),{}):jr(o)&&this.events.emit(Ft("pairing_ping",u),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:u}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:u,topic:s})}catch(h){await this.sendError(u,s,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:u,method:h}=o;try{if(this.registeredMethods.includes(h))return;const l=Ut("WC_METHOD_UNSUPPORTED",h);await this.sendError(u,s,l),this.logger.error(l)}catch(l){await this.sendError(u,s,l),this.logger.error(l)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Ut("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!gr(s)){const{message:o}=fe("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!Eb(s.uri)){const{message:o}=fe("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!gr(s)){const{message:u}=fe("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:u}=fe("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=fe("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=fe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(mn(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=fe("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new Zs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on($t.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);cu(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Js(o)&&(await this.core.history.resolve(o),this.onRelayEventResponse({topic:t,payload:o}))})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async e=>{const{topic:t}=Xh(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class JE extends D_{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Qt.exports.EventEmitter,this.name=OE,this.version=IE,this.cached=[],this.initialized=!1,this.storagePrefix=Sn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:u}),this.records.has(o.id))return;const h={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:u};this.records.set(h.id,h),this.events.emit(Xr.created,h)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=jr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Xr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(u=>{if(u.topic===s){if(typeof o<"u"&&u.id!==o)return;this.records.delete(u.id),this.events.emit(Xr.deleted,u)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Ys(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Xr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Xr.created,e=>{const t=Xr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Xr.updated,e=>{const t=Xr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(Xr.deleted,e=>{const t=Xr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class XE extends C_{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Qt.exports.EventEmitter,this.name=AE,this.version=PE,this.cached=[],this.initialized=!1,this.storagePrefix=Sn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const u=this.formatTarget(s),h={target:u,expiry:o};this.expirations.set(u,h),this.checkExpiry(u,h),this.events.emit(Pr.created,{target:u,expiration:h})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),u=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Pr.deleted,{target:o,expiration:u})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return rb(e);if(typeof e=="number")return nb(e);const{message:t}=fe("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=fe("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=fe("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Pr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Ki.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,e=>{const t=Pr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Pr.expired,e=>{const t=Pr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Pr.deleted,e=>{const t=Pr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ZE extends T_{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=gu,this.initialized=!1,this.init=async s=>{Wh()||!Qa()||(this.verifyUrl=s?.verifyUrl||Gl,await this.createIframe())},this.register=async s=>{var o;this.initialized||await this.init(),this.iframe&&((o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`))},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const u=this.startAbortTimer(ye.FIVE_SECONDS),h=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(u),h.status===200?(o=await h.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(gu))return s();const u=document.createElement("iframe");u.setAttribute("id",gu),u.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),u.style.display="none",u.addEventListener("load",()=>{this.initialized=!0,s()}),u.addEventListener("error",h=>{o(h)}),document.body.append(u),this.iframe=u}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),ye.toMiliseconds(ye.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=Gl,this.abortController=new AbortController,this.isDevEnv=Za()&&process.env.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var QE=Object.defineProperty,Ql=Object.getOwnPropertySymbols,e3=Object.prototype.hasOwnProperty,t3=Object.prototype.propertyIsEnumerable,ed=(n,e,t)=>e in n?QE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,td=(n,e)=>{for(var t in e||(e={}))e3.call(e,t)&&ed(n,t,e[t]);if(Ql)for(var t of Ql(e))t3.call(e,t)&&ed(n,t,e[t]);return n};class yu extends S_{constructor(e){super(e),this.protocol=jl,this.version=nE,this.name=pu,this.events=new Qt.exports.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Kl;const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||iE.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new Ki.HeartBeat,this.crypto=new TE(this,this.logger,e?.keychain),this.history=new JE(this,this.logger),this.expirer=new XE(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Qg(td(td({},sE),e?.storageOptions)),this.relayer=new GE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new kE(this,this.logger),this.verify=new ZE(this.projectId||"",this.logger)}static async init(e){const t=new yu(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const r3=yu,rd="wc",nd=2,id="client",vu=`${rd}@${nd}:${id}:`,bu={name:id,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},n3="proposal",sd="Proposal expired",i3="session",Qs=ye.SEVEN_DAYS,s3="engine",cs={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},wu={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},o3="request",a3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var u3=Object.defineProperty,c3=Object.defineProperties,f3=Object.getOwnPropertyDescriptors,od=Object.getOwnPropertySymbols,h3=Object.prototype.hasOwnProperty,l3=Object.prototype.propertyIsEnumerable,ad=(n,e,t)=>e in n?u3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cr=(n,e)=>{for(var t in e||(e={}))h3.call(e,t)&&ad(n,t,e[t]);if(od)for(var t of od(e))l3.call(e,t)&&ad(n,t,e[t]);return n},mu=(n,e)=>c3(n,f3(e));class d3 extends N_{constructor(e){super(e),this.name=s3,this.events=new Qt.exports,this.initialized=!1,this.ignoredPayloadTypes=[Kn],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(cs)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const s=mu(Cr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:u,optionalNamespaces:h,sessionProperties:l,relays:_}=s;let p=o,E,C=!1;if(p&&(C=this.client.core.pairing.pairings.get(p).active),!p||!C){const{topic:M,uri:x}=await this.client.core.pairing.create();p=M,E=x}const D=await this.client.core.crypto.generateKeyPair(),T=Cr({requiredNamespaces:u,optionalNamespaces:h,relays:_??[{protocol:zl}],proposer:{publicKey:D,metadata:this.client.metadata}},l&&{sessionProperties:l}),{reject:R,resolve:q,done:K}=gi(ye.FIVE_MINUTES,sd);if(this.events.once(Ft("session_connect"),async({error:M,session:x})=>{if(M)R(M);else if(x){x.self.publicKey=D;const P=mu(Cr({},x),{requiredNamespaces:x.requiredNamespaces,optionalNamespaces:x.optionalNamespaces});await this.client.session.set(x.topic,P),await this.setExpiry(x.topic,x.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:x.peer.metadata}),q(P)}}),!p){const{message:M}=fe("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(M)}const se=await this.sendRequest(p,"wc_sessionPropose",T),L=kr(ye.FIVE_MINUTES);return await this.setProposal(se,Cr({id:se,expiry:L},T)),{uri:E,approval:K}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:u,sessionProperties:h}=t,l=this.client.proposal.get(s);let{pairingTopic:_,proposer:p,requiredNamespaces:E,optionalNamespaces:C}=l;_=_||"",vi(E)||(E=yb(u,"approve()"));const D=await this.client.core.crypto.generateKeyPair(),T=p.publicKey,R=await this.client.core.crypto.generateSharedKey(D,T);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult(s,_,{relay:{protocol:o??"irn"},responderPublicKey:D}),await this.client.proposal.delete(s,Ut("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const q=Cr({relay:{protocol:o??"irn"},namespaces:u,requiredNamespaces:E,optionalNamespaces:C,pairingTopic:_,controller:{publicKey:D,metadata:this.client.metadata},expiry:kr(Qs)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(R),await this.sendRequest(R,"wc_sessionSettle",q);const K=mu(Cr({},q),{topic:R,pairingTopic:_,acknowledged:!1,self:q.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:D});return await this.client.session.set(R,K),await this.setExpiry(R,kr(Qs)),{topic:R,acknowledged:()=>new Promise(se=>setTimeout(()=>se(this.client.session.get(R)),500))}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,o),await this.client.proposal.delete(s,Ut("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,u=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:h,resolve:l,reject:_}=gi();return this.events.once(Ft("session_update",u),({error:p})=>{p?_(p):l()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:h}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:u,resolve:h,reject:l}=gi();return this.events.once(Ft("session_extend",o),({error:_})=>{_?l(_):h()}),await this.setExpiry(s,kr(Qs)),{acknowledged:u}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:u,expiry:h}=t,l=await this.sendRequest(u,"wc_sessionRequest",{request:o,chainId:s},h),{done:_,resolve:p,reject:E}=gi(h);return this.events.once(Ft("session_request",l),({error:C,result:D})=>{C?E(C):p(D)}),this.client.events.emit("session_request_sent",{topic:u,request:o,chainId:s,id:l}),await _()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:u}=o;an(o)?await this.sendResult(u,s,o.result):jr(o)&&await this.sendError(u,s,o.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:u,resolve:h,reject:l}=gi();this.events.once(Ft("session_ping",o),({error:_})=>{_?l(_):h()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:u}=t;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:u})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;this.client.session.keys.includes(s)?(await this.sendRequest(s,"wc_sessionDelete",Ut("USER_DISCONNECTED")),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>wb(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(u=>{var h,l;return((h=u.peerMetadata)==null?void 0:h.url)&&((l=u.peerMetadata)==null?void 0:l.url)===t.self.metadata.url&&u.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,Ut("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.deleteSymKey(t),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,Ut("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=cs.wc_sessionRequest.req.ttl,{id:o,topic:u,params:h}=t;await this.client.pendingRequest.set(o,{id:o,topic:u,params:h}),s&&this.client.core.expirer.set(o,kr(s))},this.sendRequest=async(t,s,o,u)=>{const h=Ys(s,o);if(Qa()&&a3.includes(s)){const p=pi(JSON.stringify(h));await this.client.core.verify.register({attestationId:p})}const l=await this.client.core.crypto.encode(t,h),_=cs[s].req;return u&&(_.ttl=u),this.client.core.history.set(t,h),this.client.core.relayer.publish(t,l,_),h.id},this.sendResult=async(t,s,o)=>{const u=uu(t,o),h=await this.client.core.crypto.encode(s,u),l=await this.client.core.history.get(s,t),_=cs[l.request.method].res;this.client.core.relayer.publish(s,h,_),await this.client.core.history.resolve(u)},this.sendError=async(t,s,o)=>{const u=ks(t,o),h=await this.client.core.crypto.encode(s,u),l=await this.client.core.history.get(s,t),_=cs[l.request.method].res;this.client.core.relayer.publish(s,h,_),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{mn(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{mn(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=t=>{const{topic:s,payload:o}=t,u=o.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,u=(await this.client.core.history.get(s,o.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:u}=s;try{this.isValidConnect(Cr({},s.params));const h=kr(ye.FIVE_MINUTES),l=Cr({id:u,pairingTopic:t,expiry:h},o);await this.setProposal(u,l);const _=pi(JSON.stringify(s)),p=await this.getVerifyContext(_,l.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:l,verifyContext:p})}catch(h){await this.sendError(u,t,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(an(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const h=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const l=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:l});const _=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(l,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const E=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:t})}else jr(s)&&(await this.client.proposal.delete(o,Ut("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:h,controller:l,expiry:_,namespaces:p,requiredNamespaces:E,optionalNamespaces:C,sessionProperties:D,pairingTopic:T}=s.params,R=Cr({topic:t,relay:h,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:T,requiredNamespaces:E,optionalNamespaces:C,controller:l.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:l.publicKey,metadata:l.metadata}},D&&{sessionProperties:D});await this.sendResult(s.id,t,!0),this.events.emit(Ft("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;an(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):jr(s)&&(await this.client.session.delete(t,Ut("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:u}=s;try{this.isValidUpdate(Cr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult(u,t,!0),this.client.events.emit("session_update",{id:u,topic:t,params:o})}catch(h){await this.sendError(u,t,h),this.client.logger.error(h)}},this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit(Ft("session_update",o),{}):jr(s)&&this.events.emit(Ft("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,kr(Qs)),await this.sendResult(o,t,!0),this.client.events.emit("session_extend",{id:o,topic:t})}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit(Ft("session_extend",o),{}):jr(s)&&this.events.emit(Ft("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult(o,t,!0),this.client.events.emit("session_ping",{id:o,topic:t})}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{an(s)?this.events.emit(Ft("session_ping",o),{}):jr(s)&&this.events.emit(Ft("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once($t.publish,async()=>{u(await this.deleteSession(t))})}),this.sendResult(o,t,!0)]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(u){await this.sendError(o,t,u),this.client.logger.error(u)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidRequest(Cr({topic:t},u)),await this.setPendingSessionRequest({id:o,topic:t,params:u});const h=pi(JSON.stringify(s)),l=this.client.session.get(t),_=await this.getVerifyContext(h,l.peer.metadata);this.client.events.emit("session_request",{id:o,topic:t,params:u,verifyContext:_})}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;an(s)?this.events.emit(Ft("session_request",o),{result:s.result}):jr(s)&&this.events.emit(Ft("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:u}=s;try{this.isValidEmit(Cr({topic:t},u)),this.client.events.emit("session_event",{id:o,topic:t,params:u})}catch(h){await this.sendError(o,t,h),this.client.logger.error(h)}},this.isValidConnect=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:u,sessionProperties:h,relays:l}=t;if(or(s)||await this.isValidPairingTopic(s),!Rb(l,!0)){const{message:_}=fe("MISSING_OR_INVALID",`connect() relays: ${l}`);throw new Error(_)}!or(o)&&vi(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!or(u)&&vi(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),or(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=Tb(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!gr(t))throw new Error(fe("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:u,sessionProperties:h}=t;await this.isValidProposalId(s);const l=this.client.proposal.get(s),_=Vs(o,"approve()");if(_)throw new Error(_.message);const p=sl(l.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Vt(u,!0)){const{message:E}=fe("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(E)}or(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!gr(t)){const{message:u}=fe("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(u)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!Lb(o)){const{message:u}=fe("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidSessionSettleRequest=t=>{if(!gr(t)){const{message:p}=fe("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:u,expiry:h}=t;if(!nl(s)){const{message:p}=fe("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const l=xb(o,"onSessionSettleRequest()");if(l)throw new Error(l.message);const _=Vs(u,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(mn(h)){const{message:p}=fe("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const u=this.client.session.get(s),h=Vs(o,"update()");if(h)throw new Error(h.message);const l=sl(u.requiredNamespaces,o,"update()");if(l)throw new Error(l.message)},this.isValidExtend=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!gr(t)){const{message:_}=fe("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:s,request:o,chainId:u,expiry:h}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!il(l,u)){const{message:_}=fe("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(_)}if(!Fb(o)){const{message:_}=fe("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!Mb(l,u,o.method)){const{message:_}=fe("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(h&&!qb(h,wu)){const{message:_}=fe("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${wu.min} and ${wu.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!gr(t)){const{message:u}=fe("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(u)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!Ub(o)){const{message:u}=fe("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidPing=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!gr(t)){const{message:l}=fe("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(l)}const{topic:s,event:o,chainId:u}=t;await this.isValidSessionTopic(s);const{namespaces:h}=this.client.session.get(s);if(!il(h,u)){const{message:l}=fe("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(l)}if(!$b(o)){const{message:l}=fe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}if(!Bb(h,u,o.name)){const{message:l}=fe("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidDisconnect=async t=>{if(!gr(t)){const{message:o}=fe("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});u&&(o.verified.origin=u,o.verified.validation=u===s.url?"VALID":"INVALID")}catch(u){this.client.logger.error(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Vt(o,!1)){const{message:u}=fe("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(u)}})}}isInitialized(){if(!this.initialized){const{message:e}=fe("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on($t.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);cu(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Js(o)&&(await this.client.core.history.resolve(o),this.onRelayEventResponse({topic:t,payload:o}))})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async e=>{const{topic:t,id:s}=Xh(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,fe("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Vt(e,!1)){const{message:t}=fe("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(mn(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=fe("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Vt(e,!1)){const{message:t}=fe("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(mn(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=fe("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Vt(e,!1)){const{message:t}=fe("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=fe("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!Nb(e)){const{message:t}=fe("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=fe("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(mn(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=fe("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class p3 extends Zs{constructor(e,t){super(e,t,n3,vu),this.core=e,this.logger=t}}class g3 extends Zs{constructor(e,t){super(e,t,i3,vu),this.core=e,this.logger=t}}class _3 extends Zs{constructor(e,t){super(e,t,o3,vu,s=>s.id),this.core=e,this.logger=t}}class Eu extends R_{constructor(e){super(e),this.protocol=rd,this.version=nd,this.name=bu.name,this.events=new Qt.exports.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=e?.name||bu.name,this.metadata=e?.metadata||Xv();const t=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||bu.logger}));this.core=e?.core||new r3(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new g3(this.core,this.logger),this.proposal=new p3(this.core,this.logger),this.pendingRequest=new _3(this.core,this.logger),this.engine=new d3(this)}static async init(e){const t=new Eu(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const ud="error",y3="wss://relay.walletconnect.com",v3="wc",b3="universal_provider",cd=`${v3}@${2}:${b3}:`,w3="https://rpc.walletconnect.com/v1",Dn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Su={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(n,e){(function(){var t,s="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,E="__lodash_placeholder__",C=1,D=2,T=4,R=1,q=2,K=1,se=2,L=4,M=8,x=16,P=32,m=64,c=128,b=256,V=512,k=30,ie="...",ue=800,de=16,w=1,I=2,ee=3,X=1/0,G=9007199254740991,W=17976931348623157e292,J=0/0,re=4294967295,we=re-1,oe=re>>>1,me=[["ary",c],["bind",K],["bindKey",se],["curry",M],["curryRight",x],["flip",V],["partial",P],["partialRight",m],["rearg",b]],he="[object Arguments]",ve="[object Array]",j="[object AsyncFunction]",H="[object Boolean]",F="[object Date]",d="[object DOMException]",A="[object Error]",ae="[object Function]",le="[object GeneratorFunction]",xe="[object Map]",qe="[object Number]",Ge="[object Null]",$e="[object Object]",gt="[object Promise]",_t="[object Proxy]",Be="[object RegExp]",Oe="[object Set]",Le="[object String]",Fe="[object Symbol]",He="[object Undefined]",Ae="[object WeakMap]",Ue="[object WeakSet]",De="[object ArrayBuffer]",Pe="[object DataView]",ze="[object Float32Array]",Ie="[object Float64Array]",We="[object Int8Array]",Ye="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Xe="[object Uint8ClampedArray]",ur="[object Uint16Array]",_r="[object Uint32Array]",Zr=/\b__p \+= '';/g,cr=/\b(__p \+=) '' \+/g,un=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xn=/&(?:amp|lt|gt|quot|#39);/g,kn=/[&<>"']/g,St=RegExp(xn.source),yt=RegExp(kn.source),Dt=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,mt=/<%=([\s\S]+?)%>/g,vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mt=/^\w*$/,Bt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,Ht=RegExp(Ot.source),It=/^\s+/,Tt=/\s/,At=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Au=/[()=,{}\[\]\/\s]/,Pu=/\\(\\)?/g,Cu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Rr=/\w*$/,Tu=/^[-+]0x[0-9a-f]+$/i,Ru=/^0b[01]+$/i,Nu=/^\[object .+?Constructor\]$/,Lu=/^0o[0-7]+$/i,Fu=/^(?:0|[1-9]\d*)$/,cn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bi=/($^)/,Uu=/['\n\r\u2028\u2029\\]/g,wi="\\ud800-\\udfff",$u="\\u0300-\\u036f",Mu="\\ufe20-\\ufe2f",mi="\\u20d0-\\u20ff",no=$u+Mu+mi,io="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",Bu="\\xac\\xb1\\xd7\\xf7",Hu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ju="\\u2000-\\u206f",qu=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",so="A-Z\\xc0-\\xd6\\xd8-\\xde",oo="\\ufe0e\\ufe0f",Jn=Bu+Hu+ju+qu,fs="['\u2019]",Xn="["+wi+"]",hs="["+Jn+"]",Zn="["+no+"]",ao="\\d+",zu="["+io+"]",uo="["+qr+"]",co="[^"+wi+Jn+ao+io+qr+so+"]",Ei="\\ud83c[\\udffb-\\udfff]",Ku="(?:"+Zn+"|"+Ei+")",fo="[^"+wi+"]",Si="(?:\\ud83c[\\udde6-\\uddff]){2}",On="[\\ud800-\\udbff][\\udc00-\\udfff]",Sr="["+so+"]",ho="\\u200d",lo="(?:"+uo+"|"+co+")",Qr="(?:"+Sr+"|"+co+")",po="(?:"+fs+"(?:d|ll|m|re|s|t|ve))?",go="(?:"+fs+"(?:D|LL|M|RE|S|T|VE))?",_o=Ku+"?",yo="["+oo+"]?",Gu="(?:"+ho+"(?:"+[fo,Si,On].join("|")+")"+yo+_o+")*",fn="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bo=yo+_o+Gu,Di="(?:"+[zu,Si,On].join("|")+")"+bo,Wu="(?:"+[fo+Zn+"?",Zn,Si,On,Xn].join("|")+")",ls=RegExp(fs,"g"),Vu=RegExp(Zn,"g"),xi=RegExp(Ei+"(?="+Ei+")|"+Wu+bo,"g"),wo=RegExp([Sr+"?"+uo+"+"+po+"(?="+[hs,Sr,"$"].join("|")+")",Qr+"+"+go+"(?="+[hs,Sr+lo,"$"].join("|")+")",Sr+"?"+lo+"+"+po,Sr+"+"+go,vo,fn,ao,Di].join("|"),"g"),mo=RegExp("["+ho+wi+no+oo+"]"),Qn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Eo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yu=-1,at={};at[ze]=at[Ie]=at[We]=at[Ye]=at[et]=at[tt]=at[Xe]=at[ur]=at[_r]=!0,at[he]=at[ve]=at[De]=at[H]=at[Pe]=at[F]=at[A]=at[ae]=at[xe]=at[qe]=at[$e]=at[Be]=at[Oe]=at[Le]=at[Ae]=!1;var ot={};ot[he]=ot[ve]=ot[De]=ot[Pe]=ot[H]=ot[F]=ot[ze]=ot[Ie]=ot[We]=ot[Ye]=ot[et]=ot[xe]=ot[qe]=ot[$e]=ot[Be]=ot[Oe]=ot[Le]=ot[Fe]=ot[tt]=ot[Xe]=ot[ur]=ot[_r]=!0,ot[A]=ot[ae]=ot[Ae]=!1;var S={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ut=parseFloat,Te=parseInt,dt=typeof wt=="object"&&wt&&wt.Object===Object&&wt,zt=typeof self=="object"&&self&&self.Object===Object&&self,Ze=dt||zt||Function("return this")(),ct=e&&!e.nodeType&&e,Rt=ct&&!0&&n&&!n.nodeType&&n,yr=Rt&&Rt.exports===ct,Kt=yr&&dt.process,pt=function(){try{var U=Rt&&Rt.require&&Rt.require("util").types;return U||Kt&&Kt.binding&&Kt.binding("util")}catch{}}(),fr=pt&&pt.isArrayBuffer,zr=pt&&pt.isDate,Nr=pt&&pt.isMap,en=pt&&pt.isRegExp,ds=pt&&pt.isSet,ei=pt&&pt.isTypedArray;function Yt(U,Y,z){switch(z.length){case 0:return U.call(Y);case 1:return U.call(Y,z[0]);case 2:return U.call(Y,z[0],z[1]);case 3:return U.call(Y,z[0],z[1],z[2])}return U.apply(Y,z)}function G3(U,Y,z,ge){for(var Ce=-1,rt=U==null?0:U.length;++Ce<rt;){var Gt=U[Ce];Y(ge,Gt,z(Gt),U)}return ge}function Lr(U,Y){for(var z=-1,ge=U==null?0:U.length;++z<ge&&Y(U[z],z,U)!==!1;);return U}function W3(U,Y){for(var z=U==null?0:U.length;z--&&Y(U[z],z,U)!==!1;);return U}function bd(U,Y){for(var z=-1,ge=U==null?0:U.length;++z<ge;)if(!Y(U[z],z,U))return!1;return!0}function In(U,Y){for(var z=-1,ge=U==null?0:U.length,Ce=0,rt=[];++z<ge;){var Gt=U[z];Y(Gt,z,U)&&(rt[Ce++]=Gt)}return rt}function So(U,Y){var z=U==null?0:U.length;return!!z&&Oi(U,Y,0)>-1}function ku(U,Y,z){for(var ge=-1,Ce=U==null?0:U.length;++ge<Ce;)if(z(Y,U[ge]))return!0;return!1}function bt(U,Y){for(var z=-1,ge=U==null?0:U.length,Ce=Array(ge);++z<ge;)Ce[z]=Y(U[z],z,U);return Ce}function An(U,Y){for(var z=-1,ge=Y.length,Ce=U.length;++z<ge;)U[Ce+z]=Y[z];return U}function Ju(U,Y,z,ge){var Ce=-1,rt=U==null?0:U.length;for(ge&&rt&&(z=U[++Ce]);++Ce<rt;)z=Y(z,U[Ce],Ce,U);return z}function V3(U,Y,z,ge){var Ce=U==null?0:U.length;for(ge&&Ce&&(z=U[--Ce]);Ce--;)z=Y(z,U[Ce],Ce,U);return z}function Xu(U,Y){for(var z=-1,ge=U==null?0:U.length;++z<ge;)if(Y(U[z],z,U))return!0;return!1}var Y3=Zu("length");function k3(U){return U.split("")}function J3(U){return U.match(qt)||[]}function wd(U,Y,z){var ge;return z(U,function(Ce,rt,Gt){if(Y(Ce,rt,Gt))return ge=rt,!1}),ge}function Do(U,Y,z,ge){for(var Ce=U.length,rt=z+(ge?1:-1);ge?rt--:++rt<Ce;)if(Y(U[rt],rt,U))return rt;return-1}function Oi(U,Y,z){return Y===Y?u2(U,Y,z):Do(U,md,z)}function X3(U,Y,z,ge){for(var Ce=z-1,rt=U.length;++Ce<rt;)if(ge(U[Ce],Y))return Ce;return-1}function md(U){return U!==U}function Ed(U,Y){var z=U==null?0:U.length;return z?ec(U,Y)/z:J}function Zu(U){return function(Y){return Y==null?t:Y[U]}}function Qu(U){return function(Y){return U==null?t:U[Y]}}function Sd(U,Y,z,ge,Ce){return Ce(U,function(rt,Gt,ft){z=ge?(ge=!1,rt):Y(z,rt,Gt,ft)}),z}function Z3(U,Y){var z=U.length;for(U.sort(Y);z--;)U[z]=U[z].value;return U}function ec(U,Y){for(var z,ge=-1,Ce=U.length;++ge<Ce;){var rt=Y(U[ge]);rt!==t&&(z=z===t?rt:z+rt)}return z}function tc(U,Y){for(var z=-1,ge=Array(U);++z<U;)ge[z]=Y(z);return ge}function Q3(U,Y){return bt(Y,function(z){return[z,U[z]]})}function Dd(U){return U&&U.slice(0,Ad(U)+1).replace(It,"")}function Dr(U){return function(Y){return U(Y)}}function rc(U,Y){return bt(Y,function(z){return U[z]})}function ps(U,Y){return U.has(Y)}function xd(U,Y){for(var z=-1,ge=U.length;++z<ge&&Oi(Y,U[z],0)>-1;);return z}function Od(U,Y){for(var z=U.length;z--&&Oi(Y,U[z],0)>-1;);return z}function e2(U,Y){for(var z=U.length,ge=0;z--;)U[z]===Y&&++ge;return ge}var t2=Qu(S),r2=Qu($);function n2(U){return"\\"+pe[U]}function i2(U,Y){return U==null?t:U[Y]}function Ii(U){return mo.test(U)}function s2(U){return Qn.test(U)}function o2(U){for(var Y,z=[];!(Y=U.next()).done;)z.push(Y.value);return z}function nc(U){var Y=-1,z=Array(U.size);return U.forEach(function(ge,Ce){z[++Y]=[Ce,ge]}),z}function Id(U,Y){return function(z){return U(Y(z))}}function Pn(U,Y){for(var z=-1,ge=U.length,Ce=0,rt=[];++z<ge;){var Gt=U[z];(Gt===Y||Gt===E)&&(U[z]=E,rt[Ce++]=z)}return rt}function xo(U){var Y=-1,z=Array(U.size);return U.forEach(function(ge){z[++Y]=ge}),z}function a2(U){var Y=-1,z=Array(U.size);return U.forEach(function(ge){z[++Y]=[ge,ge]}),z}function u2(U,Y,z){for(var ge=z-1,Ce=U.length;++ge<Ce;)if(U[ge]===Y)return ge;return-1}function c2(U,Y,z){for(var ge=z+1;ge--;)if(U[ge]===Y)return ge;return ge}function Ai(U){return Ii(U)?h2(U):Y3(U)}function Kr(U){return Ii(U)?l2(U):k3(U)}function Ad(U){for(var Y=U.length;Y--&&Tt.test(U.charAt(Y)););return Y}var f2=Qu(te);function h2(U){for(var Y=xi.lastIndex=0;xi.test(U);)++Y;return Y}function l2(U){return U.match(xi)||[]}function d2(U){return U.match(wo)||[]}var p2=function U(Y){Y=Y==null?Ze:Pi.defaults(Ze.Object(),Y,Pi.pick(Ze,Eo));var z=Y.Array,ge=Y.Date,Ce=Y.Error,rt=Y.Function,Gt=Y.Math,ft=Y.Object,ic=Y.RegExp,g2=Y.String,Fr=Y.TypeError,Oo=z.prototype,_2=rt.prototype,Ci=ft.prototype,Io=Y["__core-js_shared__"],Ao=_2.toString,it=Ci.hasOwnProperty,y2=0,Pd=function(){var r=/[^.]+$/.exec(Io&&Io.keys&&Io.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),Po=Ci.toString,v2=Ao.call(ft),b2=Ze._,w2=ic("^"+Ao.call(it).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Co=yr?Y.Buffer:t,Cn=Y.Symbol,To=Y.Uint8Array,Cd=Co?Co.allocUnsafe:t,Ro=Id(ft.getPrototypeOf,ft),Td=ft.create,Rd=Ci.propertyIsEnumerable,No=Oo.splice,Nd=Cn?Cn.isConcatSpreadable:t,gs=Cn?Cn.iterator:t,ti=Cn?Cn.toStringTag:t,Lo=function(){try{var r=oi(ft,"defineProperty");return r({},"",{}),r}catch{}}(),m2=Y.clearTimeout!==Ze.clearTimeout&&Y.clearTimeout,E2=ge&&ge.now!==Ze.Date.now&&ge.now,S2=Y.setTimeout!==Ze.setTimeout&&Y.setTimeout,Fo=Gt.ceil,Uo=Gt.floor,sc=ft.getOwnPropertySymbols,D2=Co?Co.isBuffer:t,Ld=Y.isFinite,x2=Oo.join,O2=Id(ft.keys,ft),Wt=Gt.max,tr=Gt.min,I2=ge.now,A2=Y.parseInt,Fd=Gt.random,P2=Oo.reverse,oc=oi(Y,"DataView"),_s=oi(Y,"Map"),ac=oi(Y,"Promise"),Ti=oi(Y,"Set"),ys=oi(Y,"WeakMap"),vs=oi(ft,"create"),$o=ys&&new ys,Ri={},C2=ai(oc),T2=ai(_s),R2=ai(ac),N2=ai(Ti),L2=ai(ys),Mo=Cn?Cn.prototype:t,bs=Mo?Mo.valueOf:t,Ud=Mo?Mo.toString:t;function y(r){if(Pt(r)&&!Re(r)&&!(r instanceof ke)){if(r instanceof Ur)return r;if(it.call(r,"__wrapped__"))return $p(r)}return new Ur(r)}var Ni=function(){function r(){}return function(i){if(!Et(i))return{};if(Td)return Td(i);r.prototype=i;var a=new r;return r.prototype=t,a}}();function Bo(){}function Ur(r,i){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}y.templateSettings={escape:Dt,evaluate:xt,interpolate:mt,variable:"",imports:{_:y}},y.prototype=Bo.prototype,y.prototype.constructor=y,Ur.prototype=Ni(Bo.prototype),Ur.prototype.constructor=Ur;function ke(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function F2(){var r=new ke(this.__wrapped__);return r.__actions__=vr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=vr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=vr(this.__views__),r}function U2(){if(this.__filtered__){var r=new ke(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function $2(){var r=this.__wrapped__.value(),i=this.__dir__,a=Re(r),f=i<0,g=a?r.length:0,v=k6(0,g,this.__views__),O=v.start,N=v.end,B=N-O,Z=f?N:O-1,Q=this.__iteratees__,ne=Q.length,ce=0,_e=tr(B,this.__takeCount__);if(!a||!f&&g==B&&_e==B)return op(r,this.__actions__);var Ee=[];e:for(;B--&&ce<_e;){Z+=i;for(var je=-1,Se=r[Z];++je<ne;){var Ve=Q[je],Qe=Ve.iteratee,Ir=Ve.type,dr=Qe(Se);if(Ir==I)Se=dr;else if(!dr){if(Ir==w)continue e;break e}}Ee[ce++]=Se}return Ee}ke.prototype=Ni(Bo.prototype),ke.prototype.constructor=ke;function ri(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var f=r[i];this.set(f[0],f[1])}}function M2(){this.__data__=vs?vs(null):{},this.size=0}function B2(r){var i=this.has(r)&&delete this.__data__[r];return this.size-=i?1:0,i}function H2(r){var i=this.__data__;if(vs){var a=i[r];return a===_?t:a}return it.call(i,r)?i[r]:t}function j2(r){var i=this.__data__;return vs?i[r]!==t:it.call(i,r)}function q2(r,i){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=vs&&i===t?_:i,this}ri.prototype.clear=M2,ri.prototype.delete=B2,ri.prototype.get=H2,ri.prototype.has=j2,ri.prototype.set=q2;function hn(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var f=r[i];this.set(f[0],f[1])}}function z2(){this.__data__=[],this.size=0}function K2(r){var i=this.__data__,a=Ho(i,r);if(a<0)return!1;var f=i.length-1;return a==f?i.pop():No.call(i,a,1),--this.size,!0}function G2(r){var i=this.__data__,a=Ho(i,r);return a<0?t:i[a][1]}function W2(r){return Ho(this.__data__,r)>-1}function V2(r,i){var a=this.__data__,f=Ho(a,r);return f<0?(++this.size,a.push([r,i])):a[f][1]=i,this}hn.prototype.clear=z2,hn.prototype.delete=K2,hn.prototype.get=G2,hn.prototype.has=W2,hn.prototype.set=V2;function ln(r){var i=-1,a=r==null?0:r.length;for(this.clear();++i<a;){var f=r[i];this.set(f[0],f[1])}}function Y2(){this.size=0,this.__data__={hash:new ri,map:new(_s||hn),string:new ri}}function k2(r){var i=Zo(this,r).delete(r);return this.size-=i?1:0,i}function J2(r){return Zo(this,r).get(r)}function X2(r){return Zo(this,r).has(r)}function Z2(r,i){var a=Zo(this,r),f=a.size;return a.set(r,i),this.size+=a.size==f?0:1,this}ln.prototype.clear=Y2,ln.prototype.delete=k2,ln.prototype.get=J2,ln.prototype.has=X2,ln.prototype.set=Z2;function ni(r){var i=-1,a=r==null?0:r.length;for(this.__data__=new ln;++i<a;)this.add(r[i])}function Q2(r){return this.__data__.set(r,_),this}function e6(r){return this.__data__.has(r)}ni.prototype.add=ni.prototype.push=Q2,ni.prototype.has=e6;function Gr(r){var i=this.__data__=new hn(r);this.size=i.size}function t6(){this.__data__=new hn,this.size=0}function r6(r){var i=this.__data__,a=i.delete(r);return this.size=i.size,a}function n6(r){return this.__data__.get(r)}function i6(r){return this.__data__.has(r)}function s6(r,i){var a=this.__data__;if(a instanceof hn){var f=a.__data__;if(!_s||f.length<o-1)return f.push([r,i]),this.size=++a.size,this;a=this.__data__=new ln(f)}return a.set(r,i),this.size=a.size,this}Gr.prototype.clear=t6,Gr.prototype.delete=r6,Gr.prototype.get=n6,Gr.prototype.has=i6,Gr.prototype.set=s6;function $d(r,i){var a=Re(r),f=!a&&ui(r),g=!a&&!f&&Fn(r),v=!a&&!f&&!g&&$i(r),O=a||f||g||v,N=O?tc(r.length,g2):[],B=N.length;for(var Z in r)(i||it.call(r,Z))&&!(O&&(Z=="length"||g&&(Z=="offset"||Z=="parent")||v&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||_n(Z,B)))&&N.push(Z);return N}function Md(r){var i=r.length;return i?r[vc(0,i-1)]:t}function o6(r,i){return Qo(vr(r),ii(i,0,r.length))}function a6(r){return Qo(vr(r))}function uc(r,i,a){(a!==t&&!Wr(r[i],a)||a===t&&!(i in r))&&dn(r,i,a)}function ws(r,i,a){var f=r[i];(!(it.call(r,i)&&Wr(f,a))||a===t&&!(i in r))&&dn(r,i,a)}function Ho(r,i){for(var a=r.length;a--;)if(Wr(r[a][0],i))return a;return-1}function u6(r,i,a,f){return Tn(r,function(g,v,O){i(f,g,a(g),O)}),f}function Bd(r,i){return r&&rn(i,kt(i),r)}function c6(r,i){return r&&rn(i,wr(i),r)}function dn(r,i,a){i=="__proto__"&&Lo?Lo(r,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[i]=a}function cc(r,i){for(var a=-1,f=i.length,g=z(f),v=r==null;++a<f;)g[a]=v?t:zc(r,i[a]);return g}function ii(r,i,a){return r===r&&(a!==t&&(r=r<=a?r:a),i!==t&&(r=r>=i?r:i)),r}function $r(r,i,a,f,g,v){var O,N=i&C,B=i&D,Z=i&T;if(a&&(O=g?a(r,f,g,v):a(r)),O!==t)return O;if(!Et(r))return r;var Q=Re(r);if(Q){if(O=X6(r),!N)return vr(r,O)}else{var ne=rr(r),ce=ne==ae||ne==le;if(Fn(r))return cp(r,N);if(ne==$e||ne==he||ce&&!g){if(O=B||ce?{}:Ap(r),!N)return B?H6(r,c6(O,r)):B6(r,Bd(O,r))}else{if(!ot[ne])return g?r:{};O=Z6(r,ne,N)}}v||(v=new Gr);var _e=v.get(r);if(_e)return _e;v.set(r,O),ng(r)?r.forEach(function(Se){O.add($r(Se,i,a,Se,r,v))}):tg(r)&&r.forEach(function(Se,Ve){O.set(Ve,$r(Se,i,a,Ve,r,v))});var Ee=Z?B?Pc:Ac:B?wr:kt,je=Q?t:Ee(r);return Lr(je||r,function(Se,Ve){je&&(Ve=Se,Se=r[Ve]),ws(O,Ve,$r(Se,i,a,Ve,r,v))}),O}function f6(r){var i=kt(r);return function(a){return Hd(a,r,i)}}function Hd(r,i,a){var f=a.length;if(r==null)return!f;for(r=ft(r);f--;){var g=a[f],v=i[g],O=r[g];if(O===t&&!(g in r)||!v(O))return!1}return!0}function jd(r,i,a){if(typeof r!="function")throw new Fr(h);return Is(function(){r.apply(t,a)},i)}function ms(r,i,a,f){var g=-1,v=So,O=!0,N=r.length,B=[],Z=i.length;if(!N)return B;a&&(i=bt(i,Dr(a))),f?(v=ku,O=!1):i.length>=o&&(v=ps,O=!1,i=new ni(i));e:for(;++g<N;){var Q=r[g],ne=a==null?Q:a(Q);if(Q=f||Q!==0?Q:0,O&&ne===ne){for(var ce=Z;ce--;)if(i[ce]===ne)continue e;B.push(Q)}else v(i,ne,f)||B.push(Q)}return B}var Tn=pp(tn),qd=pp(hc,!0);function h6(r,i){var a=!0;return Tn(r,function(f,g,v){return a=!!i(f,g,v),a}),a}function jo(r,i,a){for(var f=-1,g=r.length;++f<g;){var v=r[f],O=i(v);if(O!=null&&(N===t?O===O&&!Or(O):a(O,N)))var N=O,B=v}return B}function l6(r,i,a,f){var g=r.length;for(a=Me(a),a<0&&(a=-a>g?0:g+a),f=f===t||f>g?g:Me(f),f<0&&(f+=g),f=a>f?0:sg(f);a<f;)r[a++]=i;return r}function zd(r,i){var a=[];return Tn(r,function(f,g,v){i(f,g,v)&&a.push(f)}),a}function Zt(r,i,a,f,g){var v=-1,O=r.length;for(a||(a=eS),g||(g=[]);++v<O;){var N=r[v];i>0&&a(N)?i>1?Zt(N,i-1,a,f,g):An(g,N):f||(g[g.length]=N)}return g}var fc=gp(),Kd=gp(!0);function tn(r,i){return r&&fc(r,i,kt)}function hc(r,i){return r&&Kd(r,i,kt)}function qo(r,i){return In(i,function(a){return yn(r[a])})}function si(r,i){i=Nn(i,r);for(var a=0,f=i.length;r!=null&&a<f;)r=r[nn(i[a++])];return a&&a==f?r:t}function Gd(r,i,a){var f=i(r);return Re(r)?f:An(f,a(r))}function hr(r){return r==null?r===t?He:Ge:ti&&ti in ft(r)?Y6(r):aS(r)}function lc(r,i){return r>i}function d6(r,i){return r!=null&&it.call(r,i)}function p6(r,i){return r!=null&&i in ft(r)}function g6(r,i,a){return r>=tr(i,a)&&r<Wt(i,a)}function dc(r,i,a){for(var f=a?ku:So,g=r[0].length,v=r.length,O=v,N=z(v),B=1/0,Z=[];O--;){var Q=r[O];O&&i&&(Q=bt(Q,Dr(i))),B=tr(Q.length,B),N[O]=!a&&(i||g>=120&&Q.length>=120)?new ni(O&&Q):t}Q=r[0];var ne=-1,ce=N[0];e:for(;++ne<g&&Z.length<B;){var _e=Q[ne],Ee=i?i(_e):_e;if(_e=a||_e!==0?_e:0,!(ce?ps(ce,Ee):f(Z,Ee,a))){for(O=v;--O;){var je=N[O];if(!(je?ps(je,Ee):f(r[O],Ee,a)))continue e}ce&&ce.push(Ee),Z.push(_e)}}return Z}function _6(r,i,a,f){return tn(r,function(g,v,O){i(f,a(g),v,O)}),f}function Es(r,i,a){i=Nn(i,r),r=Rp(r,i);var f=r==null?r:r[nn(Br(i))];return f==null?t:Yt(f,r,a)}function Wd(r){return Pt(r)&&hr(r)==he}function y6(r){return Pt(r)&&hr(r)==De}function v6(r){return Pt(r)&&hr(r)==F}function Ss(r,i,a,f,g){return r===i?!0:r==null||i==null||!Pt(r)&&!Pt(i)?r!==r&&i!==i:b6(r,i,a,f,Ss,g)}function b6(r,i,a,f,g,v){var O=Re(r),N=Re(i),B=O?ve:rr(r),Z=N?ve:rr(i);B=B==he?$e:B,Z=Z==he?$e:Z;var Q=B==$e,ne=Z==$e,ce=B==Z;if(ce&&Fn(r)){if(!Fn(i))return!1;O=!0,Q=!1}if(ce&&!Q)return v||(v=new Gr),O||$i(r)?xp(r,i,a,f,g,v):W6(r,i,B,a,f,g,v);if(!(a&R)){var _e=Q&&it.call(r,"__wrapped__"),Ee=ne&&it.call(i,"__wrapped__");if(_e||Ee){var je=_e?r.value():r,Se=Ee?i.value():i;return v||(v=new Gr),g(je,Se,a,f,v)}}return ce?(v||(v=new Gr),V6(r,i,a,f,g,v)):!1}function w6(r){return Pt(r)&&rr(r)==xe}function pc(r,i,a,f){var g=a.length,v=g,O=!f;if(r==null)return!v;for(r=ft(r);g--;){var N=a[g];if(O&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++g<v;){N=a[g];var B=N[0],Z=r[B],Q=N[1];if(O&&N[2]){if(Z===t&&!(B in r))return!1}else{var ne=new Gr;if(f)var ce=f(Z,Q,B,r,i,ne);if(!(ce===t?Ss(Q,Z,R|q,f,ne):ce))return!1}}return!0}function Vd(r){if(!Et(r)||rS(r))return!1;var i=yn(r)?w2:Nu;return i.test(ai(r))}function m6(r){return Pt(r)&&hr(r)==Be}function E6(r){return Pt(r)&&rr(r)==Oe}function S6(r){return Pt(r)&&sa(r.length)&&!!at[hr(r)]}function Yd(r){return typeof r=="function"?r:r==null?mr:typeof r=="object"?Re(r)?Xd(r[0],r[1]):Jd(r):_g(r)}function gc(r){if(!Os(r))return O2(r);var i=[];for(var a in ft(r))it.call(r,a)&&a!="constructor"&&i.push(a);return i}function D6(r){if(!Et(r))return oS(r);var i=Os(r),a=[];for(var f in r)f=="constructor"&&(i||!it.call(r,f))||a.push(f);return a}function _c(r,i){return r<i}function kd(r,i){var a=-1,f=br(r)?z(r.length):[];return Tn(r,function(g,v,O){f[++a]=i(g,v,O)}),f}function Jd(r){var i=Tc(r);return i.length==1&&i[0][2]?Cp(i[0][0],i[0][1]):function(a){return a===r||pc(a,r,i)}}function Xd(r,i){return Nc(r)&&Pp(i)?Cp(nn(r),i):function(a){var f=zc(a,r);return f===t&&f===i?Kc(a,r):Ss(i,f,R|q)}}function zo(r,i,a,f,g){r!==i&&fc(i,function(v,O){if(g||(g=new Gr),Et(v))x6(r,i,O,a,zo,f,g);else{var N=f?f(Fc(r,O),v,O+"",r,i,g):t;N===t&&(N=v),uc(r,O,N)}},wr)}function x6(r,i,a,f,g,v,O){var N=Fc(r,a),B=Fc(i,a),Z=O.get(B);if(Z){uc(r,a,Z);return}var Q=v?v(N,B,a+"",r,i,O):t,ne=Q===t;if(ne){var ce=Re(B),_e=!ce&&Fn(B),Ee=!ce&&!_e&&$i(B);Q=B,ce||_e||Ee?Re(N)?Q=N:Nt(N)?Q=vr(N):_e?(ne=!1,Q=cp(B,!0)):Ee?(ne=!1,Q=fp(B,!0)):Q=[]:As(B)||ui(B)?(Q=N,ui(N)?Q=og(N):(!Et(N)||yn(N))&&(Q=Ap(B))):ne=!1}ne&&(O.set(B,Q),g(Q,B,f,v,O),O.delete(B)),uc(r,a,Q)}function Zd(r,i){var a=r.length;if(a)return i+=i<0?a:0,_n(i,a)?r[i]:t}function Qd(r,i,a){i.length?i=bt(i,function(v){return Re(v)?function(O){return si(O,v.length===1?v[0]:v)}:v}):i=[mr];var f=-1;i=bt(i,Dr(be()));var g=kd(r,function(v,O,N){var B=bt(i,function(Z){return Z(v)});return{criteria:B,index:++f,value:v}});return Z3(g,function(v,O){return M6(v,O,a)})}function O6(r,i){return ep(r,i,function(a,f){return Kc(r,f)})}function ep(r,i,a){for(var f=-1,g=i.length,v={};++f<g;){var O=i[f],N=si(r,O);a(N,O)&&Ds(v,Nn(O,r),N)}return v}function I6(r){return function(i){return si(i,r)}}function yc(r,i,a,f){var g=f?X3:Oi,v=-1,O=i.length,N=r;for(r===i&&(i=vr(i)),a&&(N=bt(r,Dr(a)));++v<O;)for(var B=0,Z=i[v],Q=a?a(Z):Z;(B=g(N,Q,B,f))>-1;)N!==r&&No.call(N,B,1),No.call(r,B,1);return r}function tp(r,i){for(var a=r?i.length:0,f=a-1;a--;){var g=i[a];if(a==f||g!==v){var v=g;_n(g)?No.call(r,g,1):mc(r,g)}}return r}function vc(r,i){return r+Uo(Fd()*(i-r+1))}function A6(r,i,a,f){for(var g=-1,v=Wt(Fo((i-r)/(a||1)),0),O=z(v);v--;)O[f?v:++g]=r,r+=a;return O}function bc(r,i){var a="";if(!r||i<1||i>G)return a;do i%2&&(a+=r),i=Uo(i/2),i&&(r+=r);while(i);return a}function Ke(r,i){return Uc(Tp(r,i,mr),r+"")}function P6(r){return Md(Mi(r))}function C6(r,i){var a=Mi(r);return Qo(a,ii(i,0,a.length))}function Ds(r,i,a,f){if(!Et(r))return r;i=Nn(i,r);for(var g=-1,v=i.length,O=v-1,N=r;N!=null&&++g<v;){var B=nn(i[g]),Z=a;if(B==="__proto__"||B==="constructor"||B==="prototype")return r;if(g!=O){var Q=N[B];Z=f?f(Q,B,N):t,Z===t&&(Z=Et(Q)?Q:_n(i[g+1])?[]:{})}ws(N,B,Z),N=N[B]}return r}var rp=$o?function(r,i){return $o.set(r,i),r}:mr,T6=Lo?function(r,i){return Lo(r,"toString",{configurable:!0,enumerable:!1,value:Wc(i),writable:!0})}:mr;function R6(r){return Qo(Mi(r))}function Mr(r,i,a){var f=-1,g=r.length;i<0&&(i=-i>g?0:g+i),a=a>g?g:a,a<0&&(a+=g),g=i>a?0:a-i>>>0,i>>>=0;for(var v=z(g);++f<g;)v[f]=r[f+i];return v}function N6(r,i){var a;return Tn(r,function(f,g,v){return a=i(f,g,v),!a}),!!a}function Ko(r,i,a){var f=0,g=r==null?f:r.length;if(typeof i=="number"&&i===i&&g<=oe){for(;f<g;){var v=f+g>>>1,O=r[v];O!==null&&!Or(O)&&(a?O<=i:O<i)?f=v+1:g=v}return g}return wc(r,i,mr,a)}function wc(r,i,a,f){var g=0,v=r==null?0:r.length;if(v===0)return 0;i=a(i);for(var O=i!==i,N=i===null,B=Or(i),Z=i===t;g<v;){var Q=Uo((g+v)/2),ne=a(r[Q]),ce=ne!==t,_e=ne===null,Ee=ne===ne,je=Or(ne);if(O)var Se=f||Ee;else Z?Se=Ee&&(f||ce):N?Se=Ee&&ce&&(f||!_e):B?Se=Ee&&ce&&!_e&&(f||!je):_e||je?Se=!1:Se=f?ne<=i:ne<i;Se?g=Q+1:v=Q}return tr(v,we)}function np(r,i){for(var a=-1,f=r.length,g=0,v=[];++a<f;){var O=r[a],N=i?i(O):O;if(!a||!Wr(N,B)){var B=N;v[g++]=O===0?0:O}}return v}function ip(r){return typeof r=="number"?r:Or(r)?J:+r}function xr(r){if(typeof r=="string")return r;if(Re(r))return bt(r,xr)+"";if(Or(r))return Ud?Ud.call(r):"";var i=r+"";return i=="0"&&1/r==-X?"-0":i}function Rn(r,i,a){var f=-1,g=So,v=r.length,O=!0,N=[],B=N;if(a)O=!1,g=ku;else if(v>=o){var Z=i?null:K6(r);if(Z)return xo(Z);O=!1,g=ps,B=new ni}else B=i?[]:N;e:for(;++f<v;){var Q=r[f],ne=i?i(Q):Q;if(Q=a||Q!==0?Q:0,O&&ne===ne){for(var ce=B.length;ce--;)if(B[ce]===ne)continue e;i&&B.push(ne),N.push(Q)}else g(B,ne,a)||(B!==N&&B.push(ne),N.push(Q))}return N}function mc(r,i){return i=Nn(i,r),r=Rp(r,i),r==null||delete r[nn(Br(i))]}function sp(r,i,a,f){return Ds(r,i,a(si(r,i)),f)}function Go(r,i,a,f){for(var g=r.length,v=f?g:-1;(f?v--:++v<g)&&i(r[v],v,r););return a?Mr(r,f?0:v,f?v+1:g):Mr(r,f?v+1:0,f?g:v)}function op(r,i){var a=r;return a instanceof ke&&(a=a.value()),Ju(i,function(f,g){return g.func.apply(g.thisArg,An([f],g.args))},a)}function Ec(r,i,a){var f=r.length;if(f<2)return f?Rn(r[0]):[];for(var g=-1,v=z(f);++g<f;)for(var O=r[g],N=-1;++N<f;)N!=g&&(v[g]=ms(v[g]||O,r[N],i,a));return Rn(Zt(v,1),i,a)}function ap(r,i,a){for(var f=-1,g=r.length,v=i.length,O={};++f<g;){var N=f<v?i[f]:t;a(O,r[f],N)}return O}function Sc(r){return Nt(r)?r:[]}function Dc(r){return typeof r=="function"?r:mr}function Nn(r,i){return Re(r)?r:Nc(r,i)?[r]:Up(nt(r))}var L6=Ke;function Ln(r,i,a){var f=r.length;return a=a===t?f:a,!i&&a>=f?r:Mr(r,i,a)}var up=m2||function(r){return Ze.clearTimeout(r)};function cp(r,i){if(i)return r.slice();var a=r.length,f=Cd?Cd(a):new r.constructor(a);return r.copy(f),f}function xc(r){var i=new r.constructor(r.byteLength);return new To(i).set(new To(r)),i}function F6(r,i){var a=i?xc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function U6(r){var i=new r.constructor(r.source,Rr.exec(r));return i.lastIndex=r.lastIndex,i}function $6(r){return bs?ft(bs.call(r)):{}}function fp(r,i){var a=i?xc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function hp(r,i){if(r!==i){var a=r!==t,f=r===null,g=r===r,v=Or(r),O=i!==t,N=i===null,B=i===i,Z=Or(i);if(!N&&!Z&&!v&&r>i||v&&O&&B&&!N&&!Z||f&&O&&B||!a&&B||!g)return 1;if(!f&&!v&&!Z&&r<i||Z&&a&&g&&!f&&!v||N&&a&&g||!O&&g||!B)return-1}return 0}function M6(r,i,a){for(var f=-1,g=r.criteria,v=i.criteria,O=g.length,N=a.length;++f<O;){var B=hp(g[f],v[f]);if(B){if(f>=N)return B;var Z=a[f];return B*(Z=="desc"?-1:1)}}return r.index-i.index}function lp(r,i,a,f){for(var g=-1,v=r.length,O=a.length,N=-1,B=i.length,Z=Wt(v-O,0),Q=z(B+Z),ne=!f;++N<B;)Q[N]=i[N];for(;++g<O;)(ne||g<v)&&(Q[a[g]]=r[g]);for(;Z--;)Q[N++]=r[g++];return Q}function dp(r,i,a,f){for(var g=-1,v=r.length,O=-1,N=a.length,B=-1,Z=i.length,Q=Wt(v-N,0),ne=z(Q+Z),ce=!f;++g<Q;)ne[g]=r[g];for(var _e=g;++B<Z;)ne[_e+B]=i[B];for(;++O<N;)(ce||g<v)&&(ne[_e+a[O]]=r[g++]);return ne}function vr(r,i){var a=-1,f=r.length;for(i||(i=z(f));++a<f;)i[a]=r[a];return i}function rn(r,i,a,f){var g=!a;a||(a={});for(var v=-1,O=i.length;++v<O;){var N=i[v],B=f?f(a[N],r[N],N,a,r):t;B===t&&(B=r[N]),g?dn(a,N,B):ws(a,N,B)}return a}function B6(r,i){return rn(r,Rc(r),i)}function H6(r,i){return rn(r,Op(r),i)}function Wo(r,i){return function(a,f){var g=Re(a)?G3:u6,v=i?i():{};return g(a,r,be(f,2),v)}}function Li(r){return Ke(function(i,a){var f=-1,g=a.length,v=g>1?a[g-1]:t,O=g>2?a[2]:t;for(v=r.length>3&&typeof v=="function"?(g--,v):t,O&&lr(a[0],a[1],O)&&(v=g<3?t:v,g=1),i=ft(i);++f<g;){var N=a[f];N&&r(i,N,f,v)}return i})}function pp(r,i){return function(a,f){if(a==null)return a;if(!br(a))return r(a,f);for(var g=a.length,v=i?g:-1,O=ft(a);(i?v--:++v<g)&&f(O[v],v,O)!==!1;);return a}}function gp(r){return function(i,a,f){for(var g=-1,v=ft(i),O=f(i),N=O.length;N--;){var B=O[r?N:++g];if(a(v[B],B,v)===!1)break}return i}}function j6(r,i,a){var f=i&K,g=xs(r);function v(){var O=this&&this!==Ze&&this instanceof v?g:r;return O.apply(f?a:this,arguments)}return v}function _p(r){return function(i){i=nt(i);var a=Ii(i)?Kr(i):t,f=a?a[0]:i.charAt(0),g=a?Ln(a,1).join(""):i.slice(1);return f[r]()+g}}function Fi(r){return function(i){return Ju(pg(dg(i).replace(ls,"")),r,"")}}function xs(r){return function(){var i=arguments;switch(i.length){case 0:return new r;case 1:return new r(i[0]);case 2:return new r(i[0],i[1]);case 3:return new r(i[0],i[1],i[2]);case 4:return new r(i[0],i[1],i[2],i[3]);case 5:return new r(i[0],i[1],i[2],i[3],i[4]);case 6:return new r(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=Ni(r.prototype),f=r.apply(a,i);return Et(f)?f:a}}function q6(r,i,a){var f=xs(r);function g(){for(var v=arguments.length,O=z(v),N=v,B=Ui(g);N--;)O[N]=arguments[N];var Z=v<3&&O[0]!==B&&O[v-1]!==B?[]:Pn(O,B);if(v-=Z.length,v<a)return mp(r,i,Vo,g.placeholder,t,O,Z,t,t,a-v);var Q=this&&this!==Ze&&this instanceof g?f:r;return Yt(Q,this,O)}return g}function yp(r){return function(i,a,f){var g=ft(i);if(!br(i)){var v=be(a,3);i=kt(i),a=function(N){return v(g[N],N,g)}}var O=r(i,a,f);return O>-1?g[v?i[O]:O]:t}}function vp(r){return gn(function(i){var a=i.length,f=a,g=Ur.prototype.thru;for(r&&i.reverse();f--;){var v=i[f];if(typeof v!="function")throw new Fr(h);if(g&&!O&&Xo(v)=="wrapper")var O=new Ur([],!0)}for(f=O?f:a;++f<a;){v=i[f];var N=Xo(v),B=N=="wrapper"?Cc(v):t;B&&Lc(B[0])&&B[1]==(c|M|P|b)&&!B[4].length&&B[9]==1?O=O[Xo(B[0])].apply(O,B[3]):O=v.length==1&&Lc(v)?O[N]():O.thru(v)}return function(){var Z=arguments,Q=Z[0];if(O&&Z.length==1&&Re(Q))return O.plant(Q).value();for(var ne=0,ce=a?i[ne].apply(this,Z):Q;++ne<a;)ce=i[ne].call(this,ce);return ce}})}function Vo(r,i,a,f,g,v,O,N,B,Z){var Q=i&c,ne=i&K,ce=i&se,_e=i&(M|x),Ee=i&V,je=ce?t:xs(r);function Se(){for(var Ve=arguments.length,Qe=z(Ve),Ir=Ve;Ir--;)Qe[Ir]=arguments[Ir];if(_e)var dr=Ui(Se),Ar=e2(Qe,dr);if(f&&(Qe=lp(Qe,f,g,_e)),v&&(Qe=dp(Qe,v,O,_e)),Ve-=Ar,_e&&Ve<Z){var Lt=Pn(Qe,dr);return mp(r,i,Vo,Se.placeholder,a,Qe,Lt,N,B,Z-Ve)}var Vr=ne?a:this,bn=ce?Vr[r]:r;return Ve=Qe.length,N?Qe=uS(Qe,N):Ee&&Ve>1&&Qe.reverse(),Q&&B<Ve&&(Qe.length=B),this&&this!==Ze&&this instanceof Se&&(bn=je||xs(bn)),bn.apply(Vr,Qe)}return Se}function bp(r,i){return function(a,f){return _6(a,r,i(f),{})}}function Yo(r,i){return function(a,f){var g;if(a===t&&f===t)return i;if(a!==t&&(g=a),f!==t){if(g===t)return f;typeof a=="string"||typeof f=="string"?(a=xr(a),f=xr(f)):(a=ip(a),f=ip(f)),g=r(a,f)}return g}}function Oc(r){return gn(function(i){return i=bt(i,Dr(be())),Ke(function(a){var f=this;return r(i,function(g){return Yt(g,f,a)})})})}function ko(r,i){i=i===t?" ":xr(i);var a=i.length;if(a<2)return a?bc(i,r):i;var f=bc(i,Fo(r/Ai(i)));return Ii(i)?Ln(Kr(f),0,r).join(""):f.slice(0,r)}function z6(r,i,a,f){var g=i&K,v=xs(r);function O(){for(var N=-1,B=arguments.length,Z=-1,Q=f.length,ne=z(Q+B),ce=this&&this!==Ze&&this instanceof O?v:r;++Z<Q;)ne[Z]=f[Z];for(;B--;)ne[Z++]=arguments[++N];return Yt(ce,g?a:this,ne)}return O}function wp(r){return function(i,a,f){return f&&typeof f!="number"&&lr(i,a,f)&&(a=f=t),i=vn(i),a===t?(a=i,i=0):a=vn(a),f=f===t?i<a?1:-1:vn(f),A6(i,a,f,r)}}function Jo(r){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Hr(i),a=Hr(a)),r(i,a)}}function mp(r,i,a,f,g,v,O,N,B,Z){var Q=i&M,ne=Q?O:t,ce=Q?t:O,_e=Q?v:t,Ee=Q?t:v;i|=Q?P:m,i&=~(Q?m:P),i&L||(i&=~(K|se));var je=[r,i,g,_e,ne,Ee,ce,N,B,Z],Se=a.apply(t,je);return Lc(r)&&Np(Se,je),Se.placeholder=f,Lp(Se,r,i)}function Ic(r){var i=Gt[r];return function(a,f){if(a=Hr(a),f=f==null?0:tr(Me(f),292),f&&Ld(a)){var g=(nt(a)+"e").split("e"),v=i(g[0]+"e"+(+g[1]+f));return g=(nt(v)+"e").split("e"),+(g[0]+"e"+(+g[1]-f))}return i(a)}}var K6=Ti&&1/xo(new Ti([,-0]))[1]==X?function(r){return new Ti(r)}:kc;function Ep(r){return function(i){var a=rr(i);return a==xe?nc(i):a==Oe?a2(i):Q3(i,r(i))}}function pn(r,i,a,f,g,v,O,N){var B=i&se;if(!B&&typeof r!="function")throw new Fr(h);var Z=f?f.length:0;if(Z||(i&=~(P|m),f=g=t),O=O===t?O:Wt(Me(O),0),N=N===t?N:Me(N),Z-=g?g.length:0,i&m){var Q=f,ne=g;f=g=t}var ce=B?t:Cc(r),_e=[r,i,a,f,g,Q,ne,v,O,N];if(ce&&sS(_e,ce),r=_e[0],i=_e[1],a=_e[2],f=_e[3],g=_e[4],N=_e[9]=_e[9]===t?B?0:r.length:Wt(_e[9]-Z,0),!N&&i&(M|x)&&(i&=~(M|x)),!i||i==K)var Ee=j6(r,i,a);else i==M||i==x?Ee=q6(r,i,N):(i==P||i==(K|P))&&!g.length?Ee=z6(r,i,a,f):Ee=Vo.apply(t,_e);var je=ce?rp:Np;return Lp(je(Ee,_e),r,i)}function Sp(r,i,a,f){return r===t||Wr(r,Ci[a])&&!it.call(f,a)?i:r}function Dp(r,i,a,f,g,v){return Et(r)&&Et(i)&&(v.set(i,r),zo(r,i,t,Dp,v),v.delete(i)),r}function G6(r){return As(r)?t:r}function xp(r,i,a,f,g,v){var O=a&R,N=r.length,B=i.length;if(N!=B&&!(O&&B>N))return!1;var Z=v.get(r),Q=v.get(i);if(Z&&Q)return Z==i&&Q==r;var ne=-1,ce=!0,_e=a&q?new ni:t;for(v.set(r,i),v.set(i,r);++ne<N;){var Ee=r[ne],je=i[ne];if(f)var Se=O?f(je,Ee,ne,i,r,v):f(Ee,je,ne,r,i,v);if(Se!==t){if(Se)continue;ce=!1;break}if(_e){if(!Xu(i,function(Ve,Qe){if(!ps(_e,Qe)&&(Ee===Ve||g(Ee,Ve,a,f,v)))return _e.push(Qe)})){ce=!1;break}}else if(!(Ee===je||g(Ee,je,a,f,v))){ce=!1;break}}return v.delete(r),v.delete(i),ce}function W6(r,i,a,f,g,v,O){switch(a){case Pe:if(r.byteLength!=i.byteLength||r.byteOffset!=i.byteOffset)return!1;r=r.buffer,i=i.buffer;case De:return!(r.byteLength!=i.byteLength||!v(new To(r),new To(i)));case H:case F:case qe:return Wr(+r,+i);case A:return r.name==i.name&&r.message==i.message;case Be:case Le:return r==i+"";case xe:var N=nc;case Oe:var B=f&R;if(N||(N=xo),r.size!=i.size&&!B)return!1;var Z=O.get(r);if(Z)return Z==i;f|=q,O.set(r,i);var Q=xp(N(r),N(i),f,g,v,O);return O.delete(r),Q;case Fe:if(bs)return bs.call(r)==bs.call(i)}return!1}function V6(r,i,a,f,g,v){var O=a&R,N=Ac(r),B=N.length,Z=Ac(i),Q=Z.length;if(B!=Q&&!O)return!1;for(var ne=B;ne--;){var ce=N[ne];if(!(O?ce in i:it.call(i,ce)))return!1}var _e=v.get(r),Ee=v.get(i);if(_e&&Ee)return _e==i&&Ee==r;var je=!0;v.set(r,i),v.set(i,r);for(var Se=O;++ne<B;){ce=N[ne];var Ve=r[ce],Qe=i[ce];if(f)var Ir=O?f(Qe,Ve,ce,i,r,v):f(Ve,Qe,ce,r,i,v);if(!(Ir===t?Ve===Qe||g(Ve,Qe,a,f,v):Ir)){je=!1;break}Se||(Se=ce=="constructor")}if(je&&!Se){var dr=r.constructor,Ar=i.constructor;dr!=Ar&&"constructor"in r&&"constructor"in i&&!(typeof dr=="function"&&dr instanceof dr&&typeof Ar=="function"&&Ar instanceof Ar)&&(je=!1)}return v.delete(r),v.delete(i),je}function gn(r){return Uc(Tp(r,t,Hp),r+"")}function Ac(r){return Gd(r,kt,Rc)}function Pc(r){return Gd(r,wr,Op)}var Cc=$o?function(r){return $o.get(r)}:kc;function Xo(r){for(var i=r.name+"",a=Ri[i],f=it.call(Ri,i)?a.length:0;f--;){var g=a[f],v=g.func;if(v==null||v==r)return g.name}return i}function Ui(r){var i=it.call(y,"placeholder")?y:r;return i.placeholder}function be(){var r=y.iteratee||Vc;return r=r===Vc?Yd:r,arguments.length?r(arguments[0],arguments[1]):r}function Zo(r,i){var a=r.__data__;return tS(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Tc(r){for(var i=kt(r),a=i.length;a--;){var f=i[a],g=r[f];i[a]=[f,g,Pp(g)]}return i}function oi(r,i){var a=i2(r,i);return Vd(a)?a:t}function Y6(r){var i=it.call(r,ti),a=r[ti];try{r[ti]=t;var f=!0}catch{}var g=Po.call(r);return f&&(i?r[ti]=a:delete r[ti]),g}var Rc=sc?function(r){return r==null?[]:(r=ft(r),In(sc(r),function(i){return Rd.call(r,i)}))}:Jc,Op=sc?function(r){for(var i=[];r;)An(i,Rc(r)),r=Ro(r);return i}:Jc,rr=hr;(oc&&rr(new oc(new ArrayBuffer(1)))!=Pe||_s&&rr(new _s)!=xe||ac&&rr(ac.resolve())!=gt||Ti&&rr(new Ti)!=Oe||ys&&rr(new ys)!=Ae)&&(rr=function(r){var i=hr(r),a=i==$e?r.constructor:t,f=a?ai(a):"";if(f)switch(f){case C2:return Pe;case T2:return xe;case R2:return gt;case N2:return Oe;case L2:return Ae}return i});function k6(r,i,a){for(var f=-1,g=a.length;++f<g;){var v=a[f],O=v.size;switch(v.type){case"drop":r+=O;break;case"dropRight":i-=O;break;case"take":i=tr(i,r+O);break;case"takeRight":r=Wt(r,i-O);break}}return{start:r,end:i}}function J6(r){var i=r.match(lt);return i?i[1].split(jt):[]}function Ip(r,i,a){i=Nn(i,r);for(var f=-1,g=i.length,v=!1;++f<g;){var O=nn(i[f]);if(!(v=r!=null&&a(r,O)))break;r=r[O]}return v||++f!=g?v:(g=r==null?0:r.length,!!g&&sa(g)&&_n(O,g)&&(Re(r)||ui(r)))}function X6(r){var i=r.length,a=new r.constructor(i);return i&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Ap(r){return typeof r.constructor=="function"&&!Os(r)?Ni(Ro(r)):{}}function Z6(r,i,a){var f=r.constructor;switch(i){case De:return xc(r);case H:case F:return new f(+r);case Pe:return F6(r,a);case ze:case Ie:case We:case Ye:case et:case tt:case Xe:case ur:case _r:return fp(r,a);case xe:return new f;case qe:case Le:return new f(r);case Be:return U6(r);case Oe:return new f;case Fe:return $6(r)}}function Q6(r,i){var a=i.length;if(!a)return r;var f=a-1;return i[f]=(a>1?"& ":"")+i[f],i=i.join(a>2?", ":" "),r.replace(At,`{
/* [wrapped with `+i+`] */
`)}function eS(r){return Re(r)||ui(r)||!!(Nd&&r&&r[Nd])}function _n(r,i){var a=typeof r;return i=i??G,!!i&&(a=="number"||a!="symbol"&&Fu.test(r))&&r>-1&&r%1==0&&r<i}function lr(r,i,a){if(!Et(a))return!1;var f=typeof i;return(f=="number"?br(a)&&_n(i,a.length):f=="string"&&i in a)?Wr(a[i],r):!1}function Nc(r,i){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Or(r)?!0:Mt.test(r)||!vt.test(r)||i!=null&&r in ft(i)}function tS(r){var i=typeof r;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?r!=="__proto__":r===null}function Lc(r){var i=Xo(r),a=y[i];if(typeof a!="function"||!(i in ke.prototype))return!1;if(r===a)return!0;var f=Cc(a);return!!f&&r===f[0]}function rS(r){return!!Pd&&Pd in r}var nS=Io?yn:Xc;function Os(r){var i=r&&r.constructor,a=typeof i=="function"&&i.prototype||Ci;return r===a}function Pp(r){return r===r&&!Et(r)}function Cp(r,i){return function(a){return a==null?!1:a[r]===i&&(i!==t||r in ft(a))}}function iS(r){var i=na(r,function(f){return a.size===p&&a.clear(),f}),a=i.cache;return i}function sS(r,i){var a=r[1],f=i[1],g=a|f,v=g<(K|se|c),O=f==c&&a==M||f==c&&a==b&&r[7].length<=i[8]||f==(c|b)&&i[7].length<=i[8]&&a==M;if(!(v||O))return r;f&K&&(r[2]=i[2],g|=a&K?0:L);var N=i[3];if(N){var B=r[3];r[3]=B?lp(B,N,i[4]):N,r[4]=B?Pn(r[3],E):i[4]}return N=i[5],N&&(B=r[5],r[5]=B?dp(B,N,i[6]):N,r[6]=B?Pn(r[5],E):i[6]),N=i[7],N&&(r[7]=N),f&c&&(r[8]=r[8]==null?i[8]:tr(r[8],i[8])),r[9]==null&&(r[9]=i[9]),r[0]=i[0],r[1]=g,r}function oS(r){var i=[];if(r!=null)for(var a in ft(r))i.push(a);return i}function aS(r){return Po.call(r)}function Tp(r,i,a){return i=Wt(i===t?r.length-1:i,0),function(){for(var f=arguments,g=-1,v=Wt(f.length-i,0),O=z(v);++g<v;)O[g]=f[i+g];g=-1;for(var N=z(i+1);++g<i;)N[g]=f[g];return N[i]=a(O),Yt(r,this,N)}}function Rp(r,i){return i.length<2?r:si(r,Mr(i,0,-1))}function uS(r,i){for(var a=r.length,f=tr(i.length,a),g=vr(r);f--;){var v=i[f];r[f]=_n(v,a)?g[v]:t}return r}function Fc(r,i){if(!(i==="constructor"&&typeof r[i]=="function")&&i!="__proto__")return r[i]}var Np=Fp(rp),Is=S2||function(r,i){return Ze.setTimeout(r,i)},Uc=Fp(T6);function Lp(r,i,a){var f=i+"";return Uc(r,Q6(f,cS(J6(f),a)))}function Fp(r){var i=0,a=0;return function(){var f=I2(),g=de-(f-a);if(a=f,g>0){if(++i>=ue)return arguments[0]}else i=0;return r.apply(t,arguments)}}function Qo(r,i){var a=-1,f=r.length,g=f-1;for(i=i===t?f:i;++a<i;){var v=vc(a,g),O=r[v];r[v]=r[a],r[a]=O}return r.length=i,r}var Up=iS(function(r){var i=[];return r.charCodeAt(0)===46&&i.push(""),r.replace(Bt,function(a,f,g,v){i.push(g?v.replace(Pu,"$1"):f||a)}),i});function nn(r){if(typeof r=="string"||Or(r))return r;var i=r+"";return i=="0"&&1/r==-X?"-0":i}function ai(r){if(r!=null){try{return Ao.call(r)}catch{}try{return r+""}catch{}}return""}function cS(r,i){return Lr(me,function(a){var f="_."+a[0];i&a[1]&&!So(r,f)&&r.push(f)}),r.sort()}function $p(r){if(r instanceof ke)return r.clone();var i=new Ur(r.__wrapped__,r.__chain__);return i.__actions__=vr(r.__actions__),i.__index__=r.__index__,i.__values__=r.__values__,i}function fS(r,i,a){(a?lr(r,i,a):i===t)?i=1:i=Wt(Me(i),0);var f=r==null?0:r.length;if(!f||i<1)return[];for(var g=0,v=0,O=z(Fo(f/i));g<f;)O[v++]=Mr(r,g,g+=i);return O}function hS(r){for(var i=-1,a=r==null?0:r.length,f=0,g=[];++i<a;){var v=r[i];v&&(g[f++]=v)}return g}function lS(){var r=arguments.length;if(!r)return[];for(var i=z(r-1),a=arguments[0],f=r;f--;)i[f-1]=arguments[f];return An(Re(a)?vr(a):[a],Zt(i,1))}var dS=Ke(function(r,i){return Nt(r)?ms(r,Zt(i,1,Nt,!0)):[]}),pS=Ke(function(r,i){var a=Br(i);return Nt(a)&&(a=t),Nt(r)?ms(r,Zt(i,1,Nt,!0),be(a,2)):[]}),gS=Ke(function(r,i){var a=Br(i);return Nt(a)&&(a=t),Nt(r)?ms(r,Zt(i,1,Nt,!0),t,a):[]});function _S(r,i,a){var f=r==null?0:r.length;return f?(i=a||i===t?1:Me(i),Mr(r,i<0?0:i,f)):[]}function yS(r,i,a){var f=r==null?0:r.length;return f?(i=a||i===t?1:Me(i),i=f-i,Mr(r,0,i<0?0:i)):[]}function vS(r,i){return r&&r.length?Go(r,be(i,3),!0,!0):[]}function bS(r,i){return r&&r.length?Go(r,be(i,3),!0):[]}function wS(r,i,a,f){var g=r==null?0:r.length;return g?(a&&typeof a!="number"&&lr(r,i,a)&&(a=0,f=g),l6(r,i,a,f)):[]}function Mp(r,i,a){var f=r==null?0:r.length;if(!f)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(f+g,0)),Do(r,be(i,3),g)}function Bp(r,i,a){var f=r==null?0:r.length;if(!f)return-1;var g=f-1;return a!==t&&(g=Me(a),g=a<0?Wt(f+g,0):tr(g,f-1)),Do(r,be(i,3),g,!0)}function Hp(r){var i=r==null?0:r.length;return i?Zt(r,1):[]}function mS(r){var i=r==null?0:r.length;return i?Zt(r,X):[]}function ES(r,i){var a=r==null?0:r.length;return a?(i=i===t?1:Me(i),Zt(r,i)):[]}function SS(r){for(var i=-1,a=r==null?0:r.length,f={};++i<a;){var g=r[i];f[g[0]]=g[1]}return f}function jp(r){return r&&r.length?r[0]:t}function DS(r,i,a){var f=r==null?0:r.length;if(!f)return-1;var g=a==null?0:Me(a);return g<0&&(g=Wt(f+g,0)),Oi(r,i,g)}function xS(r){var i=r==null?0:r.length;return i?Mr(r,0,-1):[]}var OS=Ke(function(r){var i=bt(r,Sc);return i.length&&i[0]===r[0]?dc(i):[]}),IS=Ke(function(r){var i=Br(r),a=bt(r,Sc);return i===Br(a)?i=t:a.pop(),a.length&&a[0]===r[0]?dc(a,be(i,2)):[]}),AS=Ke(function(r){var i=Br(r),a=bt(r,Sc);return i=typeof i=="function"?i:t,i&&a.pop(),a.length&&a[0]===r[0]?dc(a,t,i):[]});function PS(r,i){return r==null?"":x2.call(r,i)}function Br(r){var i=r==null?0:r.length;return i?r[i-1]:t}function CS(r,i,a){var f=r==null?0:r.length;if(!f)return-1;var g=f;return a!==t&&(g=Me(a),g=g<0?Wt(f+g,0):tr(g,f-1)),i===i?c2(r,i,g):Do(r,md,g,!0)}function TS(r,i){return r&&r.length?Zd(r,Me(i)):t}var RS=Ke(qp);function qp(r,i){return r&&r.length&&i&&i.length?yc(r,i):r}function NS(r,i,a){return r&&r.length&&i&&i.length?yc(r,i,be(a,2)):r}function LS(r,i,a){return r&&r.length&&i&&i.length?yc(r,i,t,a):r}var FS=gn(function(r,i){var a=r==null?0:r.length,f=cc(r,i);return tp(r,bt(i,function(g){return _n(g,a)?+g:g}).sort(hp)),f});function US(r,i){var a=[];if(!(r&&r.length))return a;var f=-1,g=[],v=r.length;for(i=be(i,3);++f<v;){var O=r[f];i(O,f,r)&&(a.push(O),g.push(f))}return tp(r,g),a}function $c(r){return r==null?r:P2.call(r)}function $S(r,i,a){var f=r==null?0:r.length;return f?(a&&typeof a!="number"&&lr(r,i,a)?(i=0,a=f):(i=i==null?0:Me(i),a=a===t?f:Me(a)),Mr(r,i,a)):[]}function MS(r,i){return Ko(r,i)}function BS(r,i,a){return wc(r,i,be(a,2))}function HS(r,i){var a=r==null?0:r.length;if(a){var f=Ko(r,i);if(f<a&&Wr(r[f],i))return f}return-1}function jS(r,i){return Ko(r,i,!0)}function qS(r,i,a){return wc(r,i,be(a,2),!0)}function zS(r,i){var a=r==null?0:r.length;if(a){var f=Ko(r,i,!0)-1;if(Wr(r[f],i))return f}return-1}function KS(r){return r&&r.length?np(r):[]}function GS(r,i){return r&&r.length?np(r,be(i,2)):[]}function WS(r){var i=r==null?0:r.length;return i?Mr(r,1,i):[]}function VS(r,i,a){return r&&r.length?(i=a||i===t?1:Me(i),Mr(r,0,i<0?0:i)):[]}function YS(r,i,a){var f=r==null?0:r.length;return f?(i=a||i===t?1:Me(i),i=f-i,Mr(r,i<0?0:i,f)):[]}function kS(r,i){return r&&r.length?Go(r,be(i,3),!1,!0):[]}function JS(r,i){return r&&r.length?Go(r,be(i,3)):[]}var XS=Ke(function(r){return Rn(Zt(r,1,Nt,!0))}),ZS=Ke(function(r){var i=Br(r);return Nt(i)&&(i=t),Rn(Zt(r,1,Nt,!0),be(i,2))}),QS=Ke(function(r){var i=Br(r);return i=typeof i=="function"?i:t,Rn(Zt(r,1,Nt,!0),t,i)});function eD(r){return r&&r.length?Rn(r):[]}function tD(r,i){return r&&r.length?Rn(r,be(i,2)):[]}function rD(r,i){return i=typeof i=="function"?i:t,r&&r.length?Rn(r,t,i):[]}function Mc(r){if(!(r&&r.length))return[];var i=0;return r=In(r,function(a){if(Nt(a))return i=Wt(a.length,i),!0}),tc(i,function(a){return bt(r,Zu(a))})}function zp(r,i){if(!(r&&r.length))return[];var a=Mc(r);return i==null?a:bt(a,function(f){return Yt(i,t,f)})}var nD=Ke(function(r,i){return Nt(r)?ms(r,i):[]}),iD=Ke(function(r){return Ec(In(r,Nt))}),sD=Ke(function(r){var i=Br(r);return Nt(i)&&(i=t),Ec(In(r,Nt),be(i,2))}),oD=Ke(function(r){var i=Br(r);return i=typeof i=="function"?i:t,Ec(In(r,Nt),t,i)}),aD=Ke(Mc);function uD(r,i){return ap(r||[],i||[],ws)}function cD(r,i){return ap(r||[],i||[],Ds)}var fD=Ke(function(r){var i=r.length,a=i>1?r[i-1]:t;return a=typeof a=="function"?(r.pop(),a):t,zp(r,a)});function Kp(r){var i=y(r);return i.__chain__=!0,i}function hD(r,i){return i(r),r}function ea(r,i){return i(r)}var lD=gn(function(r){var i=r.length,a=i?r[0]:0,f=this.__wrapped__,g=function(v){return cc(v,r)};return i>1||this.__actions__.length||!(f instanceof ke)||!_n(a)?this.thru(g):(f=f.slice(a,+a+(i?1:0)),f.__actions__.push({func:ea,args:[g],thisArg:t}),new Ur(f,this.__chain__).thru(function(v){return i&&!v.length&&v.push(t),v}))});function dD(){return Kp(this)}function pD(){return new Ur(this.value(),this.__chain__)}function gD(){this.__values__===t&&(this.__values__=ig(this.value()));var r=this.__index__>=this.__values__.length,i=r?t:this.__values__[this.__index__++];return{done:r,value:i}}function _D(){return this}function yD(r){for(var i,a=this;a instanceof Bo;){var f=$p(a);f.__index__=0,f.__values__=t,i?g.__wrapped__=f:i=f;var g=f;a=a.__wrapped__}return g.__wrapped__=r,i}function vD(){var r=this.__wrapped__;if(r instanceof ke){var i=r;return this.__actions__.length&&(i=new ke(this)),i=i.reverse(),i.__actions__.push({func:ea,args:[$c],thisArg:t}),new Ur(i,this.__chain__)}return this.thru($c)}function bD(){return op(this.__wrapped__,this.__actions__)}var wD=Wo(function(r,i,a){it.call(r,a)?++r[a]:dn(r,a,1)});function mD(r,i,a){var f=Re(r)?bd:h6;return a&&lr(r,i,a)&&(i=t),f(r,be(i,3))}function ED(r,i){var a=Re(r)?In:zd;return a(r,be(i,3))}var SD=yp(Mp),DD=yp(Bp);function xD(r,i){return Zt(ta(r,i),1)}function OD(r,i){return Zt(ta(r,i),X)}function ID(r,i,a){return a=a===t?1:Me(a),Zt(ta(r,i),a)}function Gp(r,i){var a=Re(r)?Lr:Tn;return a(r,be(i,3))}function Wp(r,i){var a=Re(r)?W3:qd;return a(r,be(i,3))}var AD=Wo(function(r,i,a){it.call(r,a)?r[a].push(i):dn(r,a,[i])});function PD(r,i,a,f){r=br(r)?r:Mi(r),a=a&&!f?Me(a):0;var g=r.length;return a<0&&(a=Wt(g+a,0)),oa(r)?a<=g&&r.indexOf(i,a)>-1:!!g&&Oi(r,i,a)>-1}var CD=Ke(function(r,i,a){var f=-1,g=typeof i=="function",v=br(r)?z(r.length):[];return Tn(r,function(O){v[++f]=g?Yt(i,O,a):Es(O,i,a)}),v}),TD=Wo(function(r,i,a){dn(r,a,i)});function ta(r,i){var a=Re(r)?bt:kd;return a(r,be(i,3))}function RD(r,i,a,f){return r==null?[]:(Re(i)||(i=i==null?[]:[i]),a=f?t:a,Re(a)||(a=a==null?[]:[a]),Qd(r,i,a))}var ND=Wo(function(r,i,a){r[a?0:1].push(i)},function(){return[[],[]]});function LD(r,i,a){var f=Re(r)?Ju:Sd,g=arguments.length<3;return f(r,be(i,4),a,g,Tn)}function FD(r,i,a){var f=Re(r)?V3:Sd,g=arguments.length<3;return f(r,be(i,4),a,g,qd)}function UD(r,i){var a=Re(r)?In:zd;return a(r,ia(be(i,3)))}function $D(r){var i=Re(r)?Md:P6;return i(r)}function MD(r,i,a){(a?lr(r,i,a):i===t)?i=1:i=Me(i);var f=Re(r)?o6:C6;return f(r,i)}function BD(r){var i=Re(r)?a6:R6;return i(r)}function HD(r){if(r==null)return 0;if(br(r))return oa(r)?Ai(r):r.length;var i=rr(r);return i==xe||i==Oe?r.size:gc(r).length}function jD(r,i,a){var f=Re(r)?Xu:N6;return a&&lr(r,i,a)&&(i=t),f(r,be(i,3))}var qD=Ke(function(r,i){if(r==null)return[];var a=i.length;return a>1&&lr(r,i[0],i[1])?i=[]:a>2&&lr(i[0],i[1],i[2])&&(i=[i[0]]),Qd(r,Zt(i,1),[])}),ra=E2||function(){return Ze.Date.now()};function zD(r,i){if(typeof i!="function")throw new Fr(h);return r=Me(r),function(){if(--r<1)return i.apply(this,arguments)}}function Vp(r,i,a){return i=a?t:i,i=r&&i==null?r.length:i,pn(r,c,t,t,t,t,i)}function Yp(r,i){var a;if(typeof i!="function")throw new Fr(h);return r=Me(r),function(){return--r>0&&(a=i.apply(this,arguments)),r<=1&&(i=t),a}}var Bc=Ke(function(r,i,a){var f=K;if(a.length){var g=Pn(a,Ui(Bc));f|=P}return pn(r,f,i,a,g)}),kp=Ke(function(r,i,a){var f=K|se;if(a.length){var g=Pn(a,Ui(kp));f|=P}return pn(i,f,r,a,g)});function Jp(r,i,a){i=a?t:i;var f=pn(r,M,t,t,t,t,t,i);return f.placeholder=Jp.placeholder,f}function Xp(r,i,a){i=a?t:i;var f=pn(r,x,t,t,t,t,t,i);return f.placeholder=Xp.placeholder,f}function Zp(r,i,a){var f,g,v,O,N,B,Z=0,Q=!1,ne=!1,ce=!0;if(typeof r!="function")throw new Fr(h);i=Hr(i)||0,Et(a)&&(Q=!!a.leading,ne="maxWait"in a,v=ne?Wt(Hr(a.maxWait)||0,i):v,ce="trailing"in a?!!a.trailing:ce);function _e(Lt){var Vr=f,bn=g;return f=g=t,Z=Lt,O=r.apply(bn,Vr),O}function Ee(Lt){return Z=Lt,N=Is(Ve,i),Q?_e(Lt):O}function je(Lt){var Vr=Lt-B,bn=Lt-Z,yg=i-Vr;return ne?tr(yg,v-bn):yg}function Se(Lt){var Vr=Lt-B,bn=Lt-Z;return B===t||Vr>=i||Vr<0||ne&&bn>=v}function Ve(){var Lt=ra();if(Se(Lt))return Qe(Lt);N=Is(Ve,je(Lt))}function Qe(Lt){return N=t,ce&&f?_e(Lt):(f=g=t,O)}function Ir(){N!==t&&up(N),Z=0,f=B=g=N=t}function dr(){return N===t?O:Qe(ra())}function Ar(){var Lt=ra(),Vr=Se(Lt);if(f=arguments,g=this,B=Lt,Vr){if(N===t)return Ee(B);if(ne)return up(N),N=Is(Ve,i),_e(B)}return N===t&&(N=Is(Ve,i)),O}return Ar.cancel=Ir,Ar.flush=dr,Ar}var KD=Ke(function(r,i){return jd(r,1,i)}),GD=Ke(function(r,i,a){return jd(r,Hr(i)||0,a)});function WD(r){return pn(r,V)}function na(r,i){if(typeof r!="function"||i!=null&&typeof i!="function")throw new Fr(h);var a=function(){var f=arguments,g=i?i.apply(this,f):f[0],v=a.cache;if(v.has(g))return v.get(g);var O=r.apply(this,f);return a.cache=v.set(g,O)||v,O};return a.cache=new(na.Cache||ln),a}na.Cache=ln;function ia(r){if(typeof r!="function")throw new Fr(h);return function(){var i=arguments;switch(i.length){case 0:return!r.call(this);case 1:return!r.call(this,i[0]);case 2:return!r.call(this,i[0],i[1]);case 3:return!r.call(this,i[0],i[1],i[2])}return!r.apply(this,i)}}function VD(r){return Yp(2,r)}var YD=L6(function(r,i){i=i.length==1&&Re(i[0])?bt(i[0],Dr(be())):bt(Zt(i,1),Dr(be()));var a=i.length;return Ke(function(f){for(var g=-1,v=tr(f.length,a);++g<v;)f[g]=i[g].call(this,f[g]);return Yt(r,this,f)})}),Hc=Ke(function(r,i){var a=Pn(i,Ui(Hc));return pn(r,P,t,i,a)}),Qp=Ke(function(r,i){var a=Pn(i,Ui(Qp));return pn(r,m,t,i,a)}),kD=gn(function(r,i){return pn(r,b,t,t,t,i)});function JD(r,i){if(typeof r!="function")throw new Fr(h);return i=i===t?i:Me(i),Ke(r,i)}function XD(r,i){if(typeof r!="function")throw new Fr(h);return i=i==null?0:Wt(Me(i),0),Ke(function(a){var f=a[i],g=Ln(a,0,i);return f&&An(g,f),Yt(r,this,g)})}function ZD(r,i,a){var f=!0,g=!0;if(typeof r!="function")throw new Fr(h);return Et(a)&&(f="leading"in a?!!a.leading:f,g="trailing"in a?!!a.trailing:g),Zp(r,i,{leading:f,maxWait:i,trailing:g})}function QD(r){return Vp(r,1)}function ex(r,i){return Hc(Dc(i),r)}function tx(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function rx(r){return $r(r,T)}function nx(r,i){return i=typeof i=="function"?i:t,$r(r,T,i)}function ix(r){return $r(r,C|T)}function sx(r,i){return i=typeof i=="function"?i:t,$r(r,C|T,i)}function ox(r,i){return i==null||Hd(r,i,kt(i))}function Wr(r,i){return r===i||r!==r&&i!==i}var ax=Jo(lc),ux=Jo(function(r,i){return r>=i}),ui=Wd(function(){return arguments}())?Wd:function(r){return Pt(r)&&it.call(r,"callee")&&!Rd.call(r,"callee")},Re=z.isArray,cx=fr?Dr(fr):y6;function br(r){return r!=null&&sa(r.length)&&!yn(r)}function Nt(r){return Pt(r)&&br(r)}function fx(r){return r===!0||r===!1||Pt(r)&&hr(r)==H}var Fn=D2||Xc,hx=zr?Dr(zr):v6;function lx(r){return Pt(r)&&r.nodeType===1&&!As(r)}function dx(r){if(r==null)return!0;if(br(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||Fn(r)||$i(r)||ui(r)))return!r.length;var i=rr(r);if(i==xe||i==Oe)return!r.size;if(Os(r))return!gc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function px(r,i){return Ss(r,i)}function gx(r,i,a){a=typeof a=="function"?a:t;var f=a?a(r,i):t;return f===t?Ss(r,i,t,a):!!f}function jc(r){if(!Pt(r))return!1;var i=hr(r);return i==A||i==d||typeof r.message=="string"&&typeof r.name=="string"&&!As(r)}function _x(r){return typeof r=="number"&&Ld(r)}function yn(r){if(!Et(r))return!1;var i=hr(r);return i==ae||i==le||i==j||i==_t}function eg(r){return typeof r=="number"&&r==Me(r)}function sa(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=G}function Et(r){var i=typeof r;return r!=null&&(i=="object"||i=="function")}function Pt(r){return r!=null&&typeof r=="object"}var tg=Nr?Dr(Nr):w6;function yx(r,i){return r===i||pc(r,i,Tc(i))}function vx(r,i,a){return a=typeof a=="function"?a:t,pc(r,i,Tc(i),a)}function bx(r){return rg(r)&&r!=+r}function wx(r){if(nS(r))throw new Ce(u);return Vd(r)}function mx(r){return r===null}function Ex(r){return r==null}function rg(r){return typeof r=="number"||Pt(r)&&hr(r)==qe}function As(r){if(!Pt(r)||hr(r)!=$e)return!1;var i=Ro(r);if(i===null)return!0;var a=it.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ao.call(a)==v2}var qc=en?Dr(en):m6;function Sx(r){return eg(r)&&r>=-G&&r<=G}var ng=ds?Dr(ds):E6;function oa(r){return typeof r=="string"||!Re(r)&&Pt(r)&&hr(r)==Le}function Or(r){return typeof r=="symbol"||Pt(r)&&hr(r)==Fe}var $i=ei?Dr(ei):S6;function Dx(r){return r===t}function xx(r){return Pt(r)&&rr(r)==Ae}function Ox(r){return Pt(r)&&hr(r)==Ue}var Ix=Jo(_c),Ax=Jo(function(r,i){return r<=i});function ig(r){if(!r)return[];if(br(r))return oa(r)?Kr(r):vr(r);if(gs&&r[gs])return o2(r[gs]());var i=rr(r),a=i==xe?nc:i==Oe?xo:Mi;return a(r)}function vn(r){if(!r)return r===0?r:0;if(r=Hr(r),r===X||r===-X){var i=r<0?-1:1;return i*W}return r===r?r:0}function Me(r){var i=vn(r),a=i%1;return i===i?a?i-a:i:0}function sg(r){return r?ii(Me(r),0,re):0}function Hr(r){if(typeof r=="number")return r;if(Or(r))return J;if(Et(r)){var i=typeof r.valueOf=="function"?r.valueOf():r;r=Et(i)?i+"":i}if(typeof r!="string")return r===0?r:+r;r=Dd(r);var a=Ru.test(r);return a||Lu.test(r)?Te(r.slice(2),a?2:8):Tu.test(r)?J:+r}function og(r){return rn(r,wr(r))}function Px(r){return r?ii(Me(r),-G,G):r===0?r:0}function nt(r){return r==null?"":xr(r)}var Cx=Li(function(r,i){if(Os(i)||br(i)){rn(i,kt(i),r);return}for(var a in i)it.call(i,a)&&ws(r,a,i[a])}),ag=Li(function(r,i){rn(i,wr(i),r)}),aa=Li(function(r,i,a,f){rn(i,wr(i),r,f)}),Tx=Li(function(r,i,a,f){rn(i,kt(i),r,f)}),Rx=gn(cc);function Nx(r,i){var a=Ni(r);return i==null?a:Bd(a,i)}var Lx=Ke(function(r,i){r=ft(r);var a=-1,f=i.length,g=f>2?i[2]:t;for(g&&lr(i[0],i[1],g)&&(f=1);++a<f;)for(var v=i[a],O=wr(v),N=-1,B=O.length;++N<B;){var Z=O[N],Q=r[Z];(Q===t||Wr(Q,Ci[Z])&&!it.call(r,Z))&&(r[Z]=v[Z])}return r}),Fx=Ke(function(r){return r.push(t,Dp),Yt(ug,t,r)});function Ux(r,i){return wd(r,be(i,3),tn)}function $x(r,i){return wd(r,be(i,3),hc)}function Mx(r,i){return r==null?r:fc(r,be(i,3),wr)}function Bx(r,i){return r==null?r:Kd(r,be(i,3),wr)}function Hx(r,i){return r&&tn(r,be(i,3))}function jx(r,i){return r&&hc(r,be(i,3))}function qx(r){return r==null?[]:qo(r,kt(r))}function zx(r){return r==null?[]:qo(r,wr(r))}function zc(r,i,a){var f=r==null?t:si(r,i);return f===t?a:f}function Kx(r,i){return r!=null&&Ip(r,i,d6)}function Kc(r,i){return r!=null&&Ip(r,i,p6)}var Gx=bp(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=Po.call(i)),r[i]=a},Wc(mr)),Wx=bp(function(r,i,a){i!=null&&typeof i.toString!="function"&&(i=Po.call(i)),it.call(r,i)?r[i].push(a):r[i]=[a]},be),Vx=Ke(Es);function kt(r){return br(r)?$d(r):gc(r)}function wr(r){return br(r)?$d(r,!0):D6(r)}function Yx(r,i){var a={};return i=be(i,3),tn(r,function(f,g,v){dn(a,i(f,g,v),f)}),a}function kx(r,i){var a={};return i=be(i,3),tn(r,function(f,g,v){dn(a,g,i(f,g,v))}),a}var Jx=Li(function(r,i,a){zo(r,i,a)}),ug=Li(function(r,i,a,f){zo(r,i,a,f)}),Xx=gn(function(r,i){var a={};if(r==null)return a;var f=!1;i=bt(i,function(v){return v=Nn(v,r),f||(f=v.length>1),v}),rn(r,Pc(r),a),f&&(a=$r(a,C|D|T,G6));for(var g=i.length;g--;)mc(a,i[g]);return a});function Zx(r,i){return cg(r,ia(be(i)))}var Qx=gn(function(r,i){return r==null?{}:O6(r,i)});function cg(r,i){if(r==null)return{};var a=bt(Pc(r),function(f){return[f]});return i=be(i),ep(r,a,function(f,g){return i(f,g[0])})}function e5(r,i,a){i=Nn(i,r);var f=-1,g=i.length;for(g||(g=1,r=t);++f<g;){var v=r==null?t:r[nn(i[f])];v===t&&(f=g,v=a),r=yn(v)?v.call(r):v}return r}function t5(r,i,a){return r==null?r:Ds(r,i,a)}function r5(r,i,a,f){return f=typeof f=="function"?f:t,r==null?r:Ds(r,i,a,f)}var fg=Ep(kt),hg=Ep(wr);function n5(r,i,a){var f=Re(r),g=f||Fn(r)||$i(r);if(i=be(i,4),a==null){var v=r&&r.constructor;g?a=f?new v:[]:Et(r)?a=yn(v)?Ni(Ro(r)):{}:a={}}return(g?Lr:tn)(r,function(O,N,B){return i(a,O,N,B)}),a}function i5(r,i){return r==null?!0:mc(r,i)}function s5(r,i,a){return r==null?r:sp(r,i,Dc(a))}function o5(r,i,a,f){return f=typeof f=="function"?f:t,r==null?r:sp(r,i,Dc(a),f)}function Mi(r){return r==null?[]:rc(r,kt(r))}function a5(r){return r==null?[]:rc(r,wr(r))}function u5(r,i,a){return a===t&&(a=i,i=t),a!==t&&(a=Hr(a),a=a===a?a:0),i!==t&&(i=Hr(i),i=i===i?i:0),ii(Hr(r),i,a)}function c5(r,i,a){return i=vn(i),a===t?(a=i,i=0):a=vn(a),r=Hr(r),g6(r,i,a)}function f5(r,i,a){if(a&&typeof a!="boolean"&&lr(r,i,a)&&(i=a=t),a===t&&(typeof i=="boolean"?(a=i,i=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&i===t?(r=0,i=1):(r=vn(r),i===t?(i=r,r=0):i=vn(i)),r>i){var f=r;r=i,i=f}if(a||r%1||i%1){var g=Fd();return tr(r+g*(i-r+ut("1e-"+((g+"").length-1))),i)}return vc(r,i)}var h5=Fi(function(r,i,a){return i=i.toLowerCase(),r+(a?lg(i):i)});function lg(r){return Gc(nt(r).toLowerCase())}function dg(r){return r=nt(r),r&&r.replace(cn,t2).replace(Vu,"")}function l5(r,i,a){r=nt(r),i=xr(i);var f=r.length;a=a===t?f:ii(Me(a),0,f);var g=a;return a-=i.length,a>=0&&r.slice(a,g)==i}function d5(r){return r=nt(r),r&&yt.test(r)?r.replace(kn,r2):r}function p5(r){return r=nt(r),r&&Ht.test(r)?r.replace(Ot,"\\$&"):r}var g5=Fi(function(r,i,a){return r+(a?"-":"")+i.toLowerCase()}),_5=Fi(function(r,i,a){return r+(a?" ":"")+i.toLowerCase()}),y5=_p("toLowerCase");function v5(r,i,a){r=nt(r),i=Me(i);var f=i?Ai(r):0;if(!i||f>=i)return r;var g=(i-f)/2;return ko(Uo(g),a)+r+ko(Fo(g),a)}function b5(r,i,a){r=nt(r),i=Me(i);var f=i?Ai(r):0;return i&&f<i?r+ko(i-f,a):r}function w5(r,i,a){r=nt(r),i=Me(i);var f=i?Ai(r):0;return i&&f<i?ko(i-f,a)+r:r}function m5(r,i,a){return a||i==null?i=0:i&&(i=+i),A2(nt(r).replace(It,""),i||0)}function E5(r,i,a){return(a?lr(r,i,a):i===t)?i=1:i=Me(i),bc(nt(r),i)}function S5(){var r=arguments,i=nt(r[0]);return r.length<3?i:i.replace(r[1],r[2])}var D5=Fi(function(r,i,a){return r+(a?"_":"")+i.toLowerCase()});function x5(r,i,a){return a&&typeof a!="number"&&lr(r,i,a)&&(i=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof i=="string"||i!=null&&!qc(i))&&(i=xr(i),!i&&Ii(r))?Ln(Kr(r),0,a):r.split(i,a)):[]}var O5=Fi(function(r,i,a){return r+(a?" ":"")+Gc(i)});function I5(r,i,a){return r=nt(r),a=a==null?0:ii(Me(a),0,r.length),i=xr(i),r.slice(a,a+i.length)==i}function A5(r,i,a){var f=y.templateSettings;a&&lr(r,i,a)&&(i=t),r=nt(r),i=aa({},i,f,Sp);var g=aa({},i.imports,f.imports,Sp),v=kt(g),O=rc(g,v),N,B,Z=0,Q=i.interpolate||bi,ne="__p += '",ce=ic((i.escape||bi).source+"|"+Q.source+"|"+(Q===mt?Cu:bi).source+"|"+(i.evaluate||bi).source+"|$","g"),_e="//# sourceURL="+(it.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Yu+"]")+`
`;r.replace(ce,function(Se,Ve,Qe,Ir,dr,Ar){return Qe||(Qe=Ir),ne+=r.slice(Z,Ar).replace(Uu,n2),Ve&&(N=!0,ne+=`' +
__e(`+Ve+`) +
'`),dr&&(B=!0,ne+=`';
`+dr+`;
__p += '`),Qe&&(ne+=`' +
((__t = (`+Qe+`)) == null ? '' : __t) +
'`),Z=Ar+Se.length,Se}),ne+=`';
`;var Ee=it.call(i,"variable")&&i.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(Au.test(Ee))throw new Ce(l);ne=(B?ne.replace(Zr,""):ne).replace(cr,"$1").replace(un,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(B?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var je=gg(function(){return rt(v,_e+"return "+ne).apply(t,O)});if(je.source=ne,jc(je))throw je;return je}function P5(r){return nt(r).toLowerCase()}function C5(r){return nt(r).toUpperCase()}function T5(r,i,a){if(r=nt(r),r&&(a||i===t))return Dd(r);if(!r||!(i=xr(i)))return r;var f=Kr(r),g=Kr(i),v=xd(f,g),O=Od(f,g)+1;return Ln(f,v,O).join("")}function R5(r,i,a){if(r=nt(r),r&&(a||i===t))return r.slice(0,Ad(r)+1);if(!r||!(i=xr(i)))return r;var f=Kr(r),g=Od(f,Kr(i))+1;return Ln(f,0,g).join("")}function N5(r,i,a){if(r=nt(r),r&&(a||i===t))return r.replace(It,"");if(!r||!(i=xr(i)))return r;var f=Kr(r),g=xd(f,Kr(i));return Ln(f,g).join("")}function L5(r,i){var a=k,f=ie;if(Et(i)){var g="separator"in i?i.separator:g;a="length"in i?Me(i.length):a,f="omission"in i?xr(i.omission):f}r=nt(r);var v=r.length;if(Ii(r)){var O=Kr(r);v=O.length}if(a>=v)return r;var N=a-Ai(f);if(N<1)return f;var B=O?Ln(O,0,N).join(""):r.slice(0,N);if(g===t)return B+f;if(O&&(N+=B.length-N),qc(g)){if(r.slice(N).search(g)){var Z,Q=B;for(g.global||(g=ic(g.source,nt(Rr.exec(g))+"g")),g.lastIndex=0;Z=g.exec(Q);)var ne=Z.index;B=B.slice(0,ne===t?N:ne)}}else if(r.indexOf(xr(g),N)!=N){var ce=B.lastIndexOf(g);ce>-1&&(B=B.slice(0,ce))}return B+f}function F5(r){return r=nt(r),r&&St.test(r)?r.replace(xn,f2):r}var U5=Fi(function(r,i,a){return r+(a?" ":"")+i.toUpperCase()}),Gc=_p("toUpperCase");function pg(r,i,a){return r=nt(r),i=a?t:i,i===t?s2(r)?d2(r):J3(r):r.match(i)||[]}var gg=Ke(function(r,i){try{return Yt(r,t,i)}catch(a){return jc(a)?a:new Ce(a)}}),$5=gn(function(r,i){return Lr(i,function(a){a=nn(a),dn(r,a,Bc(r[a],r))}),r});function M5(r){var i=r==null?0:r.length,a=be();return r=i?bt(r,function(f){if(typeof f[1]!="function")throw new Fr(h);return[a(f[0]),f[1]]}):[],Ke(function(f){for(var g=-1;++g<i;){var v=r[g];if(Yt(v[0],this,f))return Yt(v[1],this,f)}})}function B5(r){return f6($r(r,C))}function Wc(r){return function(){return r}}function H5(r,i){return r==null||r!==r?i:r}var j5=vp(),q5=vp(!0);function mr(r){return r}function Vc(r){return Yd(typeof r=="function"?r:$r(r,C))}function z5(r){return Jd($r(r,C))}function K5(r,i){return Xd(r,$r(i,C))}var G5=Ke(function(r,i){return function(a){return Es(a,r,i)}}),W5=Ke(function(r,i){return function(a){return Es(r,a,i)}});function Yc(r,i,a){var f=kt(i),g=qo(i,f);a==null&&!(Et(i)&&(g.length||!f.length))&&(a=i,i=r,r=this,g=qo(i,kt(i)));var v=!(Et(a)&&"chain"in a)||!!a.chain,O=yn(r);return Lr(g,function(N){var B=i[N];r[N]=B,O&&(r.prototype[N]=function(){var Z=this.__chain__;if(v||Z){var Q=r(this.__wrapped__),ne=Q.__actions__=vr(this.__actions__);return ne.push({func:B,args:arguments,thisArg:r}),Q.__chain__=Z,Q}return B.apply(r,An([this.value()],arguments))})}),r}function V5(){return Ze._===this&&(Ze._=b2),this}function kc(){}function Y5(r){return r=Me(r),Ke(function(i){return Zd(i,r)})}var k5=Oc(bt),J5=Oc(bd),X5=Oc(Xu);function _g(r){return Nc(r)?Zu(nn(r)):I6(r)}function Z5(r){return function(i){return r==null?t:si(r,i)}}var Q5=wp(),eO=wp(!0);function Jc(){return[]}function Xc(){return!1}function tO(){return{}}function rO(){return""}function nO(){return!0}function iO(r,i){if(r=Me(r),r<1||r>G)return[];var a=re,f=tr(r,re);i=be(i),r-=re;for(var g=tc(f,i);++a<r;)i(a);return g}function sO(r){return Re(r)?bt(r,nn):Or(r)?[r]:vr(Up(nt(r)))}function oO(r){var i=++y2;return nt(r)+i}var aO=Yo(function(r,i){return r+i},0),uO=Ic("ceil"),cO=Yo(function(r,i){return r/i},1),fO=Ic("floor");function hO(r){return r&&r.length?jo(r,mr,lc):t}function lO(r,i){return r&&r.length?jo(r,be(i,2),lc):t}function dO(r){return Ed(r,mr)}function pO(r,i){return Ed(r,be(i,2))}function gO(r){return r&&r.length?jo(r,mr,_c):t}function _O(r,i){return r&&r.length?jo(r,be(i,2),_c):t}var yO=Yo(function(r,i){return r*i},1),vO=Ic("round"),bO=Yo(function(r,i){return r-i},0);function wO(r){return r&&r.length?ec(r,mr):0}function mO(r,i){return r&&r.length?ec(r,be(i,2)):0}return y.after=zD,y.ary=Vp,y.assign=Cx,y.assignIn=ag,y.assignInWith=aa,y.assignWith=Tx,y.at=Rx,y.before=Yp,y.bind=Bc,y.bindAll=$5,y.bindKey=kp,y.castArray=tx,y.chain=Kp,y.chunk=fS,y.compact=hS,y.concat=lS,y.cond=M5,y.conforms=B5,y.constant=Wc,y.countBy=wD,y.create=Nx,y.curry=Jp,y.curryRight=Xp,y.debounce=Zp,y.defaults=Lx,y.defaultsDeep=Fx,y.defer=KD,y.delay=GD,y.difference=dS,y.differenceBy=pS,y.differenceWith=gS,y.drop=_S,y.dropRight=yS,y.dropRightWhile=vS,y.dropWhile=bS,y.fill=wS,y.filter=ED,y.flatMap=xD,y.flatMapDeep=OD,y.flatMapDepth=ID,y.flatten=Hp,y.flattenDeep=mS,y.flattenDepth=ES,y.flip=WD,y.flow=j5,y.flowRight=q5,y.fromPairs=SS,y.functions=qx,y.functionsIn=zx,y.groupBy=AD,y.initial=xS,y.intersection=OS,y.intersectionBy=IS,y.intersectionWith=AS,y.invert=Gx,y.invertBy=Wx,y.invokeMap=CD,y.iteratee=Vc,y.keyBy=TD,y.keys=kt,y.keysIn=wr,y.map=ta,y.mapKeys=Yx,y.mapValues=kx,y.matches=z5,y.matchesProperty=K5,y.memoize=na,y.merge=Jx,y.mergeWith=ug,y.method=G5,y.methodOf=W5,y.mixin=Yc,y.negate=ia,y.nthArg=Y5,y.omit=Xx,y.omitBy=Zx,y.once=VD,y.orderBy=RD,y.over=k5,y.overArgs=YD,y.overEvery=J5,y.overSome=X5,y.partial=Hc,y.partialRight=Qp,y.partition=ND,y.pick=Qx,y.pickBy=cg,y.property=_g,y.propertyOf=Z5,y.pull=RS,y.pullAll=qp,y.pullAllBy=NS,y.pullAllWith=LS,y.pullAt=FS,y.range=Q5,y.rangeRight=eO,y.rearg=kD,y.reject=UD,y.remove=US,y.rest=JD,y.reverse=$c,y.sampleSize=MD,y.set=t5,y.setWith=r5,y.shuffle=BD,y.slice=$S,y.sortBy=qD,y.sortedUniq=KS,y.sortedUniqBy=GS,y.split=x5,y.spread=XD,y.tail=WS,y.take=VS,y.takeRight=YS,y.takeRightWhile=kS,y.takeWhile=JS,y.tap=hD,y.throttle=ZD,y.thru=ea,y.toArray=ig,y.toPairs=fg,y.toPairsIn=hg,y.toPath=sO,y.toPlainObject=og,y.transform=n5,y.unary=QD,y.union=XS,y.unionBy=ZS,y.unionWith=QS,y.uniq=eD,y.uniqBy=tD,y.uniqWith=rD,y.unset=i5,y.unzip=Mc,y.unzipWith=zp,y.update=s5,y.updateWith=o5,y.values=Mi,y.valuesIn=a5,y.without=nD,y.words=pg,y.wrap=ex,y.xor=iD,y.xorBy=sD,y.xorWith=oD,y.zip=aD,y.zipObject=uD,y.zipObjectDeep=cD,y.zipWith=fD,y.entries=fg,y.entriesIn=hg,y.extend=ag,y.extendWith=aa,Yc(y,y),y.add=aO,y.attempt=gg,y.camelCase=h5,y.capitalize=lg,y.ceil=uO,y.clamp=u5,y.clone=rx,y.cloneDeep=ix,y.cloneDeepWith=sx,y.cloneWith=nx,y.conformsTo=ox,y.deburr=dg,y.defaultTo=H5,y.divide=cO,y.endsWith=l5,y.eq=Wr,y.escape=d5,y.escapeRegExp=p5,y.every=mD,y.find=SD,y.findIndex=Mp,y.findKey=Ux,y.findLast=DD,y.findLastIndex=Bp,y.findLastKey=$x,y.floor=fO,y.forEach=Gp,y.forEachRight=Wp,y.forIn=Mx,y.forInRight=Bx,y.forOwn=Hx,y.forOwnRight=jx,y.get=zc,y.gt=ax,y.gte=ux,y.has=Kx,y.hasIn=Kc,y.head=jp,y.identity=mr,y.includes=PD,y.indexOf=DS,y.inRange=c5,y.invoke=Vx,y.isArguments=ui,y.isArray=Re,y.isArrayBuffer=cx,y.isArrayLike=br,y.isArrayLikeObject=Nt,y.isBoolean=fx,y.isBuffer=Fn,y.isDate=hx,y.isElement=lx,y.isEmpty=dx,y.isEqual=px,y.isEqualWith=gx,y.isError=jc,y.isFinite=_x,y.isFunction=yn,y.isInteger=eg,y.isLength=sa,y.isMap=tg,y.isMatch=yx,y.isMatchWith=vx,y.isNaN=bx,y.isNative=wx,y.isNil=Ex,y.isNull=mx,y.isNumber=rg,y.isObject=Et,y.isObjectLike=Pt,y.isPlainObject=As,y.isRegExp=qc,y.isSafeInteger=Sx,y.isSet=ng,y.isString=oa,y.isSymbol=Or,y.isTypedArray=$i,y.isUndefined=Dx,y.isWeakMap=xx,y.isWeakSet=Ox,y.join=PS,y.kebabCase=g5,y.last=Br,y.lastIndexOf=CS,y.lowerCase=_5,y.lowerFirst=y5,y.lt=Ix,y.lte=Ax,y.max=hO,y.maxBy=lO,y.mean=dO,y.meanBy=pO,y.min=gO,y.minBy=_O,y.stubArray=Jc,y.stubFalse=Xc,y.stubObject=tO,y.stubString=rO,y.stubTrue=nO,y.multiply=yO,y.nth=TS,y.noConflict=V5,y.noop=kc,y.now=ra,y.pad=v5,y.padEnd=b5,y.padStart=w5,y.parseInt=m5,y.random=f5,y.reduce=LD,y.reduceRight=FD,y.repeat=E5,y.replace=S5,y.result=e5,y.round=vO,y.runInContext=U,y.sample=$D,y.size=HD,y.snakeCase=D5,y.some=jD,y.sortedIndex=MS,y.sortedIndexBy=BS,y.sortedIndexOf=HS,y.sortedLastIndex=jS,y.sortedLastIndexBy=qS,y.sortedLastIndexOf=zS,y.startCase=O5,y.startsWith=I5,y.subtract=bO,y.sum=wO,y.sumBy=mO,y.template=A5,y.times=iO,y.toFinite=vn,y.toInteger=Me,y.toLength=sg,y.toLower=P5,y.toNumber=Hr,y.toSafeInteger=Px,y.toString=nt,y.toUpper=C5,y.trim=T5,y.trimEnd=R5,y.trimStart=N5,y.truncate=L5,y.unescape=F5,y.uniqueId=oO,y.upperCase=U5,y.upperFirst=Gc,y.each=Gp,y.eachRight=Wp,y.first=jp,Yc(y,function(){var r={};return tn(y,function(i,a){it.call(y.prototype,a)||(r[a]=i)}),r}(),{chain:!1}),y.VERSION=s,Lr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){y[r].placeholder=y}),Lr(["drop","take"],function(r,i){ke.prototype[r]=function(a){a=a===t?1:Wt(Me(a),0);var f=this.__filtered__&&!i?new ke(this):this.clone();return f.__filtered__?f.__takeCount__=tr(a,f.__takeCount__):f.__views__.push({size:tr(a,re),type:r+(f.__dir__<0?"Right":"")}),f},ke.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Lr(["filter","map","takeWhile"],function(r,i){var a=i+1,f=a==w||a==ee;ke.prototype[r]=function(g){var v=this.clone();return v.__iteratees__.push({iteratee:be(g,3),type:a}),v.__filtered__=v.__filtered__||f,v}}),Lr(["head","last"],function(r,i){var a="take"+(i?"Right":"");ke.prototype[r]=function(){return this[a](1).value()[0]}}),Lr(["initial","tail"],function(r,i){var a="drop"+(i?"":"Right");ke.prototype[r]=function(){return this.__filtered__?new ke(this):this[a](1)}}),ke.prototype.compact=function(){return this.filter(mr)},ke.prototype.find=function(r){return this.filter(r).head()},ke.prototype.findLast=function(r){return this.reverse().find(r)},ke.prototype.invokeMap=Ke(function(r,i){return typeof r=="function"?new ke(this):this.map(function(a){return Es(a,r,i)})}),ke.prototype.reject=function(r){return this.filter(ia(be(r)))},ke.prototype.slice=function(r,i){r=Me(r);var a=this;return a.__filtered__&&(r>0||i<0)?new ke(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),i!==t&&(i=Me(i),a=i<0?a.dropRight(-i):a.take(i-r)),a)},ke.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},ke.prototype.toArray=function(){return this.take(re)},tn(ke.prototype,function(r,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),f=/^(?:head|last)$/.test(i),g=y[f?"take"+(i=="last"?"Right":""):i],v=f||/^find/.test(i);g&&(y.prototype[i]=function(){var O=this.__wrapped__,N=f?[1]:arguments,B=O instanceof ke,Z=N[0],Q=B||Re(O),ne=function(Ve){var Qe=g.apply(y,An([Ve],N));return f&&ce?Qe[0]:Qe};Q&&a&&typeof Z=="function"&&Z.length!=1&&(B=Q=!1);var ce=this.__chain__,_e=!!this.__actions__.length,Ee=v&&!ce,je=B&&!_e;if(!v&&Q){O=je?O:new ke(this);var Se=r.apply(O,N);return Se.__actions__.push({func:ea,args:[ne],thisArg:t}),new Ur(Se,ce)}return Ee&&je?r.apply(this,N):(Se=this.thru(ne),Ee?f?Se.value()[0]:Se.value():Se)})}),Lr(["pop","push","shift","sort","splice","unshift"],function(r){var i=Oo[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",f=/^(?:pop|shift)$/.test(r);y.prototype[r]=function(){var g=arguments;if(f&&!this.__chain__){var v=this.value();return i.apply(Re(v)?v:[],g)}return this[a](function(O){return i.apply(Re(O)?O:[],g)})}}),tn(ke.prototype,function(r,i){var a=y[i];if(a){var f=a.name+"";it.call(Ri,f)||(Ri[f]=[]),Ri[f].push({name:i,func:a})}}),Ri[Vo(t,se).name]=[{name:"wrapper",func:t}],ke.prototype.clone=F2,ke.prototype.reverse=U2,ke.prototype.value=$2,y.prototype.at=lD,y.prototype.chain=dD,y.prototype.commit=pD,y.prototype.next=gD,y.prototype.plant=yD,y.prototype.reverse=vD,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=bD,y.prototype.first=y.prototype.head,gs&&(y.prototype[gs]=_D),y},Pi=p2();Rt?((Rt.exports=Pi)._=Pi,ct._=Pi):Ze._=Pi}).call(wt)})(Su,Su.exports);var m3=Object.defineProperty,E3=Object.defineProperties,S3=Object.getOwnPropertyDescriptors,fd=Object.getOwnPropertySymbols,D3=Object.prototype.hasOwnProperty,x3=Object.prototype.propertyIsEnumerable,hd=(n,e,t)=>e in n?m3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,eo=(n,e)=>{for(var t in e||(e={}))D3.call(e,t)&&hd(n,t,e[t]);if(fd)for(var t of fd(e))x3.call(e,t)&&hd(n,t,e[t]);return n},O3=(n,e)=>E3(n,S3(e));function Tr(n,e,t){let s;const o=Du(n);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${w3}?chainId=eip155:${o}&projectId=${t}`),s}function Du(n){return n.includes("eip155")?Number(n.split(":")[1]):Number(n)}function I3(n,e){if(!e.includes(n))throw new Error(`Chain '${n}' not approved. Please use one of the following: ${e.toString()}`)}function A3(n){return n.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function P3(n,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(n));if(!t.length)return[];const s=[];return t.forEach(o=>{const u=e.namespaces[o].accounts;s.push(...u)}),s}function C3(n,e={}){const t=ld(n),s=ld(e);return Su.exports.merge(t,s)}function ld(n){var e,t,s,o;const u={};if(!vi(n))return u;for(const[h,l]of Object.entries(n)){const _=el(h)?[h]:l.chains,p=l.methods||[],E=l.events||[],C=l.rpcMap||{},D=Ws(h);u[D]=O3(eo(eo({},u[D]),l),{chains:eu(_,(e=u[D])==null?void 0:e.chains),methods:eu(p,(t=u[D])==null?void 0:t.methods),events:eu(E,(s=u[D])==null?void 0:s.events),rpcMap:eo(eo({},C),(o=u[D])==null?void 0:o.rpcMap)})}return u}const Vn=(n,e)=>{const t=s=>{s.request!==e.request||s.topic!==e.topic||(n.events.removeListener("session_request_sent",t),T3(e,n.core.storage))};n.on("session_request_sent",t)};async function T3(n,e){try{const t=await e.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s?.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const u=`${o}/wc?requestId=${n.id}&sessionTopic=${n.topic}`,h=Vh();h===Gn.browser?window.open(u,"_self","noreferrer noopener"):h===Gn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(t){console.error(t)}}const dd={},Ct=n=>dd[n],xu=(n,e)=>{dd[n]=e};var Ou={exports:{}};(function(n,e){var t=typeof self<"u"?self:wt,s=function(){function u(){this.fetch=!1,this.DOMException=t.DOMException}return u.prototype=t,new u}();(function(u){(function(h){var l={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function _(w){return w&&DataView.prototype.isPrototypeOf(w)}if(l.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(w){return w&&p.indexOf(Object.prototype.toString.call(w))>-1};function C(w){if(typeof w!="string"&&(w=String(w)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(w))throw new TypeError("Invalid character in header field name");return w.toLowerCase()}function D(w){return typeof w!="string"&&(w=String(w)),w}function T(w){var I={next:function(){var ee=w.shift();return{done:ee===void 0,value:ee}}};return l.iterable&&(I[Symbol.iterator]=function(){return I}),I}function R(w){this.map={},w instanceof R?w.forEach(function(I,ee){this.append(ee,I)},this):Array.isArray(w)?w.forEach(function(I){this.append(I[0],I[1])},this):w&&Object.getOwnPropertyNames(w).forEach(function(I){this.append(I,w[I])},this)}R.prototype.append=function(w,I){w=C(w),I=D(I);var ee=this.map[w];this.map[w]=ee?ee+", "+I:I},R.prototype.delete=function(w){delete this.map[C(w)]},R.prototype.get=function(w){return w=C(w),this.has(w)?this.map[w]:null},R.prototype.has=function(w){return this.map.hasOwnProperty(C(w))},R.prototype.set=function(w,I){this.map[C(w)]=D(I)},R.prototype.forEach=function(w,I){for(var ee in this.map)this.map.hasOwnProperty(ee)&&w.call(I,this.map[ee],ee,this)},R.prototype.keys=function(){var w=[];return this.forEach(function(I,ee){w.push(ee)}),T(w)},R.prototype.values=function(){var w=[];return this.forEach(function(I){w.push(I)}),T(w)},R.prototype.entries=function(){var w=[];return this.forEach(function(I,ee){w.push([ee,I])}),T(w)},l.iterable&&(R.prototype[Symbol.iterator]=R.prototype.entries);function q(w){if(w.bodyUsed)return Promise.reject(new TypeError("Already read"));w.bodyUsed=!0}function K(w){return new Promise(function(I,ee){w.onload=function(){I(w.result)},w.onerror=function(){ee(w.error)}})}function se(w){var I=new FileReader,ee=K(I);return I.readAsArrayBuffer(w),ee}function L(w){var I=new FileReader,ee=K(I);return I.readAsText(w),ee}function M(w){for(var I=new Uint8Array(w),ee=new Array(I.length),X=0;X<I.length;X++)ee[X]=String.fromCharCode(I[X]);return ee.join("")}function x(w){if(w.slice)return w.slice(0);var I=new Uint8Array(w.byteLength);return I.set(new Uint8Array(w)),I.buffer}function P(){return this.bodyUsed=!1,this._initBody=function(w){this._bodyInit=w,w?typeof w=="string"?this._bodyText=w:l.blob&&Blob.prototype.isPrototypeOf(w)?this._bodyBlob=w:l.formData&&FormData.prototype.isPrototypeOf(w)?this._bodyFormData=w:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)?this._bodyText=w.toString():l.arrayBuffer&&l.blob&&_(w)?(this._bodyArrayBuffer=x(w.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(w)||E(w))?this._bodyArrayBuffer=x(w):this._bodyText=w=Object.prototype.toString.call(w):this._bodyText="",this.headers.get("content-type")||(typeof w=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(w)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var w=q(this);if(w)return w;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(se)}),this.text=function(){var w=q(this);if(w)return w;if(this._bodyBlob)return L(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(M(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(w){var I=w.toUpperCase();return m.indexOf(I)>-1?I:w}function b(w,I){I=I||{};var ee=I.body;if(w instanceof b){if(w.bodyUsed)throw new TypeError("Already read");this.url=w.url,this.credentials=w.credentials,I.headers||(this.headers=new R(w.headers)),this.method=w.method,this.mode=w.mode,this.signal=w.signal,!ee&&w._bodyInit!=null&&(ee=w._bodyInit,w.bodyUsed=!0)}else this.url=String(w);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new R(I.headers)),this.method=c(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function V(w){var I=new FormData;return w.trim().split("&").forEach(function(ee){if(ee){var X=ee.split("="),G=X.shift().replace(/\+/g," "),W=X.join("=").replace(/\+/g," ");I.append(decodeURIComponent(G),decodeURIComponent(W))}}),I}function k(w){var I=new R,ee=w.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(X){var G=X.split(":"),W=G.shift().trim();if(W){var J=G.join(":").trim();I.append(W,J)}}),I}P.call(b.prototype);function ie(w,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new R(I.headers),this.url=I.url||"",this._initBody(w)}P.call(ie.prototype),ie.prototype.clone=function(){return new ie(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new R(this.headers),url:this.url})},ie.error=function(){var w=new ie(null,{status:0,statusText:""});return w.type="error",w};var ue=[301,302,303,307,308];ie.redirect=function(w,I){if(ue.indexOf(I)===-1)throw new RangeError("Invalid status code");return new ie(null,{status:I,headers:{location:w}})},h.DOMException=u.DOMException;try{new h.DOMException}catch{h.DOMException=function(I,ee){this.message=I,this.name=ee;var X=Error(I);this.stack=X.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function de(w,I){return new Promise(function(ee,X){var G=new b(w,I);if(G.signal&&G.signal.aborted)return X(new h.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function J(){W.abort()}W.onload=function(){var re={status:W.status,statusText:W.statusText,headers:k(W.getAllResponseHeaders()||"")};re.url="responseURL"in W?W.responseURL:re.headers.get("X-Request-URL");var we="response"in W?W.response:W.responseText;ee(new ie(we,re))},W.onerror=function(){X(new TypeError("Network request failed"))},W.ontimeout=function(){X(new TypeError("Network request failed"))},W.onabort=function(){X(new h.DOMException("Aborted","AbortError"))},W.open(G.method,G.url,!0),G.credentials==="include"?W.withCredentials=!0:G.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&l.blob&&(W.responseType="blob"),G.headers.forEach(function(re,we){W.setRequestHeader(we,re)}),G.signal&&(G.signal.addEventListener("abort",J),W.onreadystatechange=function(){W.readyState===4&&G.signal.removeEventListener("abort",J)}),W.send(typeof G._bodyInit>"u"?null:G._bodyInit)})}return de.polyfill=!0,u.fetch||(u.fetch=de,u.Headers=R,u.Request=b,u.Response=ie),h.Headers=R,h.Request=b,h.Response=ie,h.fetch=de,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,n.exports=e})(Ou,Ou.exports);var pd=vg(Ou.exports);const gd={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},_d=10;class Yn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Qt.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!vl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Zi(e),u=await(await pd(this.url,Object.assign(Object.assign({},gd),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!vl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Zi({id:1,jsonrpc:"2.0",method:"test",params:[]});await pd(e,Object.assign(Object.assign({},gd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Pa(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),u=ks(e,o);this.events.emit("payload",u)}parseError(e,t=this.url){return fl(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>_d&&this.events.setMaxListeners(_d)}}class R3{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Tr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Tr(e,this.namespace);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}class N3{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var t;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=Du(e);if(!this.httpProviders[s]){const o=t||Tr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Tr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=Du(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){const t=parseInt(e,16),s=`${this.name}:${t}`;I3(s,this.namespace.chains),this.setDefaultChain(`${t}`)}}class L3{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Tr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Tr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}class F3{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Tr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Tr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}class U3{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}class $3{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Tr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Tr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}class M3{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Ct("events"),this.client=Ct("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(Vn(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Tr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Dn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Tr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new En(new Yn(s,Ct("disableProviderPing")))}}var B3=Object.defineProperty,H3=Object.defineProperties,j3=Object.getOwnPropertyDescriptors,yd=Object.getOwnPropertySymbols,q3=Object.prototype.hasOwnProperty,z3=Object.prototype.propertyIsEnumerable,vd=(n,e,t)=>e in n?B3(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,to=(n,e)=>{for(var t in e||(e={}))q3.call(e,t)&&vd(n,t,e[t]);if(yd)for(var t of yd(e))z3.call(e,t)&&vd(n,t,e[t]);return n},Iu=(n,e)=>H3(n,j3(e));class ro{constructor(e){this.events=new Qt.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:e?.logger||ud})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new ro(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:to({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ut("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(u=>{this.session=u}).catch(u=>{if(u.message!==sd)throw u;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(yi(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Eu.init({logger:this.providerOpts.logger||ud,relayUrl:this.providerOpts.relayUrl||y3,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>Ws(t)))];xu("client",this.client),xu("events",this.events),xu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=P3(t,this.session),o=A3(s),u=C3(this.namespaces,this.optionalNamespaces),h=Iu(to({},u[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new N3({namespace:h});break;case"solana":this.rpcProviders[t]=new L3({namespace:h});break;case"cosmos":this.rpcProviders[t]=new F3({namespace:h});break;case"polkadot":this.rpcProviders[t]=new R3({namespace:h});break;case"cip34":this.rpcProviders[t]=new U3({namespace:h});break;case"elrond":this.rpcProviders[t]=new $3({namespace:h});break;case"multiversx":this.rpcProviders[t]=new M3({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?this.events.emit("accountsChanged",s.data):s.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,u=(s=this.client)==null?void 0:s.session.get(e);this.session=Iu(to({},u),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Iu(to({},Ut("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Dn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;if(!t||!Object.keys(t).length)throw new Error("Namespaces must be not empty");this.namespaces=t,this.optionalNamespaces=s,this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=e?.split(":")||["",""];if(t&&!Object.keys(this.namespaces).map(h=>Ws(h)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=Ws(Object.keys(this.namespaces)[0]),u=this.rpcProviders[o].getDefaultChain();return[o,u]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;const[o,u]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(u),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${cd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${cd}/${e}`)}}const K3=ro;Un.UniversalProvider=K3,Un.default=ro,Object.defineProperty(Un,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
