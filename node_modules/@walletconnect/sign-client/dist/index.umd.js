(function(xe,et){typeof exports=="object"&&typeof module<"u"?et(exports):typeof define=="function"&&define.amd?define(["exports"],et):(xe=typeof globalThis<"u"?globalThis:xe||self,et(xe["@walletconnect/sign-client"]={}))})(this,function(xe){"use strict";var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var ht={exports:{}},er=typeof Reflect=="object"?Reflect:null,Ln=er&&typeof er.apply=="function"?er.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Br;er&&typeof er.ownKeys=="function"?Br=er.ownKeys:Object.getOwnPropertySymbols?Br=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Br=function(e){return Object.getOwnPropertyNames(e)};function Za(t){console&&console.warn&&console.warn(t)}var Un=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}ht.exports=Oe,ht.exports.once=ic,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var $n=10;function zr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return $n},set:function(t){if(typeof t!="number"||t<0||Un(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");$n=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Un(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Mn(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return Mn(this)},Oe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var u=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw u.context=a,u}var h=s[e];if(h===void 0)return!1;if(typeof h=="function")Ln(h,this,r);else for(var l=h.length,p=Kn(h,l),i=0;i<l;++i)Ln(p[i],this,r);return!0};function jn(t,e,r,i){var n,s,a;if(zr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),n=Mn(t),n>0&&a.length>n&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,Za(u)}return t}Oe.prototype.addListener=function(e,r){return jn(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return jn(this,e,r,!0)};function ec(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Bn(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=ec.bind(i);return n.listener=r,i.wrapFn=n,n}Oe.prototype.once=function(e,r){return zr(r),this.on(e,Bn(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return zr(r),this.prependListener(e,Bn(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var i,n,s,a,u;if(zr(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===r||i[a].listener===r){u=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():tc(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,u||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(n=0;n<s.length;++n)a=s[n],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function zn(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?rc(n):Kn(n,n.length)}Oe.prototype.listeners=function(e){return zn(this,e,!0)},Oe.prototype.rawListeners=function(e){return zn(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):qn.call(t,e)},Oe.prototype.listenerCount=qn;function qn(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Br(this._events):[]};function Kn(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function tc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function rc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function ic(t,e){return new Promise(function(r,i){function n(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Hn(t,e,s,{once:!0}),e!=="error"&&nc(t,n,{once:!0})})}function nc(t,e,r){typeof t.on=="function"&&Hn(t,"error",e,r)}function Hn(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var qr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var vi=function(t,e){return vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},vi(t,e)};function sc(t,e){vi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var wi=function(){return wi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},wi.apply(this,arguments)};function oc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ac(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function cc(t,e){return function(r,i){e(r,i,t)}}function uc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function lc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{l(i.next(p))}catch(w){a(w)}}function h(p){try{l(i.throw(p))}catch(w){a(w)}}function l(p){p.done?s(p.value):n(p.value).then(u,h)}l((i=i.apply(t,e||[])).next())})}function hc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(p){return h([l,p])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(p){l=[6,p],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function fc(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function dc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function mi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function pc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Vn(arguments[e]));return t}function gc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function lr(t){return this instanceof lr?(this.v=t,this):new lr(t)}function yc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(m){return new Promise(function(S,A){s.push([y,m,S,A])>1||u(y,m)})})}function u(y,m){try{h(i[y](m))}catch(S){w(s[0][3],S)}}function h(y){y.value instanceof lr?Promise.resolve(y.value.v).then(l,p):w(s[0][2],y)}function l(y){u("next",y)}function p(y){u("throw",y)}function w(y,m){y(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function _c(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:lr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function bc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof mi=="function"?mi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,h){a=t[s](a),n(u,h,a.done,a.value)})}}function n(s,a,u,h){Promise.resolve(h).then(function(l){s({value:l,done:u})},a)}}function vc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function wc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function mc(t){return t&&t.__esModule?t:{default:t}}function Ec(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Sc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Dc=Object.freeze({__proto__:null,__extends:sc,get __assign(){return wi},__rest:oc,__decorate:ac,__param:cc,__metadata:uc,__awaiter:lc,__generator:hc,__createBinding:fc,__exportStar:dc,__values:mi,__read:Vn,__spread:pc,__spreadArrays:gc,__await:lr,__asyncGenerator:yc,__asyncDelegator:_c,__asyncValues:bc,__makeTemplateObject:vc,__importStar:wc,__importDefault:mc,__classPrivateFieldGet:Ec,__classPrivateFieldSet:Sc}),Gn=zt(Dc),hr={};Object.defineProperty(hr,"__esModule",{value:!0});function Oc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}hr.safeJsonParse=Oc;function xc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}hr.safeJsonStringify=xc;var fr={exports:{}},Wn;function Ic(){return Wn||(Wn=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof et<"u"&&et.localStorage?fr.exports=et.localStorage:typeof window<"u"&&window.localStorage?fr.exports=window.localStorage:fr.exports=new e}()),fr.exports}var Ei={},dr={},kn;function Tc(){if(kn)return dr;kn=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.IKeyValueStorage=void 0;class t{}return dr.IKeyValueStorage=t,dr}var pr={},Yn;function Nc(){if(Yn)return pr;Yn=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.parseEntry=void 0;const t=hr;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return pr.parseEntry=e,pr}var Xn;function Pc(){return Xn||(Xn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Gn;e.__exportStar(Tc(),t),e.__exportStar(Nc(),t)}(Ei)),Ei}Object.defineProperty(qr,"__esModule",{value:!0}),qr.KeyValueStorage=void 0;const tr=Gn,Jn=hr,Ac=tr.__importDefault(Ic()),Rc=Pc();class Qn{constructor(){this.localStorage=Ac.default}getKeys(){return tr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return tr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Rc.parseEntry)})}getItem(e){return tr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Jn.safeJsonParse(r)})}setItem(e,r){return tr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Jn.safeJsonStringify(r))})}removeItem(e){return tr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}qr.KeyValueStorage=Qn;var Cc=qr.default=Qn,gr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Si=function(t,e){return Si=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Si(t,e)};function Fc(t,e){Si(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Di=function(){return Di=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Di.apply(this,arguments)};function Lc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Uc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function $c(t,e){return function(r,i){e(r,i,t)}}function Mc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function jc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{l(i.next(p))}catch(w){a(w)}}function h(p){try{l(i.throw(p))}catch(w){a(w)}}function l(p){p.done?s(p.value):n(p.value).then(u,h)}l((i=i.apply(t,e||[])).next())})}function Bc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(p){return h([l,p])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(p){l=[6,p],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function zc(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function qc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Oi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Kc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Zn(arguments[e]));return t}function Hc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function yr(t){return this instanceof yr?(this.v=t,this):new yr(t)}function Vc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(m){return new Promise(function(S,A){s.push([y,m,S,A])>1||u(y,m)})})}function u(y,m){try{h(i[y](m))}catch(S){w(s[0][3],S)}}function h(y){y.value instanceof yr?Promise.resolve(y.value.v).then(l,p):w(s[0][2],y)}function l(y){u("next",y)}function p(y){u("throw",y)}function w(y,m){y(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Gc(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:yr(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Wc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Oi=="function"?Oi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,h){a=t[s](a),n(u,h,a.done,a.value)})}}function n(s,a,u,h){Promise.resolve(h).then(function(l){s({value:l,done:u})},a)}}function kc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Yc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Xc(t){return t&&t.__esModule?t:{default:t}}function Jc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Qc(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Zc=Object.freeze({__proto__:null,__extends:Fc,get __assign(){return Di},__rest:Lc,__decorate:Uc,__param:$c,__metadata:Mc,__awaiter:jc,__generator:Bc,__createBinding:zc,__exportStar:qc,__values:Oi,__read:Zn,__spread:Kc,__spreadArrays:Hc,__await:yr,__asyncGenerator:Vc,__asyncDelegator:Gc,__asyncValues:Wc,__makeTemplateObject:kc,__importStar:Yc,__importDefault:Xc,__classPrivateFieldGet:Jc,__classPrivateFieldSet:Qc}),Kr=zt(Zc),_r={},Q={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xi=function(t,e){return xi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},xi(t,e)};function eu(t,e){xi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ii=function(){return Ii=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ii.apply(this,arguments)};function tu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function ru(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function iu(t,e){return function(r,i){e(r,i,t)}}function nu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function su(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{l(i.next(p))}catch(w){a(w)}}function h(p){try{l(i.throw(p))}catch(w){a(w)}}function l(p){p.done?s(p.value):n(p.value).then(u,h)}l((i=i.apply(t,e||[])).next())})}function ou(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(p){return h([l,p])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(p){l=[6,p],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function au(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function cu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ti(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function es(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function uu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(es(arguments[e]));return t}function lu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function br(t){return this instanceof br?(this.v=t,this):new br(t)}function hu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(m){return new Promise(function(S,A){s.push([y,m,S,A])>1||u(y,m)})})}function u(y,m){try{h(i[y](m))}catch(S){w(s[0][3],S)}}function h(y){y.value instanceof br?Promise.resolve(y.value.v).then(l,p):w(s[0][2],y)}function l(y){u("next",y)}function p(y){u("throw",y)}function w(y,m){y(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function fu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:br(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function du(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ti=="function"?Ti(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,h){a=t[s](a),n(u,h,a.done,a.value)})}}function n(s,a,u,h){Promise.resolve(h).then(function(l){s({value:l,done:u})},a)}}function pu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function gu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function yu(t){return t&&t.__esModule?t:{default:t}}function _u(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function bu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var vu=Object.freeze({__proto__:null,__extends:eu,get __assign(){return Ii},__rest:tu,__decorate:ru,__param:iu,__metadata:nu,__awaiter:su,__generator:ou,__createBinding:au,__exportStar:cu,__values:Ti,__read:es,__spread:uu,__spreadArrays:lu,__await:br,__asyncGenerator:hu,__asyncDelegator:fu,__asyncValues:du,__makeTemplateObject:pu,__importStar:gu,__importDefault:yu,__classPrivateFieldGet:_u,__classPrivateFieldSet:bu}),Hr=zt(vu),Ni={},vr={},ts;function wu(){if(ts)return vr;ts=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return vr.delay=t,vr}var qt={},Pi={},Kt={},rs;function mu(){return rs||(rs=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ONE_THOUSAND=Kt.ONE_HUNDRED=void 0,Kt.ONE_HUNDRED=100,Kt.ONE_THOUSAND=1e3),Kt}var Ai={},is;function Eu(){return is||(is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Ai)),Ai}var ns;function ss(){return ns||(ns=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(mu(),t),e.__exportStar(Eu(),t)}(Pi)),Pi}var os;function Su(){if(os)return qt;os=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.fromMiliseconds=qt.toMiliseconds=void 0;const t=ss();function e(i){return i*t.ONE_THOUSAND}qt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return qt.fromMiliseconds=r,qt}var as;function Du(){return as||(as=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(wu(),t),e.__exportStar(Su(),t)}(Ni)),Ni}var rr={},cs;function Ou(){if(cs)return rr;cs=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return rr.Watch=t,rr.default=t,rr}var Ri={},wr={},us;function xu(){if(us)return wr;us=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.IWatch=void 0;class t{}return wr.IWatch=t,wr}var ls;function Iu(){return ls||(ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Hr.__exportStar(xu(),t)}(Ri)),Ri}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Hr;e.__exportStar(Du(),t),e.__exportStar(Ou(),t),e.__exportStar(Iu(),t),e.__exportStar(ss(),t)})(Q);var Ci={},mr={};class Ht{}var Tu=Object.freeze({__proto__:null,IEvents:Ht}),Nu=zt(Tu),hs;function Pu(){if(hs)return mr;hs=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.IHeartBeat=void 0;const t=Nu;class e extends t.IEvents{constructor(i){super()}}return mr.IHeartBeat=e,mr}var fs;function ds(){return fs||(fs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Kr.__exportStar(Pu(),t)}(Ci)),Ci}var Fi={},Vt={},ps;function Au(){if(ps)return Vt;ps=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.HEARTBEAT_EVENTS=Vt.HEARTBEAT_INTERVAL=void 0;const t=Q;return Vt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Vt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vt}var gs;function ys(){return gs||(gs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Kr.__exportStar(Au(),t)}(Fi)),Fi}var _s;function Ru(){if(_s)return _r;_s=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.HeartBeat=void 0;const t=Kr,e=ht.exports,r=Q,i=ds(),n=ys();class s extends i.IHeartBeat{constructor(u){super(u),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=u?.interval||n.HEARTBEAT_INTERVAL}static init(u){return t.__awaiter(this,void 0,void 0,function*(){const h=new s(u);return yield h.init(),h})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(u,h){this.events.on(u,h)}once(u,h){this.events.once(u,h)}off(u,h){this.events.off(u,h)}removeListener(u,h){this.events.removeListener(u,h)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return _r.HeartBeat=s,_r}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Kr;e.__exportStar(Ru(),t),e.__exportStar(ds(),t),e.__exportStar(ys(),t)})(gr);var _e={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Li=function(t,e){return Li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Li(t,e)};function Cu(t,e){Li(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ui=function(){return Ui=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ui.apply(this,arguments)};function Fu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Lu(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Uu(t,e){return function(r,i){e(r,i,t)}}function $u(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Mu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{l(i.next(p))}catch(w){a(w)}}function h(p){try{l(i.throw(p))}catch(w){a(w)}}function l(p){p.done?s(p.value):n(p.value).then(u,h)}l((i=i.apply(t,e||[])).next())})}function ju(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(p){return h([l,p])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(p){l=[6,p],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Bu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function zu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function $i(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function qu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(bs(arguments[e]));return t}function Ku(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function Er(t){return this instanceof Er?(this.v=t,this):new Er(t)}function Hu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(m){return new Promise(function(S,A){s.push([y,m,S,A])>1||u(y,m)})})}function u(y,m){try{h(i[y](m))}catch(S){w(s[0][3],S)}}function h(y){y.value instanceof Er?Promise.resolve(y.value.v).then(l,p):w(s[0][2],y)}function l(y){u("next",y)}function p(y){u("throw",y)}function w(y,m){y(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Vu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Er(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Gu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof $i=="function"?$i(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,h){a=t[s](a),n(u,h,a.done,a.value)})}}function n(s,a,u,h){Promise.resolve(h).then(function(l){s({value:l,done:u})},a)}}function Wu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ku(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Yu(t){return t&&t.__esModule?t:{default:t}}function Xu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ju(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Qu=Object.freeze({__proto__:null,__extends:Cu,get __assign(){return Ui},__rest:Fu,__decorate:Lu,__param:Uu,__metadata:$u,__awaiter:Mu,__generator:ju,__createBinding:Bu,__exportStar:zu,__values:$i,__read:bs,__spread:qu,__spreadArrays:Ku,__await:Er,__asyncGenerator:Hu,__asyncDelegator:Vu,__asyncValues:Gu,__makeTemplateObject:Wu,__importStar:ku,__importDefault:Yu,__classPrivateFieldGet:Xu,__classPrivateFieldSet:Ju}),Zu=zt(Qu),Mi,vs;function el(){if(vs)return Mi;vs=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Mi=e;function e(r,i,n){var s=n&&n.stringify||t,a=1;if(typeof r=="object"&&r!==null){var u=i.length+a;if(u===1)return r;var h=new Array(u);h[0]=s(r);for(var l=1;l<u;l++)h[l]=s(i[l]);return h.join(" ")}if(typeof r!="string")return r;var p=i.length;if(p===0)return r;for(var w="",y=1-a,m=-1,S=r&&r.length||0,A=0;A<S;){if(r.charCodeAt(A)===37&&A+1<S){switch(m=m>-1?m:0,r.charCodeAt(A+1)){case 100:case 102:if(y>=p||i[y]==null)break;m<A&&(w+=r.slice(m,A)),w+=Number(i[y]),m=A+2,A++;break;case 105:if(y>=p||i[y]==null)break;m<A&&(w+=r.slice(m,A)),w+=Math.floor(Number(i[y])),m=A+2,A++;break;case 79:case 111:case 106:if(y>=p||i[y]===void 0)break;m<A&&(w+=r.slice(m,A));var R=typeof i[y];if(R==="string"){w+="'"+i[y]+"'",m=A+2,A++;break}if(R==="function"){w+=i[y].name||"<anonymous>",m=A+2,A++;break}w+=s(i[y]),m=A+2,A++;break;case 115:if(y>=p)break;m<A&&(w+=r.slice(m,A)),w+=String(i[y]),m=A+2,A++;break;case 37:m<A&&(w+=r.slice(m,A)),w+="%",m=A+2,A++,y--;break}++y}++A}return m===-1?r:(m<S&&(w+=r.slice(m)),w)}return Mi}var ji,ws;function tl(){if(ws)return ji;ws=1;const t=el();ji=n;const e=v().console||{},r={mapHttpRequest:S,mapHttpResponse:S,wrapRequestSerializer:A,wrapResponseSerializer:A,wrapErrorSerializer:A,req:S,res:S,err:y};function i(d,o){return Array.isArray(d)?d.filter(function(C){return C!=="!stdSerializers.err"}):d===!0?Object.keys(o):!1}function n(d){d=d||{},d.browser=d.browser||{};const o=d.browser.transmit;if(o&&typeof o.send!="function")throw Error("pino: transmit option must have a send function");const f=d.browser.write||e;d.browser.write&&(d.browser.asObject=!0);const C=d.serializers||{},F=i(d.browser.serialize,C);let K=d.browser.serialize;Array.isArray(d.browser.serialize)&&d.browser.serialize.indexOf("!stdSerializers.err")>-1&&(K=!1);const G=["error","fatal","warn","info","debug","trace"];typeof f=="function"&&(f.error=f.fatal=f.warn=f.info=f.debug=f.trace=f),d.enabled===!1&&(d.level="silent");const J=d.level||"info",x=Object.create(f);x.log||(x.log=R),Object.defineProperty(x,"levelVal",{get:W}),Object.defineProperty(x,"level",{get:j,set:U});const P={transmit:o,serialize:F,asObject:d.browser.asObject,levels:G,timestamp:m(d)};x.levels=n.levels,x.level=J,x.setMaxListeners=x.getMaxListeners=x.emit=x.addListener=x.on=x.prependListener=x.once=x.prependOnceListener=x.removeListener=x.removeAllListeners=x.listeners=x.listenerCount=x.eventNames=x.write=x.flush=R,x.serializers=C,x._serialize=F,x._stdErrSerialize=K,x.child=M,o&&(x._logEvent=w());function W(){return this.level==="silent"?1/0:this.levels.values[this.level]}function j(){return this._level}function U(L){if(L!=="silent"&&!this.levels.values[L])throw Error("unknown level "+L);this._level=L,s(P,x,"error","log"),s(P,x,"fatal","error"),s(P,x,"warn","error"),s(P,x,"info","log"),s(P,x,"debug","log"),s(P,x,"trace","log")}function M(L,B){if(!L)throw new Error("missing bindings for child Pino");B=B||{},F&&L.serializers&&(B.serializers=L.serializers);const te=B.serializers;if(F&&te){var z=Object.assign({},C,te),Z=d.browser.serialize===!0?Object.keys(z):F;delete L.serializers,h([L],Z,z,this._stdErrSerialize)}function Y(ee){this._childLevel=(ee._childLevel|0)+1,this.error=l(ee,L,"error"),this.fatal=l(ee,L,"fatal"),this.warn=l(ee,L,"warn"),this.info=l(ee,L,"info"),this.debug=l(ee,L,"debug"),this.trace=l(ee,L,"trace"),z&&(this.serializers=z,this._serialize=Z),o&&(this._logEvent=w([].concat(ee._logEvent.bindings,L)))}return Y.prototype=this,new Y(this)}return x}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:q,epochTime:E,unixTime:I,isoTime:_});function s(d,o,f,C){const F=Object.getPrototypeOf(o);o[f]=o.levelVal>o.levels.values[f]?R:F[f]?F[f]:e[f]||e[C]||R,a(d,o,f)}function a(d,o,f){!d.transmit&&o[f]===R||(o[f]=function(C){return function(){const K=d.timestamp(),G=new Array(arguments.length),J=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var x=0;x<G.length;x++)G[x]=arguments[x];if(d.serialize&&!d.asObject&&h(G,this._serialize,this.serializers,this._stdErrSerialize),d.asObject?C.call(J,u(this,f,G,K)):C.apply(J,G),d.transmit){const P=d.transmit.level||o.level,W=n.levels.values[P],j=n.levels.values[f];if(j<W)return;p(this,{ts:K,methodLevel:f,methodValue:j,transmitLevel:P,transmitValue:n.levels.values[d.transmit.level||o.level],send:d.transmit.send,val:o.levelVal},G)}}}(o[f]))}function u(d,o,f,C){d._serialize&&h(f,d._serialize,d.serializers,d._stdErrSerialize);const F=f.slice();let K=F[0];const G={};C&&(G.time=C),G.level=n.levels.values[o];let J=(d._childLevel|0)+1;if(J<1&&(J=1),K!==null&&typeof K=="object"){for(;J--&&typeof F[0]=="object";)Object.assign(G,F.shift());K=F.length?t(F.shift(),F):void 0}else typeof K=="string"&&(K=t(F.shift(),F));return K!==void 0&&(G.msg=K),G}function h(d,o,f,C){for(const F in d)if(C&&d[F]instanceof Error)d[F]=n.stdSerializers.err(d[F]);else if(typeof d[F]=="object"&&!Array.isArray(d[F]))for(const K in d[F])o&&o.indexOf(K)>-1&&K in f&&(d[F][K]=f[K](d[F][K]))}function l(d,o,f){return function(){const C=new Array(1+arguments.length);C[0]=o;for(var F=1;F<C.length;F++)C[F]=arguments[F-1];return d[f].apply(this,C)}}function p(d,o,f){const C=o.send,F=o.ts,K=o.methodLevel,G=o.methodValue,J=o.val,x=d._logEvent.bindings;h(f,d._serialize||Object.keys(d.serializers),d.serializers,d._stdErrSerialize===void 0?!0:d._stdErrSerialize),d._logEvent.ts=F,d._logEvent.messages=f.filter(function(P){return x.indexOf(P)===-1}),d._logEvent.level.label=K,d._logEvent.level.value=G,C(K,d._logEvent,J),d._logEvent=w(x)}function w(d){return{ts:0,messages:[],bindings:d||[],level:{label:"",value:0}}}function y(d){const o={type:d.constructor.name,msg:d.message,stack:d.stack};for(const f in d)o[f]===void 0&&(o[f]=d[f]);return o}function m(d){return typeof d.timestamp=="function"?d.timestamp:d.timestamp===!1?q:E}function S(){return{}}function A(d){return d}function R(){}function q(){return!1}function E(){return Date.now()}function I(){return Math.round(Date.now()/1e3)}function _(){return new Date(Date.now()).toISOString()}function v(){function d(o){return typeof o<"u"&&o}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return d(self)||d(window)||d(this)||{}}}return ji}var Gt={},ms;function Es(){return ms||(ms=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.PINO_CUSTOM_CONTEXT_KEY=Gt.PINO_LOGGER_DEFAULTS=void 0,Gt.PINO_LOGGER_DEFAULTS={level:"info"},Gt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Gt}var ot={},Ss;function rl(){if(Ss)return ot;Ss=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Es();function e(u){return Object.assign(Object.assign({},u),{level:u?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(u,h=t.PINO_CUSTOM_CONTEXT_KEY){return u[h]||""}ot.getBrowserLoggerContext=r;function i(u,h,l=t.PINO_CUSTOM_CONTEXT_KEY){return u[l]=h,u}ot.setBrowserLoggerContext=i;function n(u,h=t.PINO_CUSTOM_CONTEXT_KEY){let l="";return typeof u.bindings>"u"?l=r(u,h):l=u.bindings().context||"",l}ot.getLoggerContext=n;function s(u,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const p=n(u,l);return p.trim()?`${p}/${h}`:h}ot.formatChildLoggerContext=s;function a(u,h,l=t.PINO_CUSTOM_CONTEXT_KEY){const p=s(u,h,l),w=u.child({context:p});return i(w,p,l)}return ot.generateChildLogger=a,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Zu,r=e.__importDefault(tl());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Es(),t),e.__exportStar(rl(),t)})(_e);class il extends Ht{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class nl extends Ht{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class sl{constructor(e,r){this.logger=e,this.core=r}}class ol extends Ht{constructor(e,r){super(),this.relayer=e,this.logger=r}}class al extends Ht{constructor(e){super()}}class cl{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class ul extends Ht{constructor(e,r){super(),this.relayer=e,this.logger=r}}class ll extends Ht{constructor(e,r){super(),this.core=e,this.logger=r}}class hl{constructor(e,r){this.projectId=e,this.logger=r}}class fl{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class dl{constructor(e){this.client=e}}const pl=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),gl=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Ds(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return gl(t)}catch{return t}}function Bi(t){return typeof t=="string"?t:pl(t)||""}var zi={},ir={},Vr={},Gr={};Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.BrowserRandomSource=void 0;const Os=65536;class yl{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=Os)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Os)));return r}}Gr.BrowserRandomSource=yl;function _l(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wr={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function bl(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=bl;var vl={},wl=Object.freeze({__proto__:null,default:vl}),ml=zt(wl);Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.NodeRandomSource=void 0;const El=pt;class Sl{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _l<"u"){const e=ml;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,El.wipe)(r),i}}Wr.NodeRandomSource=Sl,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.SystemRandomSource=void 0;const Dl=Gr,Ol=Wr;class xl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Dl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Ol.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Vr.SystemRandomSource=xl;var ie={},xs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(u,h){var l=u>>>16&65535,p=u&65535,w=h>>>16&65535,y=h&65535;return p*y+(l*y+p*w<<16>>>0)|0}t.mul=Math.imul||e;function r(u,h){return u+h|0}t.add=r;function i(u,h){return u-h|0}t.sub=i;function n(u,h){return u<<h|u>>>32-h}t.rotl=n;function s(u,h){return u<<32-h|u>>>h}t.rotr=s;function a(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(u){return t.isInteger(u)&&u>=-t.MAX_SAFE_INTEGER&&u<=t.MAX_SAFE_INTEGER}})(xs),Object.defineProperty(ie,"__esModule",{value:!0});var Is=xs;function Il(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}ie.readInt16BE=Il;function Tl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}ie.readUint16BE=Tl;function Nl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}ie.readInt16LE=Nl;function Pl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}ie.readUint16LE=Pl;function Ts(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}ie.writeUint16BE=Ts,ie.writeInt16BE=Ts;function Ns(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}ie.writeUint16LE=Ns,ie.writeInt16LE=Ns;function qi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}ie.readInt32BE=qi;function Ki(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}ie.readUint32BE=Ki;function Hi(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}ie.readInt32LE=Hi;function Vi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}ie.readUint32LE=Vi;function kr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}ie.writeUint32BE=kr,ie.writeInt32BE=kr;function Yr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}ie.writeUint32LE=Yr,ie.writeInt32LE=Yr;function Al(t,e){e===void 0&&(e=0);var r=qi(t,e),i=qi(t,e+4);return r*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=Al;function Rl(t,e){e===void 0&&(e=0);var r=Ki(t,e),i=Ki(t,e+4);return r*4294967296+i}ie.readUint64BE=Rl;function Cl(t,e){e===void 0&&(e=0);var r=Hi(t,e),i=Hi(t,e+4);return i*4294967296+r-(r>>31)*4294967296}ie.readInt64LE=Cl;function Fl(t,e){e===void 0&&(e=0);var r=Vi(t,e),i=Vi(t,e+4);return i*4294967296+r}ie.readUint64LE=Fl;function Ps(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),kr(t/4294967296>>>0,e,r),kr(t>>>0,e,r+4),e}ie.writeUint64BE=Ps,ie.writeInt64BE=Ps;function As(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Yr(t>>>0,e,r),Yr(t/4294967296>>>0,e,r+4),e}ie.writeUint64LE=As,ie.writeInt64LE=As;function Ll(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}ie.readUintBE=Ll;function Ul(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}ie.readUintLE=Ul;function $l(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Is.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}ie.writeUintBE=$l;function Ml(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Is.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}ie.writeUintLE=Ml;function jl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}ie.readFloat32BE=jl;function Bl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}ie.readFloat32LE=Bl;function zl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}ie.readFloat64BE=zl;function ql(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}ie.readFloat64LE=ql;function Kl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}ie.writeFloat32BE=Kl;function Hl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}ie.writeFloat32LE=Hl;function Vl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}ie.writeFloat64BE=Vl;function Gl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}ie.writeFloat64LE=Gl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Vr,r=ie,i=pt;t.defaultRandomSource=new e.SystemRandomSource;function n(l,p=t.defaultRandomSource){return p.randomBytes(l)}t.randomBytes=n;function s(l=t.defaultRandomSource){const p=n(4,l),w=(0,r.readUint32LE)(p);return(0,i.wipe)(p),w}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(l,p=a,w=t.defaultRandomSource){if(p.length<2)throw new Error("randomString charset is too short");if(p.length>256)throw new Error("randomString charset is too long");let y="";const m=p.length,S=256-256%m;for(;l>0;){const A=n(Math.ceil(l*256/S),w);for(let R=0;R<A.length&&l>0;R++){const q=A[R];q<S&&(y+=p.charAt(q%m),l--)}(0,i.wipe)(A)}return y}t.randomString=u;function h(l,p=a,w=t.defaultRandomSource){const y=Math.ceil(l/(Math.log(p.length)/Math.LN2));return u(y,p,w)}t.randomStringForEntropy=h}(ir);var Rs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},u.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var p=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&l>0;)this._buffer[this._bufferLength++]=h[p++],l--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(p=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,p,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[p++],l--;return this},u.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,p=this._bufferLength,w=l/536870912|0,y=l<<3,m=l%128<112?128:256;this._buffer[p]=128;for(var S=p+1;S<m-8;S++)this._buffer[S]=0;e.writeUint32BE(w,this._buffer,m-8),e.writeUint32BE(y,this._buffer,m-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)e.writeUint32BE(this._stateHi[S],h,S*8),e.writeUint32BE(this._stateLo[S],h,S*8+4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(u,h,l,p,w,y,m){for(var S=l[0],A=l[1],R=l[2],q=l[3],E=l[4],I=l[5],_=l[6],v=l[7],d=p[0],o=p[1],f=p[2],C=p[3],F=p[4],K=p[5],G=p[6],J=p[7],x,P,W,j,U,M,L,B;m>=128;){for(var te=0;te<16;te++){var z=8*te+y;u[te]=e.readUint32BE(w,z),h[te]=e.readUint32BE(w,z+4)}for(var te=0;te<80;te++){var Z=S,Y=A,ee=R,N=q,T=E,D=I,c=_,b=v,H=d,k=o,he=f,be=C,de=F,me=K,Le=G,Ae=J;if(x=v,P=J,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=(E>>>14|F<<32-14)^(E>>>18|F<<32-18)^(F>>>41-32|E<<32-(41-32)),P=(F>>>14|E<<32-14)^(F>>>18|E<<32-18)^(E>>>41-32|F<<32-(41-32)),U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,x=E&I^~E&_,P=F&K^~F&G,U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,x=n[te*2],P=n[te*2+1],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,x=u[te%16],P=h[te%16],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,W=L&65535|B<<16,j=U&65535|M<<16,x=W,P=j,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=(S>>>28|d<<32-28)^(d>>>34-32|S<<32-(34-32))^(d>>>39-32|S<<32-(39-32)),P=(d>>>28|S<<32-28)^(S>>>34-32|d<<32-(34-32))^(S>>>39-32|d<<32-(39-32)),U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,x=S&A^S&R^A&R,P=d&o^d&f^o&f,U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,b=L&65535|B<<16,Ae=U&65535|M<<16,x=N,P=be,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=W,P=j,U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,N=L&65535|B<<16,be=U&65535|M<<16,A=Z,R=Y,q=ee,E=N,I=T,_=D,v=c,S=b,o=H,f=k,C=he,F=be,K=de,G=me,J=Le,d=Ae,te%16===15)for(var z=0;z<16;z++)x=u[z],P=h[z],U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=u[(z+9)%16],P=h[(z+9)%16],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,W=u[(z+1)%16],j=h[(z+1)%16],x=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,P=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,W=u[(z+14)%16],j=h[(z+14)%16],x=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,P=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,u[z]=L&65535|B<<16,h[z]=U&65535|M<<16}x=S,P=d,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[0],P=p[0],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[0]=S=L&65535|B<<16,p[0]=d=U&65535|M<<16,x=A,P=o,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[1],P=p[1],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[1]=A=L&65535|B<<16,p[1]=o=U&65535|M<<16,x=R,P=f,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[2],P=p[2],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[2]=R=L&65535|B<<16,p[2]=f=U&65535|M<<16,x=q,P=C,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[3],P=p[3],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[3]=q=L&65535|B<<16,p[3]=C=U&65535|M<<16,x=E,P=F,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[4],P=p[4],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[4]=E=L&65535|B<<16,p[4]=F=U&65535|M<<16,x=I,P=K,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[5],P=p[5],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[5]=I=L&65535|B<<16,p[5]=K=U&65535|M<<16,x=_,P=G,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[6],P=p[6],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[6]=_=L&65535|B<<16,p[6]=G=U&65535|M<<16,x=v,P=J,U=P&65535,M=P>>>16,L=x&65535,B=x>>>16,x=l[7],P=p[7],U+=P&65535,M+=P>>>16,L+=x&65535,B+=x>>>16,M+=U>>>16,L+=M>>>16,B+=L>>>16,l[7]=v=L&65535|B<<16,p[7]=J=U&65535|M<<16,y+=128,m-=128}return y}function a(u){var h=new i;h.update(u);var l=h.digest();return h.clean(),l}t.hash=a})(Rs),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ir,r=Rs,i=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(N){const T=new Float64Array(16);if(N)for(let D=0;D<N.length;D++)T[D]=N[D];return T}const s=new Uint8Array(32);s[0]=9;const a=n(),u=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(N,T){for(let D=0;D<16;D++)N[D]=T[D]|0}function S(N){let T=1;for(let D=0;D<16;D++){let c=N[D]+T+65535;T=Math.floor(c/65536),N[D]=c-T*65536}N[0]+=T-1+37*(T-1)}function A(N,T,D){const c=~(D-1);for(let b=0;b<16;b++){const H=c&(N[b]^T[b]);N[b]^=H,T[b]^=H}}function R(N,T){const D=n(),c=n();for(let b=0;b<16;b++)c[b]=T[b];S(c),S(c),S(c);for(let b=0;b<2;b++){D[0]=c[0]-65517;for(let k=1;k<15;k++)D[k]=c[k]-65535-(D[k-1]>>16&1),D[k-1]&=65535;D[15]=c[15]-32767-(D[14]>>16&1);const H=D[15]>>16&1;D[14]&=65535,A(c,D,1-H)}for(let b=0;b<16;b++)N[2*b]=c[b]&255,N[2*b+1]=c[b]>>8}function q(N,T){let D=0;for(let c=0;c<32;c++)D|=N[c]^T[c];return(1&D-1>>>8)-1}function E(N,T){const D=new Uint8Array(32),c=new Uint8Array(32);return R(D,N),R(c,T),q(D,c)}function I(N){const T=new Uint8Array(32);return R(T,N),T[0]&1}function _(N,T){for(let D=0;D<16;D++)N[D]=T[2*D]+(T[2*D+1]<<8);N[15]&=32767}function v(N,T,D){for(let c=0;c<16;c++)N[c]=T[c]+D[c]}function d(N,T,D){for(let c=0;c<16;c++)N[c]=T[c]-D[c]}function o(N,T,D){let c,b,H=0,k=0,he=0,be=0,de=0,me=0,Le=0,Ae=0,ye=0,pe=0,fe=0,ue=0,ce=0,ae=0,oe=0,re=0,le=0,ge=0,ne=0,ve=0,we=0,Se=0,De=0,Ee=0,Et=0,Tt=0,$t=0,gt=0,Xt=0,$r=0,fi=0,Me=D[0],Re=D[1],je=D[2],Be=D[3],ze=D[4],Ce=D[5],Ge=D[6],We=D[7],ke=D[8],Ye=D[9],Xe=D[10],Ke=D[11],qe=D[12],Ne=D[13],Je=D[14],Qe=D[15];c=T[0],H+=c*Me,k+=c*Re,he+=c*je,be+=c*Be,de+=c*ze,me+=c*Ce,Le+=c*Ge,Ae+=c*We,ye+=c*ke,pe+=c*Ye,fe+=c*Xe,ue+=c*Ke,ce+=c*qe,ae+=c*Ne,oe+=c*Je,re+=c*Qe,c=T[1],k+=c*Me,he+=c*Re,be+=c*je,de+=c*Be,me+=c*ze,Le+=c*Ce,Ae+=c*Ge,ye+=c*We,pe+=c*ke,fe+=c*Ye,ue+=c*Xe,ce+=c*Ke,ae+=c*qe,oe+=c*Ne,re+=c*Je,le+=c*Qe,c=T[2],he+=c*Me,be+=c*Re,de+=c*je,me+=c*Be,Le+=c*ze,Ae+=c*Ce,ye+=c*Ge,pe+=c*We,fe+=c*ke,ue+=c*Ye,ce+=c*Xe,ae+=c*Ke,oe+=c*qe,re+=c*Ne,le+=c*Je,ge+=c*Qe,c=T[3],be+=c*Me,de+=c*Re,me+=c*je,Le+=c*Be,Ae+=c*ze,ye+=c*Ce,pe+=c*Ge,fe+=c*We,ue+=c*ke,ce+=c*Ye,ae+=c*Xe,oe+=c*Ke,re+=c*qe,le+=c*Ne,ge+=c*Je,ne+=c*Qe,c=T[4],de+=c*Me,me+=c*Re,Le+=c*je,Ae+=c*Be,ye+=c*ze,pe+=c*Ce,fe+=c*Ge,ue+=c*We,ce+=c*ke,ae+=c*Ye,oe+=c*Xe,re+=c*Ke,le+=c*qe,ge+=c*Ne,ne+=c*Je,ve+=c*Qe,c=T[5],me+=c*Me,Le+=c*Re,Ae+=c*je,ye+=c*Be,pe+=c*ze,fe+=c*Ce,ue+=c*Ge,ce+=c*We,ae+=c*ke,oe+=c*Ye,re+=c*Xe,le+=c*Ke,ge+=c*qe,ne+=c*Ne,ve+=c*Je,we+=c*Qe,c=T[6],Le+=c*Me,Ae+=c*Re,ye+=c*je,pe+=c*Be,fe+=c*ze,ue+=c*Ce,ce+=c*Ge,ae+=c*We,oe+=c*ke,re+=c*Ye,le+=c*Xe,ge+=c*Ke,ne+=c*qe,ve+=c*Ne,we+=c*Je,Se+=c*Qe,c=T[7],Ae+=c*Me,ye+=c*Re,pe+=c*je,fe+=c*Be,ue+=c*ze,ce+=c*Ce,ae+=c*Ge,oe+=c*We,re+=c*ke,le+=c*Ye,ge+=c*Xe,ne+=c*Ke,ve+=c*qe,we+=c*Ne,Se+=c*Je,De+=c*Qe,c=T[8],ye+=c*Me,pe+=c*Re,fe+=c*je,ue+=c*Be,ce+=c*ze,ae+=c*Ce,oe+=c*Ge,re+=c*We,le+=c*ke,ge+=c*Ye,ne+=c*Xe,ve+=c*Ke,we+=c*qe,Se+=c*Ne,De+=c*Je,Ee+=c*Qe,c=T[9],pe+=c*Me,fe+=c*Re,ue+=c*je,ce+=c*Be,ae+=c*ze,oe+=c*Ce,re+=c*Ge,le+=c*We,ge+=c*ke,ne+=c*Ye,ve+=c*Xe,we+=c*Ke,Se+=c*qe,De+=c*Ne,Ee+=c*Je,Et+=c*Qe,c=T[10],fe+=c*Me,ue+=c*Re,ce+=c*je,ae+=c*Be,oe+=c*ze,re+=c*Ce,le+=c*Ge,ge+=c*We,ne+=c*ke,ve+=c*Ye,we+=c*Xe,Se+=c*Ke,De+=c*qe,Ee+=c*Ne,Et+=c*Je,Tt+=c*Qe,c=T[11],ue+=c*Me,ce+=c*Re,ae+=c*je,oe+=c*Be,re+=c*ze,le+=c*Ce,ge+=c*Ge,ne+=c*We,ve+=c*ke,we+=c*Ye,Se+=c*Xe,De+=c*Ke,Ee+=c*qe,Et+=c*Ne,Tt+=c*Je,$t+=c*Qe,c=T[12],ce+=c*Me,ae+=c*Re,oe+=c*je,re+=c*Be,le+=c*ze,ge+=c*Ce,ne+=c*Ge,ve+=c*We,we+=c*ke,Se+=c*Ye,De+=c*Xe,Ee+=c*Ke,Et+=c*qe,Tt+=c*Ne,$t+=c*Je,gt+=c*Qe,c=T[13],ae+=c*Me,oe+=c*Re,re+=c*je,le+=c*Be,ge+=c*ze,ne+=c*Ce,ve+=c*Ge,we+=c*We,Se+=c*ke,De+=c*Ye,Ee+=c*Xe,Et+=c*Ke,Tt+=c*qe,$t+=c*Ne,gt+=c*Je,Xt+=c*Qe,c=T[14],oe+=c*Me,re+=c*Re,le+=c*je,ge+=c*Be,ne+=c*ze,ve+=c*Ce,we+=c*Ge,Se+=c*We,De+=c*ke,Ee+=c*Ye,Et+=c*Xe,Tt+=c*Ke,$t+=c*qe,gt+=c*Ne,Xt+=c*Je,$r+=c*Qe,c=T[15],re+=c*Me,le+=c*Re,ge+=c*je,ne+=c*Be,ve+=c*ze,we+=c*Ce,Se+=c*Ge,De+=c*We,Ee+=c*ke,Et+=c*Ye,Tt+=c*Xe,$t+=c*Ke,gt+=c*qe,Xt+=c*Ne,$r+=c*Je,fi+=c*Qe,H+=38*le,k+=38*ge,he+=38*ne,be+=38*ve,de+=38*we,me+=38*Se,Le+=38*De,Ae+=38*Ee,ye+=38*Et,pe+=38*Tt,fe+=38*$t,ue+=38*gt,ce+=38*Xt,ae+=38*$r,oe+=38*fi,b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=k+b+65535,b=Math.floor(c/65536),k=c-b*65536,c=he+b+65535,b=Math.floor(c/65536),he=c-b*65536,c=be+b+65535,b=Math.floor(c/65536),be=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,c=Le+b+65535,b=Math.floor(c/65536),Le=c-b*65536,c=Ae+b+65535,b=Math.floor(c/65536),Ae=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,c=pe+b+65535,b=Math.floor(c/65536),pe=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=ce+b+65535,b=Math.floor(c/65536),ce=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,H+=b-1+37*(b-1),b=1,c=H+b+65535,b=Math.floor(c/65536),H=c-b*65536,c=k+b+65535,b=Math.floor(c/65536),k=c-b*65536,c=he+b+65535,b=Math.floor(c/65536),he=c-b*65536,c=be+b+65535,b=Math.floor(c/65536),be=c-b*65536,c=de+b+65535,b=Math.floor(c/65536),de=c-b*65536,c=me+b+65535,b=Math.floor(c/65536),me=c-b*65536,c=Le+b+65535,b=Math.floor(c/65536),Le=c-b*65536,c=Ae+b+65535,b=Math.floor(c/65536),Ae=c-b*65536,c=ye+b+65535,b=Math.floor(c/65536),ye=c-b*65536,c=pe+b+65535,b=Math.floor(c/65536),pe=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=ue+b+65535,b=Math.floor(c/65536),ue=c-b*65536,c=ce+b+65535,b=Math.floor(c/65536),ce=c-b*65536,c=ae+b+65535,b=Math.floor(c/65536),ae=c-b*65536,c=oe+b+65535,b=Math.floor(c/65536),oe=c-b*65536,c=re+b+65535,b=Math.floor(c/65536),re=c-b*65536,H+=b-1+37*(b-1),N[0]=H,N[1]=k,N[2]=he,N[3]=be,N[4]=de,N[5]=me,N[6]=Le,N[7]=Ae,N[8]=ye,N[9]=pe,N[10]=fe,N[11]=ue,N[12]=ce,N[13]=ae,N[14]=oe,N[15]=re}function f(N,T){o(N,T,T)}function C(N,T){const D=n();let c;for(c=0;c<16;c++)D[c]=T[c];for(c=253;c>=0;c--)f(D,D),c!==2&&c!==4&&o(D,D,T);for(c=0;c<16;c++)N[c]=D[c]}function F(N,T){const D=n();let c;for(c=0;c<16;c++)D[c]=T[c];for(c=250;c>=0;c--)f(D,D),c!==1&&o(D,D,T);for(c=0;c<16;c++)N[c]=D[c]}function K(N,T){const D=n(),c=n(),b=n(),H=n(),k=n(),he=n(),be=n(),de=n(),me=n();d(D,N[1],N[0]),d(me,T[1],T[0]),o(D,D,me),v(c,N[0],N[1]),v(me,T[0],T[1]),o(c,c,me),o(b,N[3],T[3]),o(b,b,l),o(H,N[2],T[2]),v(H,H,H),d(k,c,D),d(he,H,b),v(be,H,b),v(de,c,D),o(N[0],k,he),o(N[1],de,be),o(N[2],be,he),o(N[3],k,de)}function G(N,T,D){for(let c=0;c<4;c++)A(N[c],T[c],D)}function J(N,T){const D=n(),c=n(),b=n();C(b,T[2]),o(D,T[0],b),o(c,T[1],b),R(N,c),N[31]^=I(D)<<7}function x(N,T,D){m(N[0],a),m(N[1],u),m(N[2],u),m(N[3],a);for(let c=255;c>=0;--c){const b=D[c/8|0]>>(c&7)&1;G(N,T,b),K(T,N),K(N,N),G(N,T,b)}}function P(N,T){const D=[n(),n(),n(),n()];m(D[0],p),m(D[1],w),m(D[2],u),o(D[3],p,w),x(N,D,T)}function W(N){if(N.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const T=(0,r.hash)(N);T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(32),c=[n(),n(),n(),n()];P(c,T),J(D,c);const b=new Uint8Array(64);return b.set(N),b.set(D,32),{publicKey:D,secretKey:b}}t.generateKeyPairFromSeed=W;function j(N){const T=(0,e.randomBytes)(32,N),D=W(T);return(0,i.wipe)(T),D}t.generateKeyPair=j;function U(N){if(N.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}t.extractPublicKeyFromSecretKey=U;const M=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function L(N,T){let D,c,b,H;for(c=63;c>=32;--c){for(D=0,b=c-32,H=c-12;b<H;++b)T[b]+=D-16*T[c]*M[b-(c-32)],D=Math.floor((T[b]+128)/256),T[b]-=D*256;T[b]+=D,T[c]=0}for(D=0,b=0;b<32;b++)T[b]+=D-(T[31]>>4)*M[b],D=T[b]>>8,T[b]&=255;for(b=0;b<32;b++)T[b]-=D*M[b];for(c=0;c<32;c++)T[c+1]+=T[c]>>8,N[c]=T[c]&255}function B(N){const T=new Float64Array(64);for(let D=0;D<64;D++)T[D]=N[D];for(let D=0;D<64;D++)N[D]=0;L(N,T)}function te(N,T){const D=new Float64Array(64),c=[n(),n(),n(),n()],b=(0,r.hash)(N.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const H=new Uint8Array(64);H.set(b.subarray(32),32);const k=new r.SHA512;k.update(H.subarray(32)),k.update(T);const he=k.digest();k.clean(),B(he),P(c,he),J(H,c),k.reset(),k.update(H.subarray(0,32)),k.update(N.subarray(32)),k.update(T);const be=k.digest();B(be);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let me=0;me<32;me++)D[de+me]+=be[de]*b[me];return L(H.subarray(32),D),H}t.sign=te;function z(N,T){const D=n(),c=n(),b=n(),H=n(),k=n(),he=n(),be=n();return m(N[2],u),_(N[1],T),f(b,N[1]),o(H,b,h),d(b,b,N[2]),v(H,N[2],H),f(k,H),f(he,k),o(be,he,k),o(D,be,b),o(D,D,H),F(D,D),o(D,D,b),o(D,D,H),o(D,D,H),o(N[0],D,H),f(c,N[0]),o(c,c,H),E(c,b)&&o(N[0],N[0],y),f(c,N[0]),o(c,c,H),E(c,b)?-1:(I(N[0])===T[31]>>7&&d(N[0],a,N[0]),o(N[3],N[0],N[1]),0)}function Z(N,T,D){const c=new Uint8Array(32),b=[n(),n(),n(),n()],H=[n(),n(),n(),n()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(H,N))return!1;const k=new r.SHA512;k.update(D.subarray(0,32)),k.update(N),k.update(T);const he=k.digest();return B(he),x(b,H,he),P(H,D.subarray(32)),K(b,H),J(c,b),!q(D,c)}t.verify=Z;function Y(N){let T=[n(),n(),n(),n()];if(z(T,N))throw new Error("Ed25519: invalid public key");let D=n(),c=n(),b=T[1];v(D,u,b),d(c,u,b),C(c,c),o(D,D,c);let H=new Uint8Array(32);return R(H,D),H}t.convertPublicKeyToX25519=Y;function ee(N){const T=(0,r.hash)(N.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const D=new Uint8Array(T.subarray(0,32));return(0,i.wipe)(T),D}t.convertSecretKeyToX25519=ee}(zi);const Wl="EdDSA",kl="JWT",Cs=".",Fs="base64url",Yl="utf8",Xl="utf8",Jl=":",Ql="did",Zl="key",Ls="base58btc",eh="z",th="K36",rh=32;function Gi(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Us(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Gi(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Wi(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Us(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return Gi(r)}function ih(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var u=t.length,h=t.charAt(0),l=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function w(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var A=0,R=0,q=0,E=S.length;q!==E&&S[q]===0;)q++,A++;for(var I=(E-q)*p+1>>>0,_=new Uint8Array(I);q!==E;){for(var v=S[q],d=0,o=I-1;(v!==0||d<R)&&o!==-1;o--,d++)v+=256*_[o]>>>0,_[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");R=d,q++}for(var f=I-R;f!==I&&_[f]===0;)f++;for(var C=h.repeat(A);f<I;++f)C+=t.charAt(_[f]);return C}function y(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var A=0;if(S[A]!==" "){for(var R=0,q=0;S[A]===h;)R++,A++;for(var E=(S.length-A)*l+1>>>0,I=new Uint8Array(E);S[A];){var _=r[S.charCodeAt(A)];if(_===255)return;for(var v=0,d=E-1;(_!==0||v<q)&&d!==-1;d--,v++)_+=u*I[d]>>>0,I[d]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");q=v,A++}if(S[A]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(R+(E-o)),C=R;o!==E;)f[C++]=I[o++];return f}}}function m(S){var A=y(S);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:y,decode:m}}var nh=ih,sh=nh;const $s=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},oh=t=>new TextEncoder().encode(t),ah=t=>new TextDecoder().decode(t);class ch{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class uh{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ms(this,e)}}class lh{constructor(e){this.decoders=e}or(e){return Ms(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ms=(t,e)=>new lh({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class hh{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new ch(e,r,i),this.decoder=new uh(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Xr=({name:t,prefix:e,encode:r,decode:i})=>new hh(t,e,r,i),Sr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=sh(r,e);return Xr({prefix:t,name:e,encode:i,decode:s=>$s(n(s))})},fh=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let u=0,h=0,l=0;for(let p=0;p<s;++p){const w=n[t[p]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|w,u+=r,u>=8&&(u-=8,a[l++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return a},dh=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,u=0;for(let h=0;h<t.length;++h)for(u=u<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&u>>a];if(a&&(s+=e[n&u<<r-a]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Xr({prefix:e,name:t,encode(n){return dh(n,i,r)},decode(n){return fh(n,i,r,t)}}),ph=Xr({prefix:"\0",name:"identity",encode:t=>ah(t),decode:t=>oh(t)});var gh=Object.freeze({__proto__:null,identity:ph});const yh=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var _h=Object.freeze({__proto__:null,base2:yh});const bh=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var vh=Object.freeze({__proto__:null,base8:bh});const wh=Sr({prefix:"9",name:"base10",alphabet:"0123456789"});var mh=Object.freeze({__proto__:null,base10:wh});const Eh=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Sh=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Dh=Object.freeze({__proto__:null,base16:Eh,base16upper:Sh});const Oh=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),xh=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ih=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Th=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Nh=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ph=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ah=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Rh=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ch=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Fh=Object.freeze({__proto__:null,base32:Oh,base32upper:xh,base32pad:Ih,base32padupper:Th,base32hex:Nh,base32hexupper:Ph,base32hexpad:Ah,base32hexpadupper:Rh,base32z:Ch});const Lh=Sr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Uh=Sr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $h=Object.freeze({__proto__:null,base36:Lh,base36upper:Uh});const Mh=Sr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jh=Sr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Bh=Object.freeze({__proto__:null,base58btc:Mh,base58flickr:jh});const zh=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qh=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Kh=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hh=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Vh=Object.freeze({__proto__:null,base64:zh,base64pad:qh,base64url:Kh,base64urlpad:Hh});const js=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Gh=js.reduce((t,e,r)=>(t[r]=e,t),[]),Wh=js.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function kh(t){return t.reduce((e,r)=>(e+=Gh[r],e),"")}function Yh(t){const e=[];for(const r of t){const i=Wh[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Xh=Xr({prefix:"\u{1F680}",name:"base256emoji",encode:kh,decode:Yh});var Jh=Object.freeze({__proto__:null,base256emoji:Xh}),Qh=zs,Bs=128,Zh=127,ef=~Zh,tf=Math.pow(2,31);function zs(t,e,r){e=e||[],r=r||0;for(var i=r;t>=tf;)e[r++]=t&255|Bs,t/=128;for(;t&ef;)e[r++]=t&255|Bs,t>>>=7;return e[r]=t|0,zs.bytes=r-i+1,e}var rf=ki,nf=128,qs=127;function ki(t,i){var r=0,i=i||0,n=0,s=i,a,u=t.length;do{if(s>=u)throw ki.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&qs)<<n:(a&qs)*Math.pow(2,n),n+=7}while(a>=nf);return ki.bytes=s-i,r}var sf=Math.pow(2,7),of=Math.pow(2,14),af=Math.pow(2,21),cf=Math.pow(2,28),uf=Math.pow(2,35),lf=Math.pow(2,42),hf=Math.pow(2,49),ff=Math.pow(2,56),df=Math.pow(2,63),pf=function(t){return t<sf?1:t<of?2:t<af?3:t<cf?4:t<uf?5:t<lf?6:t<hf?7:t<ff?8:t<df?9:10},gf={encode:Qh,decode:rf,encodingLength:pf},Ks=gf;const Hs=(t,e,r=0)=>(Ks.encode(t,e,r),e),Vs=t=>Ks.encodingLength(t),Yi=(t,e)=>{const r=e.byteLength,i=Vs(t),n=i+Vs(r),s=new Uint8Array(n+r);return Hs(t,s,0),Hs(r,s,i),s.set(e,n),new yf(t,r,e,s)};class yf{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Gs=({name:t,code:e,encode:r})=>new _f(t,e,r);class _f{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Yi(this.code,r):r.then(i=>Yi(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Ws=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bf=Gs({name:"sha2-256",code:18,encode:Ws("SHA-256")}),vf=Gs({name:"sha2-512",code:19,encode:Ws("SHA-512")});var wf=Object.freeze({__proto__:null,sha256:bf,sha512:vf});const ks=0,mf="identity",Ys=$s;var Ef=Object.freeze({__proto__:null,identity:{code:ks,name:mf,encode:Ys,digest:t=>Yi(ks,Ys(t))}});new TextEncoder,new TextDecoder;const Xs={...gh,..._h,...vh,...mh,...Dh,...Fh,...$h,...Bh,...Vh,...Jh};({...wf,...Ef});function Js(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Qs=Js("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Xi=Js("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Us(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Zs={utf8:Qs,"utf-8":Qs,hex:Xs.base16,latin1:Xi,ascii:Xi,binary:Xi,...Xs};function at(t,e="utf8"){const r=Zs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ft(t,e="utf8"){const r=Zs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Gi(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Jr(t){return at(ft(Bi(t),Yl),Fs)}function eo(t){const e=ft(th,Ls),r=eh+at(Wi([e,t]),Ls);return[Ql,Zl,r].join(Jl)}function Sf(t){return at(t,Fs)}function Df(t){return ft([Jr(t.header),Jr(t.payload)].join(Cs),Xl)}function Of(t){return[Jr(t.header),Jr(t.payload),Sf(t.signature)].join(Cs)}function to(t=ir.randomBytes(rh)){return zi.generateKeyPairFromSeed(t)}async function xf(t,e,r,i,n=Q.fromMiliseconds(Date.now())){const s={alg:Wl,typ:kl},a=eo(i.publicKey),u=n+r,h={iss:a,sub:t,aud:e,iat:n,exp:u},l=Df({header:s,payload:h}),p=zi.sign(i.secretKey,l);return Of({header:s,payload:h,signature:p})}var Ji={},Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});var nt=ie,Qi=pt,If=20;function Tf(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,a=1797285236,u=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],l=r[11]<<24|r[10]<<16|r[9]<<8|r[8],p=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],y=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],S=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],R=e[7]<<24|e[6]<<16|e[5]<<8|e[4],q=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],I=i,_=n,v=s,d=a,o=u,f=h,C=l,F=p,K=w,G=y,J=m,x=S,P=A,W=R,j=q,U=E,M=0;M<If;M+=2)I=I+o|0,P^=I,P=P>>>32-16|P<<16,K=K+P|0,o^=K,o=o>>>32-12|o<<12,_=_+f|0,W^=_,W=W>>>32-16|W<<16,G=G+W|0,f^=G,f=f>>>32-12|f<<12,v=v+C|0,j^=v,j=j>>>32-16|j<<16,J=J+j|0,C^=J,C=C>>>32-12|C<<12,d=d+F|0,U^=d,U=U>>>32-16|U<<16,x=x+U|0,F^=x,F=F>>>32-12|F<<12,v=v+C|0,j^=v,j=j>>>32-8|j<<8,J=J+j|0,C^=J,C=C>>>32-7|C<<7,d=d+F|0,U^=d,U=U>>>32-8|U<<8,x=x+U|0,F^=x,F=F>>>32-7|F<<7,_=_+f|0,W^=_,W=W>>>32-8|W<<8,G=G+W|0,f^=G,f=f>>>32-7|f<<7,I=I+o|0,P^=I,P=P>>>32-8|P<<8,K=K+P|0,o^=K,o=o>>>32-7|o<<7,I=I+f|0,U^=I,U=U>>>32-16|U<<16,J=J+U|0,f^=J,f=f>>>32-12|f<<12,_=_+C|0,P^=_,P=P>>>32-16|P<<16,x=x+P|0,C^=x,C=C>>>32-12|C<<12,v=v+F|0,W^=v,W=W>>>32-16|W<<16,K=K+W|0,F^=K,F=F>>>32-12|F<<12,d=d+o|0,j^=d,j=j>>>32-16|j<<16,G=G+j|0,o^=G,o=o>>>32-12|o<<12,v=v+F|0,W^=v,W=W>>>32-8|W<<8,K=K+W|0,F^=K,F=F>>>32-7|F<<7,d=d+o|0,j^=d,j=j>>>32-8|j<<8,G=G+j|0,o^=G,o=o>>>32-7|o<<7,_=_+C|0,P^=_,P=P>>>32-8|P<<8,x=x+P|0,C^=x,C=C>>>32-7|C<<7,I=I+f|0,U^=I,U=U>>>32-8|U<<8,J=J+U|0,f^=J,f=f>>>32-7|f<<7;nt.writeUint32LE(I+i|0,t,0),nt.writeUint32LE(_+n|0,t,4),nt.writeUint32LE(v+s|0,t,8),nt.writeUint32LE(d+a|0,t,12),nt.writeUint32LE(o+u|0,t,16),nt.writeUint32LE(f+h|0,t,20),nt.writeUint32LE(C+l|0,t,24),nt.writeUint32LE(F+p|0,t,28),nt.writeUint32LE(K+w|0,t,32),nt.writeUint32LE(G+y|0,t,36),nt.writeUint32LE(J+m|0,t,40),nt.writeUint32LE(x+S|0,t,44),nt.writeUint32LE(P+A|0,t,48),nt.writeUint32LE(W+R|0,t,52),nt.writeUint32LE(j+q|0,t,56),nt.writeUint32LE(U+E|0,t,60)}function ro(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=n}for(var u=new Uint8Array(64),h=0;h<r.length;h+=64){Tf(u,s,t);for(var l=h;l<h+64&&l<r.length;l++)i[l]=r[l]^u[l-h];Pf(s,0,a)}return Qi.wipe(u),n===0&&Qi.wipe(s),i}Qr.streamXOR=ro;function Nf(t,e,r,i){return i===void 0&&(i=0),Qi.wipe(r),ro(t,e,r,r,i)}Qr.stream=Nf;function Pf(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var io={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});function Af(t,e,r){return~(t-1)&e|t-1&r}Ft.select=Af;function Rf(t,e){return(t|0)-(e|0)-1>>>31&1}Ft.lessOrEqual=Rf;function no(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Ft.compare=no;function Cf(t,e){return t.length===0||e.length===0?!1:no(t,e)!==0}Ft.equal=Cf,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ft,r=pt;t.DIGEST_LENGTH=16;var i=function(){function a(u){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=u[0]|u[1]<<8;this._r[0]=h&8191;var l=u[2]|u[3]<<8;this._r[1]=(h>>>13|l<<3)&8191;var p=u[4]|u[5]<<8;this._r[2]=(l>>>10|p<<6)&7939;var w=u[6]|u[7]<<8;this._r[3]=(p>>>7|w<<9)&8191;var y=u[8]|u[9]<<8;this._r[4]=(w>>>4|y<<12)&255,this._r[5]=y>>>1&8190;var m=u[10]|u[11]<<8;this._r[6]=(y>>>14|m<<2)&8191;var S=u[12]|u[13]<<8;this._r[7]=(m>>>11|S<<5)&8065;var A=u[14]|u[15]<<8;this._r[8]=(S>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return a.prototype._blocks=function(u,h,l){for(var p=this._fin?0:2048,w=this._h[0],y=this._h[1],m=this._h[2],S=this._h[3],A=this._h[4],R=this._h[5],q=this._h[6],E=this._h[7],I=this._h[8],_=this._h[9],v=this._r[0],d=this._r[1],o=this._r[2],f=this._r[3],C=this._r[4],F=this._r[5],K=this._r[6],G=this._r[7],J=this._r[8],x=this._r[9];l>=16;){var P=u[h+0]|u[h+1]<<8;w+=P&8191;var W=u[h+2]|u[h+3]<<8;y+=(P>>>13|W<<3)&8191;var j=u[h+4]|u[h+5]<<8;m+=(W>>>10|j<<6)&8191;var U=u[h+6]|u[h+7]<<8;S+=(j>>>7|U<<9)&8191;var M=u[h+8]|u[h+9]<<8;A+=(U>>>4|M<<12)&8191,R+=M>>>1&8191;var L=u[h+10]|u[h+11]<<8;q+=(M>>>14|L<<2)&8191;var B=u[h+12]|u[h+13]<<8;E+=(L>>>11|B<<5)&8191;var te=u[h+14]|u[h+15]<<8;I+=(B>>>8|te<<8)&8191,_+=te>>>5|p;var z=0,Z=z;Z+=w*v,Z+=y*(5*x),Z+=m*(5*J),Z+=S*(5*G),Z+=A*(5*K),z=Z>>>13,Z&=8191,Z+=R*(5*F),Z+=q*(5*C),Z+=E*(5*f),Z+=I*(5*o),Z+=_*(5*d),z+=Z>>>13,Z&=8191;var Y=z;Y+=w*d,Y+=y*v,Y+=m*(5*x),Y+=S*(5*J),Y+=A*(5*G),z=Y>>>13,Y&=8191,Y+=R*(5*K),Y+=q*(5*F),Y+=E*(5*C),Y+=I*(5*f),Y+=_*(5*o),z+=Y>>>13,Y&=8191;var ee=z;ee+=w*o,ee+=y*d,ee+=m*v,ee+=S*(5*x),ee+=A*(5*J),z=ee>>>13,ee&=8191,ee+=R*(5*G),ee+=q*(5*K),ee+=E*(5*F),ee+=I*(5*C),ee+=_*(5*f),z+=ee>>>13,ee&=8191;var N=z;N+=w*f,N+=y*o,N+=m*d,N+=S*v,N+=A*(5*x),z=N>>>13,N&=8191,N+=R*(5*J),N+=q*(5*G),N+=E*(5*K),N+=I*(5*F),N+=_*(5*C),z+=N>>>13,N&=8191;var T=z;T+=w*C,T+=y*f,T+=m*o,T+=S*d,T+=A*v,z=T>>>13,T&=8191,T+=R*(5*x),T+=q*(5*J),T+=E*(5*G),T+=I*(5*K),T+=_*(5*F),z+=T>>>13,T&=8191;var D=z;D+=w*F,D+=y*C,D+=m*f,D+=S*o,D+=A*d,z=D>>>13,D&=8191,D+=R*v,D+=q*(5*x),D+=E*(5*J),D+=I*(5*G),D+=_*(5*K),z+=D>>>13,D&=8191;var c=z;c+=w*K,c+=y*F,c+=m*C,c+=S*f,c+=A*o,z=c>>>13,c&=8191,c+=R*d,c+=q*v,c+=E*(5*x),c+=I*(5*J),c+=_*(5*G),z+=c>>>13,c&=8191;var b=z;b+=w*G,b+=y*K,b+=m*F,b+=S*C,b+=A*f,z=b>>>13,b&=8191,b+=R*o,b+=q*d,b+=E*v,b+=I*(5*x),b+=_*(5*J),z+=b>>>13,b&=8191;var H=z;H+=w*J,H+=y*G,H+=m*K,H+=S*F,H+=A*C,z=H>>>13,H&=8191,H+=R*f,H+=q*o,H+=E*d,H+=I*v,H+=_*(5*x),z+=H>>>13,H&=8191;var k=z;k+=w*x,k+=y*J,k+=m*G,k+=S*K,k+=A*F,z=k>>>13,k&=8191,k+=R*C,k+=q*f,k+=E*o,k+=I*d,k+=_*v,z+=k>>>13,k&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,Y+=z,w=Z,y=Y,m=ee,S=N,A=T,R=D,q=c,E=b,I=H,_=k,h+=16,l-=16}this._h[0]=w,this._h[1]=y,this._h[2]=m,this._h[3]=S,this._h[4]=A,this._h[5]=R,this._h[6]=q,this._h[7]=E,this._h[8]=I,this._h[9]=_},a.prototype.finish=function(u,h){h===void 0&&(h=0);var l=new Uint16Array(10),p,w,y,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(p=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=p,p=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=p*5,p=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=p,p=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=p,l[0]=this._h[0]+5,p=l[0]>>>13,l[0]&=8191,m=1;m<10;m++)l[m]=this._h[m]+p,p=l[m]>>>13,l[m]&=8191;for(l[9]-=1<<13,w=(p^1)-1,m=0;m<10;m++)l[m]&=w;for(w=~w,m=0;m<10;m++)this._h[m]=this._h[m]&w|l[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,y=this._h[0]+this._pad[0],this._h[0]=y&65535,m=1;m<8;m++)y=(this._h[m]+this._pad[m]|0)+(y>>>16)|0,this._h[m]=y&65535;return u[h+0]=this._h[0]>>>0,u[h+1]=this._h[0]>>>8,u[h+2]=this._h[1]>>>0,u[h+3]=this._h[1]>>>8,u[h+4]=this._h[2]>>>0,u[h+5]=this._h[2]>>>8,u[h+6]=this._h[3]>>>0,u[h+7]=this._h[3]>>>8,u[h+8]=this._h[4]>>>0,u[h+9]=this._h[4]>>>8,u[h+10]=this._h[5]>>>0,u[h+11]=this._h[5]>>>8,u[h+12]=this._h[6]>>>0,u[h+13]=this._h[6]>>>8,u[h+14]=this._h[7]>>>0,u[h+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(u){var h=0,l=u.length,p;if(this._leftover){p=16-this._leftover,p>l&&(p=l);for(var w=0;w<p;w++)this._buffer[this._leftover+w]=u[h+w];if(l-=p,h+=p,this._leftover+=p,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(l>=16&&(p=l-l%16,this._blocks(u,h,p),h+=p,l-=p),l){for(var w=0;w<l;w++)this._buffer[this._leftover+w]=u[h+w];this._leftover+=l}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=i;function n(a,u){var h=new i(a);h.update(u);var l=h.digest();return h.clean(),l}t.oneTimeAuth=n;function s(a,u){return a.length!==t.DIGEST_LENGTH||u.length!==t.DIGEST_LENGTH?!1:e.equal(a,u)}t.equal=s}(io),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Qr,r=io,i=pt,n=ie,s=Ft;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),u=function(){function h(l){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,l.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(l)}return h.prototype.seal=function(l,p,w,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(l,m.length-l.length);var S=new Uint8Array(32);e.stream(this._key,m,S,4);var A=p.length+this.tagLength,R;if(y){if(y.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");R=y}else R=new Uint8Array(A);return e.streamXOR(this._key,m,p,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),S,R.subarray(0,R.length-this.tagLength),w),i.wipe(m),R},h.prototype.open=function(l,p,w,y){if(l.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(p.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(l,m.length-l.length);var S=new Uint8Array(32);e.stream(this._key,m,S,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,S,p.subarray(0,p.length-this.tagLength),w),!s.equal(A,p.subarray(p.length-this.tagLength,p.length)))return null;var R=p.length-this.tagLength,q;if(y){if(y.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");q=y}else q=new Uint8Array(R);return e.streamXOR(this._key,m,p.subarray(0,p.length-this.tagLength),q,4),i.wipe(m),q},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(l,p,w,y){var m=new r.Poly1305(p);y&&(m.update(y),y.length%16>0&&m.update(a.subarray(y.length%16))),m.update(w),w.length%16>0&&m.update(a.subarray(w.length%16));var S=new Uint8Array(8);y&&n.writeUint64LE(y.length,S),m.update(S),n.writeUint64LE(w.length,S),m.update(S);for(var A=m.digest(),R=0;R<A.length;R++)l[R]=A[R];m.clean(),i.wipe(A),i.wipe(S)},h}();t.ChaCha20Poly1305=u}(Ji);var so={},Dr={},Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});function Ff(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Zi.isSerializableHash=Ff,Object.defineProperty(Dr,"__esModule",{value:!0});var Dt=Zi,Lf=Ft,Uf=pt,oo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Dt.isSerializableHash(this._inner)&&Dt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Uf.wipe(i)}return t.prototype.reset=function(){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Dt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Dt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Dr.HMAC=oo;function $f(t,e,r){var i=new oo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Dr.hmac=$f,Dr.equal=Lf.equal,Object.defineProperty(so,"__esModule",{value:!0});var ao=Dr,co=pt,Mf=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=ao.hmac(this._hash,i,r);this._hmac=new ao.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),co.wipe(this._buffer),co.wipe(this._counter),this._bufpos=0},t}(),jf=so.HKDF=Mf,Zr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ie,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function u(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},u.prototype.update=function(h,l){if(l===void 0&&(l=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var p=0;if(this._bytesHashed+=l,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&l>0;)this._buffer[this._bufferLength++]=h[p++],l--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(l>=this.blockSize&&(p=s(this._temp,this._state,h,p,l),l%=this.blockSize);l>0;)this._buffer[this._bufferLength++]=h[p++],l--;return this},u.prototype.finish=function(h){if(!this._finished){var l=this._bytesHashed,p=this._bufferLength,w=l/536870912|0,y=l<<3,m=l%64<56?64:128;this._buffer[p]=128;for(var S=p+1;S<m-8;S++)this._buffer[S]=0;e.writeUint32BE(w,this._buffer,m-8),e.writeUint32BE(y,this._buffer,m-4),s(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],h,S*4);return this},u.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},u}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(u,h,l,p,w){for(;w>=64;){for(var y=h[0],m=h[1],S=h[2],A=h[3],R=h[4],q=h[5],E=h[6],I=h[7],_=0;_<16;_++){var v=p+_*4;u[_]=e.readUint32BE(l,v)}for(var _=16;_<64;_++){var d=u[_-2],o=(d>>>17|d<<32-17)^(d>>>19|d<<32-19)^d>>>10;d=u[_-15];var f=(d>>>7|d<<32-7)^(d>>>18|d<<32-18)^d>>>3;u[_]=(o+u[_-7]|0)+(f+u[_-16]|0)}for(var _=0;_<64;_++){var o=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&q^~R&E)|0)+(I+(n[_]+u[_]|0)|0)|0,f=((y>>>2|y<<32-2)^(y>>>13|y<<32-13)^(y>>>22|y<<32-22))+(y&m^y&S^m&S)|0;I=E,E=q,q=R,R=A+o|0,A=S,S=m,m=y,y=o+f|0}h[0]+=y,h[1]+=m,h[2]+=S,h[3]+=A,h[4]+=R,h[5]+=q,h[6]+=E,h[7]+=I,p+=64,w-=64}return p}function a(u){var h=new i;h.update(u);var l=h.digest();return h.clean(),l}t.hash=a})(Zr);var en={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ir,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(_){const v=new Float64Array(16);if(_)for(let d=0;d<_.length;d++)v[d]=_[d];return v}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function a(_){let v=1;for(let d=0;d<16;d++){let o=_[d]+v+65535;v=Math.floor(o/65536),_[d]=o-v*65536}_[0]+=v-1+37*(v-1)}function u(_,v,d){const o=~(d-1);for(let f=0;f<16;f++){const C=o&(_[f]^v[f]);_[f]^=C,v[f]^=C}}function h(_,v){const d=i(),o=i();for(let f=0;f<16;f++)o[f]=v[f];a(o),a(o),a(o);for(let f=0;f<2;f++){d[0]=o[0]-65517;for(let F=1;F<15;F++)d[F]=o[F]-65535-(d[F-1]>>16&1),d[F-1]&=65535;d[15]=o[15]-32767-(d[14]>>16&1);const C=d[15]>>16&1;d[14]&=65535,u(o,d,1-C)}for(let f=0;f<16;f++)_[2*f]=o[f]&255,_[2*f+1]=o[f]>>8}function l(_,v){for(let d=0;d<16;d++)_[d]=v[2*d]+(v[2*d+1]<<8);_[15]&=32767}function p(_,v,d){for(let o=0;o<16;o++)_[o]=v[o]+d[o]}function w(_,v,d){for(let o=0;o<16;o++)_[o]=v[o]-d[o]}function y(_,v,d){let o,f,C=0,F=0,K=0,G=0,J=0,x=0,P=0,W=0,j=0,U=0,M=0,L=0,B=0,te=0,z=0,Z=0,Y=0,ee=0,N=0,T=0,D=0,c=0,b=0,H=0,k=0,he=0,be=0,de=0,me=0,Le=0,Ae=0,ye=d[0],pe=d[1],fe=d[2],ue=d[3],ce=d[4],ae=d[5],oe=d[6],re=d[7],le=d[8],ge=d[9],ne=d[10],ve=d[11],we=d[12],Se=d[13],De=d[14],Ee=d[15];o=v[0],C+=o*ye,F+=o*pe,K+=o*fe,G+=o*ue,J+=o*ce,x+=o*ae,P+=o*oe,W+=o*re,j+=o*le,U+=o*ge,M+=o*ne,L+=o*ve,B+=o*we,te+=o*Se,z+=o*De,Z+=o*Ee,o=v[1],F+=o*ye,K+=o*pe,G+=o*fe,J+=o*ue,x+=o*ce,P+=o*ae,W+=o*oe,j+=o*re,U+=o*le,M+=o*ge,L+=o*ne,B+=o*ve,te+=o*we,z+=o*Se,Z+=o*De,Y+=o*Ee,o=v[2],K+=o*ye,G+=o*pe,J+=o*fe,x+=o*ue,P+=o*ce,W+=o*ae,j+=o*oe,U+=o*re,M+=o*le,L+=o*ge,B+=o*ne,te+=o*ve,z+=o*we,Z+=o*Se,Y+=o*De,ee+=o*Ee,o=v[3],G+=o*ye,J+=o*pe,x+=o*fe,P+=o*ue,W+=o*ce,j+=o*ae,U+=o*oe,M+=o*re,L+=o*le,B+=o*ge,te+=o*ne,z+=o*ve,Z+=o*we,Y+=o*Se,ee+=o*De,N+=o*Ee,o=v[4],J+=o*ye,x+=o*pe,P+=o*fe,W+=o*ue,j+=o*ce,U+=o*ae,M+=o*oe,L+=o*re,B+=o*le,te+=o*ge,z+=o*ne,Z+=o*ve,Y+=o*we,ee+=o*Se,N+=o*De,T+=o*Ee,o=v[5],x+=o*ye,P+=o*pe,W+=o*fe,j+=o*ue,U+=o*ce,M+=o*ae,L+=o*oe,B+=o*re,te+=o*le,z+=o*ge,Z+=o*ne,Y+=o*ve,ee+=o*we,N+=o*Se,T+=o*De,D+=o*Ee,o=v[6],P+=o*ye,W+=o*pe,j+=o*fe,U+=o*ue,M+=o*ce,L+=o*ae,B+=o*oe,te+=o*re,z+=o*le,Z+=o*ge,Y+=o*ne,ee+=o*ve,N+=o*we,T+=o*Se,D+=o*De,c+=o*Ee,o=v[7],W+=o*ye,j+=o*pe,U+=o*fe,M+=o*ue,L+=o*ce,B+=o*ae,te+=o*oe,z+=o*re,Z+=o*le,Y+=o*ge,ee+=o*ne,N+=o*ve,T+=o*we,D+=o*Se,c+=o*De,b+=o*Ee,o=v[8],j+=o*ye,U+=o*pe,M+=o*fe,L+=o*ue,B+=o*ce,te+=o*ae,z+=o*oe,Z+=o*re,Y+=o*le,ee+=o*ge,N+=o*ne,T+=o*ve,D+=o*we,c+=o*Se,b+=o*De,H+=o*Ee,o=v[9],U+=o*ye,M+=o*pe,L+=o*fe,B+=o*ue,te+=o*ce,z+=o*ae,Z+=o*oe,Y+=o*re,ee+=o*le,N+=o*ge,T+=o*ne,D+=o*ve,c+=o*we,b+=o*Se,H+=o*De,k+=o*Ee,o=v[10],M+=o*ye,L+=o*pe,B+=o*fe,te+=o*ue,z+=o*ce,Z+=o*ae,Y+=o*oe,ee+=o*re,N+=o*le,T+=o*ge,D+=o*ne,c+=o*ve,b+=o*we,H+=o*Se,k+=o*De,he+=o*Ee,o=v[11],L+=o*ye,B+=o*pe,te+=o*fe,z+=o*ue,Z+=o*ce,Y+=o*ae,ee+=o*oe,N+=o*re,T+=o*le,D+=o*ge,c+=o*ne,b+=o*ve,H+=o*we,k+=o*Se,he+=o*De,be+=o*Ee,o=v[12],B+=o*ye,te+=o*pe,z+=o*fe,Z+=o*ue,Y+=o*ce,ee+=o*ae,N+=o*oe,T+=o*re,D+=o*le,c+=o*ge,b+=o*ne,H+=o*ve,k+=o*we,he+=o*Se,be+=o*De,de+=o*Ee,o=v[13],te+=o*ye,z+=o*pe,Z+=o*fe,Y+=o*ue,ee+=o*ce,N+=o*ae,T+=o*oe,D+=o*re,c+=o*le,b+=o*ge,H+=o*ne,k+=o*ve,he+=o*we,be+=o*Se,de+=o*De,me+=o*Ee,o=v[14],z+=o*ye,Z+=o*pe,Y+=o*fe,ee+=o*ue,N+=o*ce,T+=o*ae,D+=o*oe,c+=o*re,b+=o*le,H+=o*ge,k+=o*ne,he+=o*ve,be+=o*we,de+=o*Se,me+=o*De,Le+=o*Ee,o=v[15],Z+=o*ye,Y+=o*pe,ee+=o*fe,N+=o*ue,T+=o*ce,D+=o*ae,c+=o*oe,b+=o*re,H+=o*le,k+=o*ge,he+=o*ne,be+=o*ve,de+=o*we,me+=o*Se,Le+=o*De,Ae+=o*Ee,C+=38*Y,F+=38*ee,K+=38*N,G+=38*T,J+=38*D,x+=38*c,P+=38*b,W+=38*H,j+=38*k,U+=38*he,M+=38*be,L+=38*de,B+=38*me,te+=38*Le,z+=38*Ae,f=1,o=C+f+65535,f=Math.floor(o/65536),C=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=J+f+65535,f=Math.floor(o/65536),J=o-f*65536,o=x+f+65535,f=Math.floor(o/65536),x=o-f*65536,o=P+f+65535,f=Math.floor(o/65536),P=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=L+f+65535,f=Math.floor(o/65536),L=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=z+f+65535,f=Math.floor(o/65536),z=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,C+=f-1+37*(f-1),f=1,o=C+f+65535,f=Math.floor(o/65536),C=o-f*65536,o=F+f+65535,f=Math.floor(o/65536),F=o-f*65536,o=K+f+65535,f=Math.floor(o/65536),K=o-f*65536,o=G+f+65535,f=Math.floor(o/65536),G=o-f*65536,o=J+f+65535,f=Math.floor(o/65536),J=o-f*65536,o=x+f+65535,f=Math.floor(o/65536),x=o-f*65536,o=P+f+65535,f=Math.floor(o/65536),P=o-f*65536,o=W+f+65535,f=Math.floor(o/65536),W=o-f*65536,o=j+f+65535,f=Math.floor(o/65536),j=o-f*65536,o=U+f+65535,f=Math.floor(o/65536),U=o-f*65536,o=M+f+65535,f=Math.floor(o/65536),M=o-f*65536,o=L+f+65535,f=Math.floor(o/65536),L=o-f*65536,o=B+f+65535,f=Math.floor(o/65536),B=o-f*65536,o=te+f+65535,f=Math.floor(o/65536),te=o-f*65536,o=z+f+65535,f=Math.floor(o/65536),z=o-f*65536,o=Z+f+65535,f=Math.floor(o/65536),Z=o-f*65536,C+=f-1+37*(f-1),_[0]=C,_[1]=F,_[2]=K,_[3]=G,_[4]=J,_[5]=x,_[6]=P,_[7]=W,_[8]=j,_[9]=U,_[10]=M,_[11]=L,_[12]=B,_[13]=te,_[14]=z,_[15]=Z}function m(_,v){y(_,v,v)}function S(_,v){const d=i();for(let o=0;o<16;o++)d[o]=v[o];for(let o=253;o>=0;o--)m(d,d),o!==2&&o!==4&&y(d,d,v);for(let o=0;o<16;o++)_[o]=d[o]}function A(_,v){const d=new Uint8Array(32),o=new Float64Array(80),f=i(),C=i(),F=i(),K=i(),G=i(),J=i();for(let j=0;j<31;j++)d[j]=_[j];d[31]=_[31]&127|64,d[0]&=248,l(o,v);for(let j=0;j<16;j++)C[j]=o[j];f[0]=K[0]=1;for(let j=254;j>=0;--j){const U=d[j>>>3]>>>(j&7)&1;u(f,C,U),u(F,K,U),p(G,f,F),w(f,f,F),p(F,C,K),w(C,C,K),m(K,G),m(J,f),y(f,F,f),y(F,C,G),p(G,f,F),w(f,f,F),m(C,f),w(F,K,J),y(f,F,s),p(f,f,K),y(F,F,f),y(f,K,J),y(K,C,o),m(C,G),u(f,C,U),u(F,K,U)}for(let j=0;j<16;j++)o[j+16]=f[j],o[j+32]=F[j],o[j+48]=C[j],o[j+64]=K[j];const x=o.subarray(32),P=o.subarray(16);S(x,x),y(P,P,x);const W=new Uint8Array(32);return h(W,P),W}t.scalarMult=A;function R(_){return A(_,n)}t.scalarMultBase=R;function q(_){if(_.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(_);return{publicKey:R(v),secretKey:v}}t.generateKeyPairFromSeed=q;function E(_){const v=(0,e.randomBytes)(32,_),d=q(v);return(0,r.wipe)(v),d}t.generateKeyPair=E;function I(_,v,d=!1){if(_.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(_,v);if(d){let f=0;for(let C=0;C<o.length;C++)f|=o[C];if(f===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=I})(en);var uo=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Bf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),zf=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),qf=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),Kf=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Hf=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Vf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Gf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,lo=3,Wf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Vf]],ho=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function kf(t){return t?fo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Hf:typeof navigator<"u"?fo(navigator.userAgent):Jf()}function Yf(t){return t!==""&&Wf.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function fo(t){var e=Yf(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Kf;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<lo&&(n=uo(uo([],n,!0),Qf(lo-n.length),!0)):n=[];var s=n.join("."),a=Xf(t),u=Gf.exec(t);return u&&u[1]?new qf(r,s,a,u[1]):new Bf(r,s,a)}function Xf(t){for(var e=0,r=ho.length;e<r;e++){var i=ho[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function Jf(){var t=typeof process<"u"&&process.version;return t?new zf(process.version.slice(1)):null}function Qf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=go=Ie.getLocation=Ie.getLocationOrThrow=tn=Ie.getNavigator=Ie.getNavigatorOrThrow=po=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Wt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=Wt;function nr(t){const e=Wt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=nr;function Zf(){return nr("document")}Ie.getDocumentOrThrow=Zf;function ed(){return Wt("document")}var po=Ie.getDocument=ed;function td(){return nr("navigator")}Ie.getNavigatorOrThrow=td;function rd(){return Wt("navigator")}var tn=Ie.getNavigator=rd;function id(){return nr("location")}Ie.getLocationOrThrow=id;function nd(){return Wt("location")}var go=Ie.getLocation=nd;function sd(){return nr("crypto")}Ie.getCryptoOrThrow=sd;function od(){return Wt("crypto")}Ie.getCrypto=od;function ad(){return nr("localStorage")}Ie.getLocalStorageOrThrow=ad;function cd(){return Wt("localStorage")}Ie.getLocalStorage=cd;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});var yo=rn.getWindowMetadata=void 0;const _o=Ie;function ud(){let t,e;try{t=_o.getDocumentOrThrow(),e=_o.getLocationOrThrow()}catch{return null}function r(){const w=t.getElementsByTagName("link"),y=[];for(let m=0;m<w.length;m++){const S=w[m],A=S.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const R=S.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let q=e.protocol+"//"+e.host;if(R.indexOf("/")===0)q+=R;else{const E=e.pathname.split("/");E.pop();const I=E.join("/");q+=I+"/"+R}y.push(q)}else if(R.indexOf("//")===0){const q=e.protocol+R;y.push(q)}else y.push(R)}}return y}function i(...w){const y=t.getElementsByTagName("meta");for(let m=0;m<y.length;m++){const S=y[m],A=["itemprop","property","name"].map(R=>S.getAttribute(R)).filter(R=>R?w.includes(R):!1);if(A.length&&A){const R=S.getAttribute("content");if(R)return R}}return""}function n(){let w=i("name","og:site_name","og:title","twitter:title");return w||(w=t.title),w}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),u=s(),h=e.origin,l=r();return{description:u,url:h,icons:l,name:a}}yo=rn.getWindowMetadata=ud;var Or={},ld=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),bo="%[a-f0-9]{2}",vo=new RegExp("("+bo+")|([^%]+?)","gi"),wo=new RegExp("("+bo+")+","gi");function nn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],nn(r),nn(i))}function hd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(vo)||[],r=1;r<e.length;r++)t=nn(e,r).join(""),e=t.match(vo)||[];return t}}function fd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=wo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=hd(r[0]);i!==r[0]&&(e[r[0]]=i)}r=wo.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var a=n[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var dd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return fd(t)}},pd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},gd=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var a=i[s],u=t[a];(n?e.indexOf(a)!==-1:e(a,u,t))&&(r[a]=u)}return r};(function(t){const e=ld,r=dd,i=pd,n=gd,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function u(E){switch(E.arrayFormat){case"index":return I=>(_,v)=>{const d=_.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?_:v===null?[..._,[p(I,E),"[",d,"]"].join("")]:[..._,[p(I,E),"[",p(d,E),"]=",p(v,E)].join("")]};case"bracket":return I=>(_,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?_:v===null?[..._,[p(I,E),"[]"].join("")]:[..._,[p(I,E),"[]=",p(v,E)].join("")];case"colon-list-separator":return I=>(_,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?_:v===null?[..._,[p(I,E),":list="].join("")]:[..._,[p(I,E),":list=",p(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const I=E.arrayFormat==="bracket-separator"?"[]=":"=";return _=>(v,d)=>d===void 0||E.skipNull&&d===null||E.skipEmptyString&&d===""?v:(d=d===null?"":d,v.length===0?[[p(_,E),I,p(d,E)].join("")]:[[v,p(d,E)].join(E.arrayFormatSeparator)])}default:return I=>(_,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?_:v===null?[..._,p(I,E)]:[..._,[p(I,E),"=",p(v,E)].join("")]}}function h(E){let I;switch(E.arrayFormat){case"index":return(_,v,d)=>{if(I=/\[(\d*)\]$/.exec(_),_=_.replace(/\[\d*\]$/,""),!I){d[_]=v;return}d[_]===void 0&&(d[_]={}),d[_][I[1]]=v};case"bracket":return(_,v,d)=>{if(I=/(\[\])$/.exec(_),_=_.replace(/\[\]$/,""),!I){d[_]=v;return}if(d[_]===void 0){d[_]=[v];return}d[_]=[].concat(d[_],v)};case"colon-list-separator":return(_,v,d)=>{if(I=/(:list)$/.exec(_),_=_.replace(/:list$/,""),!I){d[_]=v;return}if(d[_]===void 0){d[_]=[v];return}d[_]=[].concat(d[_],v)};case"comma":case"separator":return(_,v,d)=>{const o=typeof v=="string"&&v.includes(E.arrayFormatSeparator),f=typeof v=="string"&&!o&&w(v,E).includes(E.arrayFormatSeparator);v=f?w(v,E):v;const C=o||f?v.split(E.arrayFormatSeparator).map(F=>w(F,E)):v===null?v:w(v,E);d[_]=C};case"bracket-separator":return(_,v,d)=>{const o=/(\[\])$/.test(_);if(_=_.replace(/\[\]$/,""),!o){d[_]=v&&w(v,E);return}const f=v===null?[]:v.split(E.arrayFormatSeparator).map(C=>w(C,E));if(d[_]===void 0){d[_]=f;return}d[_]=[].concat(d[_],f)};default:return(_,v,d)=>{if(d[_]===void 0){d[_]=v;return}d[_]=[].concat(d[_],v)}}}function l(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function p(E,I){return I.encode?I.strict?e(E):encodeURIComponent(E):E}function w(E,I){return I.decode?r(E):E}function y(E){return Array.isArray(E)?E.sort():typeof E=="object"?y(Object.keys(E)).sort((I,_)=>Number(I)-Number(_)).map(I=>E[I]):E}function m(E){const I=E.indexOf("#");return I!==-1&&(E=E.slice(0,I)),E}function S(E){let I="";const _=E.indexOf("#");return _!==-1&&(I=E.slice(_)),I}function A(E){E=m(E);const I=E.indexOf("?");return I===-1?"":E.slice(I+1)}function R(E,I){return I.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):I.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function q(E,I){I=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},I),l(I.arrayFormatSeparator);const _=h(I),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const d of E.split("&")){if(d==="")continue;let[o,f]=i(I.decode?d.replace(/\+/g," "):d,"=");f=f===void 0?null:["comma","separator","bracket-separator"].includes(I.arrayFormat)?f:w(f,I),_(w(o,I),f,v)}for(const d of Object.keys(v)){const o=v[d];if(typeof o=="object"&&o!==null)for(const f of Object.keys(o))o[f]=R(o[f],I);else v[d]=R(o,I)}return I.sort===!1?v:(I.sort===!0?Object.keys(v).sort():Object.keys(v).sort(I.sort)).reduce((d,o)=>{const f=v[o];return Boolean(f)&&typeof f=="object"&&!Array.isArray(f)?d[o]=y(f):d[o]=f,d},Object.create(null))}t.extract=A,t.parse=q,t.stringify=(E,I)=>{if(!E)return"";I=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},I),l(I.arrayFormatSeparator);const _=f=>I.skipNull&&s(E[f])||I.skipEmptyString&&E[f]==="",v=u(I),d={};for(const f of Object.keys(E))_(f)||(d[f]=E[f]);const o=Object.keys(d);return I.sort!==!1&&o.sort(I.sort),o.map(f=>{const C=E[f];return C===void 0?"":C===null?p(f,I):Array.isArray(C)?C.length===0&&I.arrayFormat==="bracket-separator"?p(f,I)+"[]":C.reduce(v(f),[]).join("&"):p(f,I)+"="+p(C,I)}).filter(f=>f.length>0).join("&")},t.parseUrl=(E,I)=>{I=Object.assign({decode:!0},I);const[_,v]=i(E,"#");return Object.assign({url:_.split("?")[0]||"",query:q(A(E),I)},I&&I.parseFragmentIdentifier&&v?{fragmentIdentifier:w(v,I)}:{})},t.stringifyUrl=(E,I)=>{I=Object.assign({encode:!0,strict:!0,[a]:!0},I);const _=m(E.url).split("?")[0]||"",v=t.extract(E.url),d=t.parse(v,{sort:!1}),o=Object.assign(d,E.query);let f=t.stringify(o,I);f&&(f=`?${f}`);let C=S(E.url);return E.fragmentIdentifier&&(C=`#${I[a]?p(E.fragmentIdentifier,I):E.fragmentIdentifier}`),`${_}${f}${C}`},t.pick=(E,I,_)=>{_=Object.assign({parseFragmentIdentifier:!0,[a]:!1},_);const{url:v,query:d,fragmentIdentifier:o}=t.parseUrl(E,_);return t.stringifyUrl({url:v,query:n(d,I),fragmentIdentifier:o},_)},t.exclude=(E,I,_)=>{const v=Array.isArray(I)?d=>!I.includes(d):(d,o)=>!I(d,o);return t.pick(E,v,_)}})(Or);const yd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function mo(t,e){return t.includes(":")?[t]:e.chains||[]}const Eo="base10",ct="base16",sn="base64pad",on="utf8",So=0,kt=1,_d=0,Do=1,an=12,cn=32;function bd(){const t=en.generateKeyPair();return{privateKey:at(t.secretKey,ct),publicKey:at(t.publicKey,ct)}}function un(){const t=ir.randomBytes(cn);return at(t,ct)}function vd(t,e){const r=en.sharedKey(ft(t,ct),ft(e,ct)),i=new jf(Zr.SHA256,r).expand(cn);return at(i,ct)}function wd(t){const e=Zr.hash(ft(t,ct));return at(e,ct)}function sr(t){const e=Zr.hash(ft(t,on));return at(e,ct)}function md(t){return ft(`${t}`,Eo)}function xr(t){return Number(at(t,Eo))}function Ed(t){const e=md(typeof t.type<"u"?t.type:So);if(xr(e)===kt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ft(t.senderPublicKey,ct):void 0,i=typeof t.iv<"u"?ft(t.iv,ct):ir.randomBytes(an),n=new Ji.ChaCha20Poly1305(ft(t.symKey,ct)).seal(i,ft(t.message,on));return Dd({type:e,sealed:n,iv:i,senderPublicKey:r})}function Sd(t){const e=new Ji.ChaCha20Poly1305(ft(t.symKey,ct)),{sealed:r,iv:i}=ei(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return at(n,on)}function Dd(t){if(xr(t.type)===kt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(Wi([t.type,t.senderPublicKey,t.iv,t.sealed]),sn)}return at(Wi([t.type,t.iv,t.sealed]),sn)}function ei(t){const e=ft(t,sn),r=e.slice(_d,Do),i=Do;if(xr(r)===kt){const u=i+cn,h=u+an,l=e.slice(i,u),p=e.slice(u,h),w=e.slice(h);return{type:r,sealed:w,iv:p,senderPublicKey:l}}const n=i+an,s=e.slice(i,n),a=e.slice(n);return{type:r,sealed:a,iv:s}}function Od(t,e){const r=ei(t);return Oo({type:xr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ct):void 0,receiverPublicKey:e?.receiverPublicKey})}function Oo(t){const e=t?.type||So;if(e===kt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function xo(t){return t.type===kt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var xd=Object.defineProperty,Io=Object.getOwnPropertySymbols,Id=Object.prototype.hasOwnProperty,Td=Object.prototype.propertyIsEnumerable,To=(t,e,r)=>e in t?xd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,No=(t,e)=>{for(var r in e||(e={}))Id.call(e,r)&&To(t,r,e[r]);if(Io)for(var r of Io(e))Td.call(e,r)&&To(t,r,e[r]);return t};const Nd="ReactNative",Ir={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Pd="js";function ln(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Po(){return!po()&&!!tn()&&navigator.product===Nd}function hn(){return!ln()&&!!tn()}function Ad(){return Po()?Ir.reactNative:ln()?Ir.node:hn()?Ir.browser:Ir.unknown}function Rd(t,e){let r=Or.parse(t);return r=No(No({},r),e),t=Or.stringify(r),t}function Cd(){return yo()||{name:"",description:"",url:"",icons:[""]}}function Fd(){const t=kf();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Ld(){var t;const e=Ad();return e===Ir.browser?[e,((t=go())==null?void 0:t.host)||"unknown"].join(":"):e}function Ud(t,e,r){const i=Fd(),n=Ld();return[[t,e].join("-"),[Pd,r].join("-"),i,n].join("/")}function $d({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a}){const u=r.split("?"),h=Ud(t,e,i),l={auth:n,ua:h,projectId:s,useOnCloseEvent:a||void 0},p=Rd(u[1]||"",l);return u[0]+"?"+p}function Yt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Ao(t){return Object.fromEntries(t.entries())}function Ro(t){return new Map(Object.entries(t))}function or(t=Q.FIVE_MINUTES,e){const r=Q.toMiliseconds(t||Q.FIVE_MINUTES);let i,n,s;return{resolve:a=>{s&&i&&(clearTimeout(s),i(a))},reject:a=>{s&&n&&(clearTimeout(s),n(a))},done:()=>new Promise((a,u)=>{s=setTimeout(()=>{u(new Error(e))},r),i=a,n=u})}}function ti(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function Co(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Md(t){return Co("topic",t)}function jd(t){return Co("id",t)}function Fo(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Ot(t,e){return Q.fromMiliseconds((e||Date.now())+Q.toMiliseconds(t))}function Lt(t){return Date.now()>=Q.toMiliseconds(t)}function Ue(t,e){return`${t}${e?`:${e}`:""}`}const Bd="irn";function fn(t){return t?.relay||{protocol:Bd}}function ri(t){const e=yd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var zd=Object.defineProperty,Lo=Object.getOwnPropertySymbols,qd=Object.prototype.hasOwnProperty,Kd=Object.prototype.propertyIsEnumerable,Uo=(t,e,r)=>e in t?zd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hd=(t,e)=>{for(var r in e||(e={}))qd.call(e,r)&&Uo(t,r,e[r]);if(Lo)for(var r of Lo(e))Kd.call(e,r)&&Uo(t,r,e[r]);return t};function Vd(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function Gd(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Or.parse(s);return{protocol:i,topic:Wd(n[0]),version:parseInt(n[1],10),symKey:a.symKey,relay:Vd(a)}}function Wd(t){return t.startsWith("//")?t.substring(2):t}function kd(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Yd(t){return`${t.protocol}:${t.topic}@${t.version}?`+Or.stringify(Hd({symKey:t.symKey},kd(t.relay)))}function ar(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Xd(t){const e=[];return Object.values(t).forEach(r=>{e.push(...ar(r.accounts))}),e}function Jd(t,e){const r=[];return Object.values(t).forEach(i=>{ar(i.accounts).includes(e)&&r.push(...i.methods)}),r}function Qd(t,e){const r=[];return Object.values(t).forEach(i=>{ar(i.accounts).includes(e)&&r.push(...i.events)}),r}function Zd(t,e){const r=ii(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return i}const ep={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},tp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=tp[t];return{message:e?`${r} ${e}`:r,code:i}}function He(t,e){const{message:r,code:i}=ep[t];return{message:e?`${r} ${e}`:r,code:i}}function Tr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Nr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ut(t){return typeof t>"u"}function Ve(t,e){return e&&ut(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function dn(t,e){return e&&ut(t)?!0:typeof t=="number"&&!isNaN(t)}function rp(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Yt(n,i)?(i.forEach(a=>{const{accounts:u,methods:h,events:l}=t.namespaces[a],p=ar(u),w=r[a];(!Yt(mo(a,w),p)||!Yt(w.methods,h)||!Yt(w.events,l))&&(s=!1)}),s):!1}function pn(t){return Ve(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function ip(t){if(Ve(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&pn(r)}}return!1}function np(t){if(Ve(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function sp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function op(t){return t?.topic}function ap(t,e){let r=null;return Ve(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function $o(t){let e=!0;return Tr(t)?t.length&&(e=t.every(r=>Ve(r,!1))):e=!1,e}function cp(t,e,r){let i=null;return Tr(e)?e.forEach(n=>{i||(!pn(n)||!n.includes(t))&&(i=He("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=He("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function up(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=cp(i,mo(i,n),`${e} requiredNamespace`);s&&(r=s)}),r}function lp(t,e){let r=null;return Tr(t)?t.forEach(i=>{r||ip(i)||(r=He("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=He("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function hp(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=lp(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function fp(t,e){let r=null;return $o(t?.methods)?$o(t?.events)||(r=He("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=He("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Mo(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=fp(i,`${e}, namespace`);n&&(r=n)}),r}function dp(t,e,r){let i=null;if(t&&Nr(t)){const n=Mo(t,e);n&&(i=n);const s=up(t,e);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function ii(t,e){let r=null;if(t&&Nr(t)){const i=Mo(t,e);i&&(r=i);const n=hp(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function jo(t){return Ve(t.protocol,!0)}function pp(t,e){let r=!1;return e&&!t?r=!0:t&&Tr(t)&&t.length&&t.forEach(i=>{r=jo(i)}),r}function gp(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function yp(t){return!(!t||typeof t!="object"||!t.code||!dn(t.code,!1)||!t.message||!Ve(t.message,!1))}function _p(t){return!(ut(t)||!Ve(t.method,!1))}function bp(t){return!(ut(t)||ut(t.result)&&ut(t.error)||!dn(t.id,!1)||!Ve(t.jsonrpc,!1))}function vp(t){return!(ut(t)||!Ve(t.name,!1))}function Bo(t,e){return!(!pn(e)||!Xd(t).includes(e))}function wp(t,e,r){return Ve(r,!1)?Jd(t,e).includes(r):!1}function mp(t,e,r){return Ve(r,!1)?Qd(t,e).includes(r):!1}function zo(t,e,r){let i=null;const n=Ep(t),s=Sp(e),a=Object.keys(n),u=Object.keys(s),h=qo(Object.keys(t)),l=qo(Object.keys(e)),p=h.filter(w=>!l.includes(w));return p.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${p.toString()}
      Received: ${Object.keys(e).toString()}`)),Yt(a,u)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${u.toString()}`)),Object.keys(e).forEach(w=>{if(!w.includes(":")||i)return;const y=ar(e[w].accounts);y.includes(w)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${w}
        Required: ${w}
        Approved: ${y.toString()}`))}),a.forEach(w=>{i||(Yt(n[w].methods,s[w].methods)?Yt(n[w].events,s[w].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${w}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${w}`))}),i}function Ep(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function qo(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Sp(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=ar(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function Dp(t,e){return dn(t,!1)&&t<=e.max&&t>=e.min}const Op="PARSE_ERROR",xp="INVALID_REQUEST",Ip="METHOD_NOT_FOUND",Tp="INVALID_PARAMS",Ko="INTERNAL_ERROR",gn="SERVER_ERROR",Np=[-32700,-32600,-32601,-32602,-32603],Pr={[Op]:{code:-32700,message:"Parse error"},[xp]:{code:-32600,message:"Invalid Request"},[Ip]:{code:-32601,message:"Method not found"},[Tp]:{code:-32602,message:"Invalid params"},[Ko]:{code:-32603,message:"Internal error"},[gn]:{code:-32e3,message:"Server error"}},Ho=gn;function Pp(t){return Np.includes(t)}function Vo(t){return Object.keys(Pr).includes(t)?Pr[t]:Pr[Ho]}function Ap(t){const e=Object.values(Pr).find(r=>r.code===t);return e||Pr[Ho]}function Rp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Go={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var yn=function(t,e){return yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},yn(t,e)};function Cp(t,e){yn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var _n=function(){return _n=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_n.apply(this,arguments)};function Fp(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Lp(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var u=t.length-1;u>=0;u--)(a=t[u])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Up(t,e){return function(r,i){e(r,i,t)}}function $p(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Mp(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function u(p){try{l(i.next(p))}catch(w){a(w)}}function h(p){try{l(i.throw(p))}catch(w){a(w)}}function l(p){p.done?s(p.value):n(p.value).then(u,h)}l((i=i.apply(t,e||[])).next())})}function jp(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(p){return h([l,p])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=l[0]&2?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(p){l=[6,p],n=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Bp(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function zp(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function bn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){a={error:u}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function qp(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Wo(arguments[e]));return t}function Kp(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,u=s.length;a<u;a++,n++)i[n]=s[a];return i}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}function Hp(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(y){i[y]&&(n[y]=function(m){return new Promise(function(S,A){s.push([y,m,S,A])>1||u(y,m)})})}function u(y,m){try{h(i[y](m))}catch(S){w(s[0][3],S)}}function h(y){y.value instanceof Ar?Promise.resolve(y.value.v).then(l,p):w(s[0][2],y)}function l(y){u("next",y)}function p(y){u("throw",y)}function w(y,m){y(m),s.shift(),s.length&&u(s[0][0],s[0][1])}}function Vp(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Ar(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Gp(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof bn=="function"?bn(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(u,h){a=t[s](a),n(u,h,a.done,a.value)})}}function n(s,a,u,h){Promise.resolve(h).then(function(l){s({value:l,done:u})},a)}}function Wp(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function kp(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Yp(t){return t&&t.__esModule?t:{default:t}}function Xp(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Jp(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Qp=Object.freeze({__proto__:null,__extends:Cp,get __assign(){return _n},__rest:Fp,__decorate:Lp,__param:Up,__metadata:$p,__awaiter:Mp,__generator:jp,__createBinding:Bp,__exportStar:zp,__values:bn,__read:Wo,__spread:qp,__spreadArrays:Kp,__await:Ar,__asyncGenerator:Hp,__asyncDelegator:Vp,__asyncValues:Gp,__makeTemplateObject:Wp,__importStar:kp,__importDefault:Yp,__classPrivateFieldGet:Xp,__classPrivateFieldSet:Jp}),Zp=zt(Qp),Nt={},ko;function eg(){if(ko)return Nt;ko=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowserCryptoAvailable=Nt.getSubtleCrypto=Nt.getBrowerCrypto=void 0;function t(){return et?.crypto||et?.msCrypto||{}}Nt.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Nt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Nt.isBrowserCryptoAvailable=r,Nt}var Pt={},Yo;function tg(){if(Yo)return Pt;Yo=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isBrowser=Pt.isNode=Pt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Pt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Pt.isNode=e;function r(){return!t()&&!e()}return Pt.isBrowser=r,Pt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Zp;e.__exportStar(eg(),t),e.__exportStar(tg(),t)})(Go);function Xo(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Jo(t=6){return BigInt(Xo(t))}function ni(t,e,r){return{id:r||Xo(),jsonrpc:"2.0",method:t,params:e}}function vn(t,e){return{id:t,jsonrpc:"2.0",result:e}}function wn(t,e,r){return{id:t,jsonrpc:"2.0",error:rg(e,r)}}function rg(t,e){return typeof t>"u"?Vo(Ko):(typeof t=="string"&&(t=Object.assign(Object.assign({},Vo(gn)),{message:t})),typeof e<"u"&&(t.data=e),Pp(t.code)&&(t=Ap(t.code)),t)}class ig{}class ng extends ig{constructor(){super()}}class sg extends ng{constructor(e){super()}}const og="^wss?:";function ag(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function cg(t,e){const r=ag(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Qo(t){return cg(t,og)}function ug(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Zo(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function mn(t){return Zo(t)&&"method"in t}function si(t){return Zo(t)&&(At(t)||mt(t))}function At(t){return"result"in t}function mt(t){return"error"in t}class lg extends sg{constructor(e){super(e),this.events=new ht.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(ni(e.method,e.params||[],e.id||Jo().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{mt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),si(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ea=10,hg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),fg=()=>typeof window<"u",dg=hg();class pg{constructor(e){if(this.url=e,this.events=new ht.exports.EventEmitter,this.registering=!1,!Qo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bi(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!Qo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=Go.isReactNative()?void 0:{rejectUnauthorized:!ug(e)},s=new dg(e,[],n);fg()?s.onerror=a=>{const u=a;i(this.emitError(u.error))}:s.on("error",a=>{i(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ds(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=wn(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Rp(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ea&&this.events.setMaxListeners(ea)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var En={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,u="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",p="[object Boolean]",w="[object Date]",y="[object Error]",m="[object Function]",S="[object GeneratorFunction]",A="[object Map]",R="[object Number]",q="[object Null]",E="[object Object]",I="[object Promise]",_="[object Proxy]",v="[object RegExp]",d="[object Set]",o="[object String]",f="[object Symbol]",C="[object Undefined]",F="[object WeakMap]",K="[object ArrayBuffer]",G="[object DataView]",J="[object Float32Array]",x="[object Float64Array]",P="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",U="[object Uint8Array]",M="[object Uint8ClampedArray]",L="[object Uint16Array]",B="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[x]=Y[P]=Y[W]=Y[j]=Y[U]=Y[M]=Y[L]=Y[B]=!0,Y[u]=Y[h]=Y[K]=Y[p]=Y[G]=Y[w]=Y[y]=Y[m]=Y[A]=Y[R]=Y[E]=Y[v]=Y[d]=Y[o]=Y[F]=!1;var ee=typeof et=="object"&&et&&et.Object===Object&&et,N=typeof self=="object"&&self&&self.Object===Object&&self,T=ee||N||Function("return this")(),D=e&&!e.nodeType&&e,c=D&&!0&&t&&!t.nodeType&&t,b=c&&c.exports===D,H=b&&ee.process,k=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),he=k&&k.isTypedArray;function be(g,O){for(var $=-1,X=g==null?0:g.length,Te=0,se=[];++$<X;){var Fe=g[$];O(Fe,$,g)&&(se[Te++]=Fe)}return se}function de(g,O){for(var $=-1,X=O.length,Te=g.length;++$<X;)g[Te+$]=O[$];return g}function me(g,O){for(var $=-1,X=g==null?0:g.length;++$<X;)if(O(g[$],$,g))return!0;return!1}function Le(g,O){for(var $=-1,X=Array(g);++$<g;)X[$]=O($);return X}function Ae(g){return function(O){return g(O)}}function ye(g,O){return g.has(O)}function pe(g,O){return g?.[O]}function fe(g){var O=-1,$=Array(g.size);return g.forEach(function(X,Te){$[++O]=[Te,X]}),$}function ue(g,O){return function($){return g(O($))}}function ce(g){var O=-1,$=Array(g.size);return g.forEach(function(X){$[++O]=X}),$}var ae=Array.prototype,oe=Function.prototype,re=Object.prototype,le=T["__core-js_shared__"],ge=oe.toString,ne=re.hasOwnProperty,ve=function(){var g=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),we=re.toString,Se=RegExp("^"+ge.call(ne).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=b?T.Buffer:void 0,Ee=T.Symbol,Et=T.Uint8Array,Tt=re.propertyIsEnumerable,$t=ae.splice,gt=Ee?Ee.toStringTag:void 0,Xt=Object.getOwnPropertySymbols,$r=De?De.isBuffer:void 0,fi=ue(Object.keys,Object),Me=ur(T,"DataView"),Re=ur(T,"Map"),je=ur(T,"Promise"),Be=ur(T,"Set"),ze=ur(T,"WeakMap"),Ce=ur(Object,"create"),Ge=Qt(Me),We=Qt(Re),ke=Qt(je),Ye=Qt(Be),Xe=Qt(ze),Ke=Ee?Ee.prototype:void 0,qe=Ke?Ke.valueOf:void 0;function Ne(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function Je(){this.__data__=Ce?Ce(null):{},this.size=0}function Qe(g){var O=this.has(g)&&delete this.__data__[g];return this.size-=O?1:0,O}function i_(g){var O=this.__data__;if(Ce){var $=O[g];return $===i?void 0:$}return ne.call(O,g)?O[g]:void 0}function n_(g){var O=this.__data__;return Ce?O[g]!==void 0:ne.call(O,g)}function s_(g,O){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=Ce&&O===void 0?i:O,this}Ne.prototype.clear=Je,Ne.prototype.delete=Qe,Ne.prototype.get=i_,Ne.prototype.has=n_,Ne.prototype.set=s_;function Rt(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function o_(){this.__data__=[],this.size=0}function a_(g){var O=this.__data__,$=pi(O,g);if($<0)return!1;var X=O.length-1;return $==X?O.pop():$t.call(O,$,1),--this.size,!0}function c_(g){var O=this.__data__,$=pi(O,g);return $<0?void 0:O[$][1]}function u_(g){return pi(this.__data__,g)>-1}function l_(g,O){var $=this.__data__,X=pi($,g);return X<0?(++this.size,$.push([g,O])):$[X][1]=O,this}Rt.prototype.clear=o_,Rt.prototype.delete=a_,Rt.prototype.get=c_,Rt.prototype.has=u_,Rt.prototype.set=l_;function Jt(g){var O=-1,$=g==null?0:g.length;for(this.clear();++O<$;){var X=g[O];this.set(X[0],X[1])}}function h_(){this.size=0,this.__data__={hash:new Ne,map:new(Re||Rt),string:new Ne}}function f_(g){var O=gi(this,g).delete(g);return this.size-=O?1:0,O}function d_(g){return gi(this,g).get(g)}function p_(g){return gi(this,g).has(g)}function g_(g,O){var $=gi(this,g),X=$.size;return $.set(g,O),this.size+=$.size==X?0:1,this}Jt.prototype.clear=h_,Jt.prototype.delete=f_,Jt.prototype.get=d_,Jt.prototype.has=p_,Jt.prototype.set=g_;function di(g){var O=-1,$=g==null?0:g.length;for(this.__data__=new Jt;++O<$;)this.add(g[O])}function y_(g){return this.__data__.set(g,i),this}function __(g){return this.__data__.has(g)}di.prototype.add=di.prototype.push=y_,di.prototype.has=__;function Mt(g){var O=this.__data__=new Rt(g);this.size=O.size}function b_(){this.__data__=new Rt,this.size=0}function v_(g){var O=this.__data__,$=O.delete(g);return this.size=O.size,$}function w_(g){return this.__data__.get(g)}function m_(g){return this.__data__.has(g)}function E_(g,O){var $=this.__data__;if($ instanceof Rt){var X=$.__data__;if(!Re||X.length<r-1)return X.push([g,O]),this.size=++$.size,this;$=this.__data__=new Jt(X)}return $.set(g,O),this.size=$.size,this}Mt.prototype.clear=b_,Mt.prototype.delete=v_,Mt.prototype.get=w_,Mt.prototype.has=m_,Mt.prototype.set=E_;function S_(g,O){var $=yi(g),X=!$&&M_(g),Te=!$&&!X&&Fn(g),se=!$&&!X&&!Te&&Ja(g),Fe=$||X||Te||se,Ze=Fe?Le(g.length,String):[],it=Ze.length;for(var Pe in g)(O||ne.call(g,Pe))&&!(Fe&&(Pe=="length"||Te&&(Pe=="offset"||Pe=="parent")||se&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||C_(Pe,it)))&&Ze.push(Pe);return Ze}function pi(g,O){for(var $=g.length;$--;)if(Wa(g[$][0],O))return $;return-1}function D_(g,O,$){var X=O(g);return yi(g)?X:de(X,$(g))}function Mr(g){return g==null?g===void 0?C:q:gt&&gt in Object(g)?A_(g):$_(g)}function Ka(g){return jr(g)&&Mr(g)==u}function Ha(g,O,$,X,Te){return g===O?!0:g==null||O==null||!jr(g)&&!jr(O)?g!==g&&O!==O:O_(g,O,$,X,Ha,Te)}function O_(g,O,$,X,Te,se){var Fe=yi(g),Ze=yi(O),it=Fe?h:jt(g),Pe=Ze?h:jt(O);it=it==u?E:it,Pe=Pe==u?E:Pe;var yt=it==E,St=Pe==E,st=it==Pe;if(st&&Fn(g)){if(!Fn(O))return!1;Fe=!0,yt=!1}if(st&&!yt)return se||(se=new Mt),Fe||Ja(g)?Va(g,O,$,X,Te,se):N_(g,O,it,$,X,Te,se);if(!($&n)){var vt=yt&&ne.call(g,"__wrapped__"),wt=St&&ne.call(O,"__wrapped__");if(vt||wt){var Bt=vt?g.value():g,Ct=wt?O.value():O;return se||(se=new Mt),Te(Bt,Ct,$,X,se)}}return st?(se||(se=new Mt),P_(g,O,$,X,Te,se)):!1}function x_(g){if(!Xa(g)||L_(g))return!1;var O=ka(g)?Se:z;return O.test(Qt(g))}function I_(g){return jr(g)&&Ya(g.length)&&!!Y[Mr(g)]}function T_(g){if(!U_(g))return fi(g);var O=[];for(var $ in Object(g))ne.call(g,$)&&$!="constructor"&&O.push($);return O}function Va(g,O,$,X,Te,se){var Fe=$&n,Ze=g.length,it=O.length;if(Ze!=it&&!(Fe&&it>Ze))return!1;var Pe=se.get(g);if(Pe&&se.get(O))return Pe==O;var yt=-1,St=!0,st=$&s?new di:void 0;for(se.set(g,O),se.set(O,g);++yt<Ze;){var vt=g[yt],wt=O[yt];if(X)var Bt=Fe?X(wt,vt,yt,O,g,se):X(vt,wt,yt,g,O,se);if(Bt!==void 0){if(Bt)continue;St=!1;break}if(st){if(!me(O,function(Ct,Zt){if(!ye(st,Zt)&&(vt===Ct||Te(vt,Ct,$,X,se)))return st.push(Zt)})){St=!1;break}}else if(!(vt===wt||Te(vt,wt,$,X,se))){St=!1;break}}return se.delete(g),se.delete(O),St}function N_(g,O,$,X,Te,se,Fe){switch($){case G:if(g.byteLength!=O.byteLength||g.byteOffset!=O.byteOffset)return!1;g=g.buffer,O=O.buffer;case K:return!(g.byteLength!=O.byteLength||!se(new Et(g),new Et(O)));case p:case w:case R:return Wa(+g,+O);case y:return g.name==O.name&&g.message==O.message;case v:case o:return g==O+"";case A:var Ze=fe;case d:var it=X&n;if(Ze||(Ze=ce),g.size!=O.size&&!it)return!1;var Pe=Fe.get(g);if(Pe)return Pe==O;X|=s,Fe.set(g,O);var yt=Va(Ze(g),Ze(O),X,Te,se,Fe);return Fe.delete(g),yt;case f:if(qe)return qe.call(g)==qe.call(O)}return!1}function P_(g,O,$,X,Te,se){var Fe=$&n,Ze=Ga(g),it=Ze.length,Pe=Ga(O),yt=Pe.length;if(it!=yt&&!Fe)return!1;for(var St=it;St--;){var st=Ze[St];if(!(Fe?st in O:ne.call(O,st)))return!1}var vt=se.get(g);if(vt&&se.get(O))return vt==O;var wt=!0;se.set(g,O),se.set(O,g);for(var Bt=Fe;++St<it;){st=Ze[St];var Ct=g[st],Zt=O[st];if(X)var Qa=Fe?X(Zt,Ct,st,O,g,se):X(Ct,Zt,st,g,O,se);if(!(Qa===void 0?Ct===Zt||Te(Ct,Zt,$,X,se):Qa)){wt=!1;break}Bt||(Bt=st=="constructor")}if(wt&&!Bt){var _i=g.constructor,bi=O.constructor;_i!=bi&&"constructor"in g&&"constructor"in O&&!(typeof _i=="function"&&_i instanceof _i&&typeof bi=="function"&&bi instanceof bi)&&(wt=!1)}return se.delete(g),se.delete(O),wt}function Ga(g){return D_(g,z_,R_)}function gi(g,O){var $=g.__data__;return F_(O)?$[typeof O=="string"?"string":"hash"]:$.map}function ur(g,O){var $=pe(g,O);return x_($)?$:void 0}function A_(g){var O=ne.call(g,gt),$=g[gt];try{g[gt]=void 0;var X=!0}catch{}var Te=we.call(g);return X&&(O?g[gt]=$:delete g[gt]),Te}var R_=Xt?function(g){return g==null?[]:(g=Object(g),be(Xt(g),function(O){return Tt.call(g,O)}))}:q_,jt=Mr;(Me&&jt(new Me(new ArrayBuffer(1)))!=G||Re&&jt(new Re)!=A||je&&jt(je.resolve())!=I||Be&&jt(new Be)!=d||ze&&jt(new ze)!=F)&&(jt=function(g){var O=Mr(g),$=O==E?g.constructor:void 0,X=$?Qt($):"";if(X)switch(X){case Ge:return G;case We:return A;case ke:return I;case Ye:return d;case Xe:return F}return O});function C_(g,O){return O=O??a,!!O&&(typeof g=="number"||Z.test(g))&&g>-1&&g%1==0&&g<O}function F_(g){var O=typeof g;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?g!=="__proto__":g===null}function L_(g){return!!ve&&ve in g}function U_(g){var O=g&&g.constructor,$=typeof O=="function"&&O.prototype||re;return g===$}function $_(g){return we.call(g)}function Qt(g){if(g!=null){try{return ge.call(g)}catch{}try{return g+""}catch{}}return""}function Wa(g,O){return g===O||g!==g&&O!==O}var M_=Ka(function(){return arguments}())?Ka:function(g){return jr(g)&&ne.call(g,"callee")&&!Tt.call(g,"callee")},yi=Array.isArray;function j_(g){return g!=null&&Ya(g.length)&&!ka(g)}var Fn=$r||K_;function B_(g,O){return Ha(g,O)}function ka(g){if(!Xa(g))return!1;var O=Mr(g);return O==m||O==S||O==l||O==_}function Ya(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=a}function Xa(g){var O=typeof g;return g!=null&&(O=="object"||O=="function")}function jr(g){return g!=null&&typeof g=="object"}var Ja=he?Ae(he):I_;function z_(g){return j_(g)?S_(g):T_(g)}function q_(){return[]}function K_(){return!1}t.exports=B_})(En,En.exports);var gg=En.exports,yg=Object.defineProperty,ta=Object.getOwnPropertySymbols,_g=Object.prototype.hasOwnProperty,bg=Object.prototype.propertyIsEnumerable,ra=(t,e,r)=>e in t?yg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lt=(t,e)=>{for(var r in e||(e={}))_g.call(e,r)&&ra(t,r,e[r]);if(ta)for(var r of ta(e))bg.call(e,r)&&ra(t,r,e[r]);return t};function vg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var u=t.length,h=t.charAt(0),l=Math.log(u)/Math.log(256),p=Math.log(256)/Math.log(u);function w(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var A=0,R=0,q=0,E=S.length;q!==E&&S[q]===0;)q++,A++;for(var I=(E-q)*p+1>>>0,_=new Uint8Array(I);q!==E;){for(var v=S[q],d=0,o=I-1;(v!==0||d<R)&&o!==-1;o--,d++)v+=256*_[o]>>>0,_[o]=v%u>>>0,v=v/u>>>0;if(v!==0)throw new Error("Non-zero carry");R=d,q++}for(var f=I-R;f!==I&&_[f]===0;)f++;for(var C=h.repeat(A);f<I;++f)C+=t.charAt(_[f]);return C}function y(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var A=0;if(S[A]!==" "){for(var R=0,q=0;S[A]===h;)R++,A++;for(var E=(S.length-A)*l+1>>>0,I=new Uint8Array(E);S[A];){var _=r[S.charCodeAt(A)];if(_===255)return;for(var v=0,d=E-1;(_!==0||v<q)&&d!==-1;d--,v++)_+=u*I[d]>>>0,I[d]=_%256>>>0,_=_/256>>>0;if(_!==0)throw new Error("Non-zero carry");q=v,A++}if(S[A]!==" "){for(var o=E-q;o!==E&&I[o]===0;)o++;for(var f=new Uint8Array(R+(E-o)),C=R;o!==E;)f[C++]=I[o++];return f}}}function m(S){var A=y(S);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:y,decode:m}}var wg=vg,mg=wg;const ia=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Eg=t=>new TextEncoder().encode(t),Sg=t=>new TextDecoder().decode(t);class Dg{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Og{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return na(this,e)}}class xg{constructor(e){this.decoders=e}or(e){return na(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const na=(t,e)=>new xg(lt(lt({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Ig{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new Dg(e,r,i),this.decoder=new Og(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const oi=({name:t,prefix:e,encode:r,decode:i})=>new Ig(t,e,r,i),Rr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=mg(r,e);return oi({prefix:t,name:e,encode:i,decode:s=>ia(n(s))})},Tg=(t,e,r,i)=>{const n={};for(let p=0;p<e.length;++p)n[e[p]]=p;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let u=0,h=0,l=0;for(let p=0;p<s;++p){const w=n[t[p]];if(w===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|w,u+=r,u>=8&&(u-=8,a[l++]=255&h>>u)}if(u>=r||255&h<<8-u)throw new SyntaxError("Unexpected end of data");return a},Ng=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,u=0;for(let h=0;h<t.length;++h)for(u=u<<8|t[h],a+=8;a>r;)a-=r,s+=e[n&u>>a];if(a&&(s+=e[n&u<<r-a]),i)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>oi({prefix:e,name:t,encode(n){return Ng(n,i,r)},decode(n){return Tg(n,i,r,t)}}),Pg=oi({prefix:"\0",name:"identity",encode:t=>Sg(t),decode:t=>Eg(t)});var Ag=Object.freeze({__proto__:null,identity:Pg});const Rg=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Cg=Object.freeze({__proto__:null,base2:Rg});const Fg=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Lg=Object.freeze({__proto__:null,base8:Fg});const Ug=Rr({prefix:"9",name:"base10",alphabet:"0123456789"});var $g=Object.freeze({__proto__:null,base10:Ug});const Mg=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jg=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Bg=Object.freeze({__proto__:null,base16:Mg,base16upper:jg});const zg=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qg=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kg=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Hg=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Vg=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Gg=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wg=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),kg=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yg=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Xg=Object.freeze({__proto__:null,base32:zg,base32upper:qg,base32pad:Kg,base32padupper:Hg,base32hex:Vg,base32hexupper:Gg,base32hexpad:Wg,base32hexpadupper:kg,base32z:Yg});const Jg=Rr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Qg=Rr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Zg=Object.freeze({__proto__:null,base36:Jg,base36upper:Qg});const e0=Rr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),t0=Rr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var r0=Object.freeze({__proto__:null,base58btc:e0,base58flickr:t0});const i0=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),n0=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),s0=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),o0=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var a0=Object.freeze({__proto__:null,base64:i0,base64pad:n0,base64url:s0,base64urlpad:o0});const sa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),c0=sa.reduce((t,e,r)=>(t[r]=e,t),[]),u0=sa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function l0(t){return t.reduce((e,r)=>(e+=c0[r],e),"")}function h0(t){const e=[];for(const r of t){const i=u0[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const f0=oi({prefix:"\u{1F680}",name:"base256emoji",encode:l0,decode:h0});var d0=Object.freeze({__proto__:null,base256emoji:f0}),p0=aa,oa=128,g0=127,y0=~g0,_0=Math.pow(2,31);function aa(t,e,r){e=e||[],r=r||0;for(var i=r;t>=_0;)e[r++]=t&255|oa,t/=128;for(;t&y0;)e[r++]=t&255|oa,t>>>=7;return e[r]=t|0,aa.bytes=r-i+1,e}var b0=Sn,v0=128,ca=127;function Sn(t,i){var r=0,i=i||0,n=0,s=i,a,u=t.length;do{if(s>=u)throw Sn.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&ca)<<n:(a&ca)*Math.pow(2,n),n+=7}while(a>=v0);return Sn.bytes=s-i,r}var w0=Math.pow(2,7),m0=Math.pow(2,14),E0=Math.pow(2,21),S0=Math.pow(2,28),D0=Math.pow(2,35),O0=Math.pow(2,42),x0=Math.pow(2,49),I0=Math.pow(2,56),T0=Math.pow(2,63),N0=function(t){return t<w0?1:t<m0?2:t<E0?3:t<S0?4:t<D0?5:t<O0?6:t<x0?7:t<I0?8:t<T0?9:10},P0={encode:p0,decode:b0,encodingLength:N0},ua=P0;const la=(t,e,r=0)=>(ua.encode(t,e,r),e),ha=t=>ua.encodingLength(t),Dn=(t,e)=>{const r=e.byteLength,i=ha(t),n=i+ha(r),s=new Uint8Array(n+r);return la(t,s,0),la(r,s,i),s.set(e,n),new A0(t,r,e,s)};class A0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const fa=({name:t,code:e,encode:r})=>new R0(t,e,r);class R0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Dn(this.code,r):r.then(i=>Dn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const da=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),C0=fa({name:"sha2-256",code:18,encode:da("SHA-256")}),F0=fa({name:"sha2-512",code:19,encode:da("SHA-512")});var L0=Object.freeze({__proto__:null,sha256:C0,sha512:F0});const pa=0,U0="identity",ga=ia;var $0=Object.freeze({__proto__:null,identity:{code:pa,name:U0,encode:ga,digest:t=>Dn(pa,ga(t))}});new TextEncoder,new TextDecoder;const ya=lt(lt(lt(lt(lt(lt(lt(lt(lt(lt({},Ag),Cg),Lg),$g),Bg),Xg),Zg),r0),a0),d0);lt(lt({},L0),$0);function _a(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function M0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?_a(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ba(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const va=ba("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),On=ba("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=M0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),j0=lt({utf8:va,"utf-8":va,hex:ya.base16,latin1:On,ascii:On,binary:On},ya);function B0(t,e="utf8"){const r=j0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?_a(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const wa="wc",z0=2,xn="core",Ut=`${wa}@${2}:${xn}:`,q0={name:xn,logger:"error"},K0={database:":memory:"},H0="crypto",ma="client_ed25519_seed",V0=Q.ONE_DAY,G0="keychain",W0="0.3",k0="messages",Y0="0.3",X0=Q.SIX_HOURS,J0="publisher",Ea="irn",Q0="error",Sa="wss://relay.walletconnect.com",Z0="relayer",$e={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ey="_subscription",Cr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ty=Q.ONE_SECOND/2,ry="y",iy=1e4,ny="0.3",xt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},sy="subscription",oy="0.3",ay=Q.FIVE_SECONDS*1e3,cy="pairing",uy="0.3",Fr={wc_pairingDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:0},res:{ttl:Q.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ly="history",hy="0.3",fy="expirer",_t={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},dy="0.3",In="verify-api",Da="https://verify.walletconnect.com";class py{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=G0,this.version=W0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ao(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ro(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class gy{constructor(e,r,i){this.core=e,this.logger=r,this.name=H0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=to(n);return eo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=bd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=to(s),u=un();return await xf(u,n,V0,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const u=this.getPrivateKey(n),h=vd(u,s);return this.setSymKey(h,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||wd(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const u=Oo(a),h=Bi(s);if(xo(u)){const y=u.senderPublicKey,m=u.receiverPublicKey;n=await this.generateSharedKey(y,m)}const l=this.getSymKey(n),{type:p,senderPublicKey:w}=u;return Ed({type:p,symKey:l,message:h,senderPublicKey:w})},this.decode=async(n,s,a)=>{this.isInitialized();const u=Od(s,a);if(xo(u)){const p=u.receiverPublicKey,w=u.senderPublicKey;n=await this.generateSharedKey(p,w)}const h=this.getSymKey(n),l=Sd({symKey:h,encoded:s});return Ds(l)},this.getPayloadType=n=>{const s=ei(n);return xr(s.type)},this.getPayloadSenderPublicKey=n=>{const s=ei(n);return s.senderPublicKey?at(s.senderPublicKey,ct):void 0},this.core=e,this.logger=_e.generateChildLogger(r,this.name),this.keychain=i||new py(this.core,this.logger)}get context(){return _e.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ma)}catch{e=un(),await this.keychain.set(ma,e)}return B0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class yy extends sl{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=k0,this.version=Y0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=sr(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=sr(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=_e.generateChildLogger(e,this.name),this.core=r}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ao(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ro(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class _y extends ol{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new ht.exports.EventEmitter,this.name=J0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const a=s?.ttl||X0,u=fn(s),h=s?.prompt||!1,l=s?.tag||0,p=s?.id||Jo().toString(),w={topic:i,message:n,opts:{ttl:a,relay:u,prompt:h,tag:l,id:p}};this.queue.set(p,w);try{await await ti(this.rpcPublish(i,n,a,u,h,l,p),this.publishTimeout),this.relayer.events.emit($e.publish,w)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit($e.connection_stalled);return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=_e.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return _e.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,a,u){var h,l,p,w;const y={method:ri(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:a},id:u};return ut((h=y.params)==null?void 0:h.prompt)&&((l=y.params)==null||delete l.prompt),ut((p=y.params)==null?void 0:p.tag)&&((w=y.params)==null||delete w.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:y}),this.relayer.request(y)}onPublish(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()}),this.relayer.on($e.message_ack,e=>{this.onPublish(e.id.toString())})}}class by{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var vy=Object.defineProperty,wy=Object.defineProperties,my=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,Ey=Object.prototype.hasOwnProperty,Sy=Object.prototype.propertyIsEnumerable,xa=(t,e,r)=>e in t?vy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Lr=(t,e)=>{for(var r in e||(e={}))Ey.call(e,r)&&xa(t,r,e[r]);if(Oa)for(var r of Oa(e))Sy.call(e,r)&&xa(t,r,e[r]);return t},Tn=(t,e)=>wy(t,my(e));class Dy extends ul{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new by,this.events=new ht.exports.EventEmitter,this.name=sy,this.version=oy,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ut,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=fn(n),a={topic:i,relay:s};this.pending.set(i,a);const u=await this.rpcSubscribe(i,s);return this.onSubscribe(u,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),u}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const a=new Q.Watch;a.start(this.pendingSubscriptionWatchLabel);const u=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(u),a.stop(this.pendingSubscriptionWatchLabel),n(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=ay&&(clearInterval(u),a.stop(this.pendingSubscriptionWatchLabel),s(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=_e.generateChildLogger(r,this.name),this.clientId=""}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=fn(i);await this.rpcUnsubscribe(e,r,n);const s=He("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:ri(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await ti(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit($e.connection_stalled)}return sr(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:ri(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await ti(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit($e.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:ri(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,Tn(Lr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Lr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Lr({},r)),this.topicMap.set(r.topic,e),this.events.emit(xt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(xt.deleted,Tn(Lr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xt.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}}this.events.emit(xt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Tr(r)&&this.onBatchSubscribe(r.map((i,n)=>Tn(Lr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on($e.connect,async()=>{await this.onConnect()}),this.relayer.on($e.disconnect,()=>{this.onDisconnect()}),this.events.on(xt.created,async e=>{const r=xt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(xt.deleted,async e=>{const r=xt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var Oy=Object.defineProperty,Ia=Object.getOwnPropertySymbols,xy=Object.prototype.hasOwnProperty,Iy=Object.prototype.propertyIsEnumerable,Ta=(t,e,r)=>e in t?Oy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ty=(t,e)=>{for(var r in e||(e={}))xy.call(e,r)&&Ta(t,r,e[r]);if(Ia)for(var r of Ia(e))Iy.call(e,r)&&Ta(t,r,e[r]);return t};class Ny extends al{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new ht.exports.EventEmitter,this.name=Z0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?_e.generateChildLogger(e.logger,this.name):_e.pino(_e.getDefaultLoggerOptions({level:e.logger||Q0})),this.messages=new yy(this.logger,e.core),this.subscriber=new Dy(this,this.logger),this.publisher=new _y(this,this.logger),this.relayUrl=e?.relayUrl||Sa,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribted to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},iy)}get context(){return _e.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(xt.created,s=>{s.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit($e.transport_closed))}async transportOpen(e){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=e||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(xt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,i)=>{await ti(this.provider.connect(),5e3,"socket stalled").catch(n=>i(n)).then(()=>r()).finally(()=>this.removeListener($e.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once($e.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.events.emit($e.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,this.connected&&await Promise.all([new Promise(r=>{this.provider.once(Cr.disconnect,()=>{r()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new lg(new pg($d({sdkVersion:ry,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),mn(e)){if(!e.method.endsWith(ey))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,a={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ty({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else si(e)&&this.events.emit($e.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit($e.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=vn(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(Cr.payload,e=>this.onProviderPayload(e)),this.provider.on(Cr.connect,()=>{this.events.emit($e.connect)}),this.provider.on(Cr.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Cr.error,e=>{this.logger.error(e),this.events.emit($e.error,e)})}registerEventListeners(){this.events.on($e.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit($e.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Q.toMiliseconds(ty))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Py=Object.defineProperty,Na=Object.getOwnPropertySymbols,Ay=Object.prototype.hasOwnProperty,Ry=Object.prototype.propertyIsEnumerable,Pa=(t,e,r)=>e in t?Py(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Aa=(t,e)=>{for(var r in e||(e={}))Ay.call(e,r)&&Pa(t,r,e[r]);if(Na)for(var r of Na(e))Ry.call(e,r)&&Pa(t,r,e[r]);return t};class ai extends cl{constructor(e,r,i,n=Ut,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=ny,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!ut(a)?this.map.set(this.getKey(a),a):sp(a)?this.map.set(a.id,a):op(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,u)=>{this.isInitialized(),this.map.has(a)?await this.update(a,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:u}),this.map.set(a,u),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(u=>Object.keys(a).every(h=>gg(u[h],a[h]))):this.values),this.update=async(a,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:u});const h=Aa(Aa({},this.getData(a)),u);this.map.set(a,h),await this.persist()},this.delete=async(a,u)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:u}),this.map.delete(a),await this.persist())},this.logger=_e.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Cy{constructor(e,r){this.core=e,this.logger=r,this.name=cy,this.version=uy,this.events=new ht.exports,this.initialized=!1,this.storagePrefix=Ut,this.ignoredPayloadTypes=[kt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=un(),n=await this.core.crypto.setSymKey(i),s=Ot(Q.FIVE_MINUTES),a={protocol:Ea},u={topic:n,expiry:s,relay:a,active:!1},h=Yd({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:a});return await this.pairings.set(n,u),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:h}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:a}=Gd(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const u=Ot(Q.FIVE_MINUTES),h={topic:n,relay:a,expiry:u,active:!1};return await this.pairings.set(n,h),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:a}),this.core.expirer.set(n,u),i.activatePairing&&await this.activate({topic:n}),h},this.activate=async({topic:i})=>{this.isInitialized();const n=Ot(Q.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:u,reject:h}=or();this.events.once(Ue("pairing_ping",s),({error:l})=>{l?h(l):u()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",He("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const a=ni(n,s),u=await this.core.crypto.encode(i,a),h=Fr[n].req;return this.core.history.set(i,a),this.core.relayer.publish(i,u,h),a.id},this.sendResult=async(i,n,s)=>{const a=vn(i,s),u=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=Fr[h.request.method].res;await this.core.relayer.publish(n,u,l),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=wn(i,s),u=await this.core.crypto.encode(n,a),h=await this.core.history.get(n,i),l=Fr[h.request.method]?Fr[h.request.method].res:Fr.unregistered_method.res;await this.core.relayer.publish(n,u,l),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,He("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Lt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i,a=s.method;if(this.pairings.keys.includes(n))switch(a){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;if(this.pairings.keys.includes(n))switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{At(n)?this.events.emit(Ue("pairing_ping",s),{}):mt(n)&&this.events.emit(Ue("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const u=He("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,u),this.logger.error(u)}catch(u){await this.sendError(s,i,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(He("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!dt(i)){const{message:n}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!np(i.uri)){const{message:n}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!dt(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!dt(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ve(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Lt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=_e.generateChildLogger(r,this.name),this.pairings=new ai(this.core,this.logger,this.name,this.storagePrefix)}get context(){return _e.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on($e.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);mn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):si(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(_t.expired,async e=>{const{topic:r}=Fo(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Fy extends nl{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new ht.exports.EventEmitter,this.name=ly,this.version=hy,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(It.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=mt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(It.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:ni(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(It.created,e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.updated,e=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.deleted,e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ly extends ll{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new ht.exports.EventEmitter,this.name=fy,this.version=dy,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(_t.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(_t.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=_e.generateChildLogger(r,this.name)}get context(){return _e.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Md(e);if(typeof e=="number")return jd(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Q.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(_t.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(gr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.expired,e=>{const r=_t.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Uy extends hl{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=In,this.initialized=!1,this.init=async i=>{Po()||!hn()||(this.verifyUrl=i?.verifyUrl||Da,await this.createIframe())},this.register=async i=>{var n;this.initialized||await this.init(),this.iframe&&((n=this.iframe.contentWindow)==null||n.postMessage(i.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${i.attestationId} ${this.verifyUrl}`))},this.resolve=async i=>{var n;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${i.attestationId}`);const s=this.startAbortTimer(Q.FIVE_SECONDS),a=await fetch(`${this.verifyUrl}/attestation/${i.attestationId}`,{signal:this.abortController.signal});return clearTimeout(s),a.status===200?(n=await a.json())==null?void 0:n.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((i,n)=>{if(document.getElementById(In))return i();const s=document.createElement("iframe");s.setAttribute("id",In),s.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),s.style.display="none",s.addEventListener("load",()=>{this.initialized=!0,i()}),s.addEventListener("error",a=>{n(a)}),document.body.append(s),this.iframe=s}),new Promise(i=>{setTimeout(()=>i("iframe load timeout"),Q.toMiliseconds(Q.ONE_SECOND/2))})])}catch(i){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(i)}},this.logger=_e.generateChildLogger(r,this.name),this.verifyUrl=Da,this.abortController=new AbortController,this.isDevEnv=ln()&&process.env.IS_VITEST}get context(){return _e.getLoggerContext(this.logger)}startAbortTimer(e){return setTimeout(()=>this.abortController.abort(),Q.toMiliseconds(e))}}var $y=Object.defineProperty,Ra=Object.getOwnPropertySymbols,My=Object.prototype.hasOwnProperty,jy=Object.prototype.propertyIsEnumerable,Ca=(t,e,r)=>e in t?$y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fa=(t,e)=>{for(var r in e||(e={}))My.call(e,r)&&Ca(t,r,e[r]);if(Ra)for(var r of Ra(e))jy.call(e,r)&&Ca(t,r,e[r]);return t};class Nn extends il{constructor(e){super(e),this.protocol=wa,this.version=z0,this.name=xn,this.events=new ht.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Sa;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:_e.pino(_e.getDefaultLoggerOptions({level:e?.logger||q0.logger}));this.logger=_e.generateChildLogger(r,this.name),this.heartbeat=new gr.HeartBeat,this.crypto=new gy(this,this.logger,e?.keychain),this.history=new Fy(this,this.logger),this.expirer=new Ly(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Cc(Fa(Fa({},K0),e?.storageOptions)),this.relayer=new Ny({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Cy(this,this.logger),this.verify=new Uy(this.projectId||"",this.logger)}static async init(e){const r=new Nn(e);return await r.initialize(),r}get context(){return _e.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const By=Nn,Pn="wc",An=2,Rn="client",ci=`${Pn}@${An}:${Rn}:`,ui={name:Rn,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zy={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},qy={database:":memory:"},Ky={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Hy="history",Vy="0.3",La="proposal",Gy=Q.THIRTY_DAYS,Ua="Proposal expired",$a="session",Ur=Q.SEVEN_DAYS,Ma="engine",cr={wc_sessionPropose:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Q.THIRTY_SECONDS,prompt:!1,tag:1115}}},li={min:Q.FIVE_MINUTES,max:Q.SEVEN_DAYS},ja="request",Ba=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Wy=Object.defineProperty,ky=Object.defineProperties,Yy=Object.getOwnPropertyDescriptors,za=Object.getOwnPropertySymbols,Xy=Object.prototype.hasOwnProperty,Jy=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?Wy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e)=>{for(var r in e||(e={}))Xy.call(e,r)&&qa(t,r,e[r]);if(za)for(var r of za(e))Jy.call(e,r)&&qa(t,r,e[r]);return t},Cn=(t,e)=>ky(t,Yy(e));class Qy extends dl{constructor(e){super(e),this.name=Ma,this.events=new ht.exports,this.initialized=!1,this.ignoredPayloadTypes=[kt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(cr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=Cn(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:u,relays:h}=i;let l=n,p,w=!1;if(l&&(w=this.client.core.pairing.pairings.get(l).active),!l||!w){const{topic:I,uri:_}=await this.client.core.pairing.create();l=I,p=_}const y=await this.client.core.crypto.generateKeyPair(),m=bt({requiredNamespaces:s,optionalNamespaces:a,relays:h??[{protocol:Ea}],proposer:{publicKey:y,metadata:this.client.metadata}},u&&{sessionProperties:u}),{reject:S,resolve:A,done:R}=or(Q.FIVE_MINUTES,Ua);if(this.events.once(Ue("session_connect"),async({error:I,session:_})=>{if(I)S(I);else if(_){_.self.publicKey=y;const v=Cn(bt({},_),{requiredNamespaces:_.requiredNamespaces,optionalNamespaces:_.optionalNamespaces});await this.client.session.set(_.topic,v),await this.setExpiry(_.topic,_.expiry),l&&await this.client.core.pairing.updateMetadata({topic:l,metadata:_.peer.metadata}),A(v)}}),!l){const{message:I}=V("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(I)}const q=await this.sendRequest(l,"wc_sessionPropose",m),E=Ot(Q.FIVE_MINUTES);return await this.setProposal(q,bt({id:q,expiry:E},m)),{uri:p,approval:R}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:a}=r,u=this.client.proposal.get(i);let{pairingTopic:h,proposer:l,requiredNamespaces:p,optionalNamespaces:w}=u;h=h||"",Nr(p)||(p=Zd(s,"approve()"));const y=await this.client.core.crypto.generateKeyPair(),m=l.publicKey,S=await this.client.core.crypto.generateSharedKey(y,m);h&&i&&(await this.client.core.pairing.updateMetadata({topic:h,metadata:l.metadata}),await this.sendResult(i,h,{relay:{protocol:n??"irn"},responderPublicKey:y}),await this.client.proposal.delete(i,He("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}));const A=bt({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:p,optionalNamespaces:w,pairingTopic:h,controller:{publicKey:y,metadata:this.client.metadata},expiry:Ot(Ur)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(S),await this.sendRequest(S,"wc_sessionSettle",A);const R=Cn(bt({},A),{topic:S,pairingTopic:h,acknowledged:!1,self:A.controller,peer:{publicKey:l.publicKey,metadata:l.metadata},controller:y});return await this.client.session.set(S,R),await this.setExpiry(S,Ot(Ur)),{topic:S,acknowledged:()=>new Promise(q=>setTimeout(()=>q(this.client.session.get(S)),500))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,He("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:a,resolve:u,reject:h}=or();return this.events.once(Ue("session_update",s),({error:l})=>{l?h(l):u()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:a,reject:u}=or();return this.events.once(Ue("session_extend",n),({error:h})=>{h?u(h):a()}),await this.setExpiry(i,Ot(Ur)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:a}=r,u=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},a),{done:h,resolve:l,reject:p}=or(a);return this.events.once(Ue("session_request",u),({error:w,result:y})=>{w?p(w):l(y)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:u}),await h()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;At(n)?await this.sendResult(s,i,n.result):mt(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:a,reject:u}=or();this.events.once(Ue("session_ping",n),({error:h})=>{h?u(h):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",He("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>rp(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var a,u;return((a=s.peerMetadata)==null?void 0:a.url)&&((u=s.peerMetadata)==null?void 0:u.url)===r.self.metadata.url&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,He("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,He("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=cr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:a}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:a}),i&&this.client.core.expirer.set(n,Ot(i))},this.sendRequest=async(r,i,n,s)=>{const a=ni(i,n);if(hn()&&Ba.includes(i)){const l=sr(JSON.stringify(a));await this.client.core.verify.register({attestationId:l})}const u=await this.client.core.crypto.encode(r,a),h=cr[i].req;return s&&(h.ttl=s),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,u,h),a.id},this.sendResult=async(r,i,n)=>{const s=vn(r,n),a=await this.client.core.crypto.encode(i,s),u=await this.client.core.history.get(i,r),h=cr[u.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=wn(r,n),a=await this.client.core.crypto.encode(i,s),u=await this.client.core.history.get(i,r),h=cr[u.request.method].res;this.client.core.relayer.publish(i,a,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{Lt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Lt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(bt({},i.params));const a=Ot(Q.FIVE_MINUTES),u=bt({id:s,pairingTopic:r,expiry:a},n);await this.setProposal(s,u);const h=sr(JSON.stringify(i)),l=await this.getVerifyContext(h,u.proposer.metadata);this.client.events.emit("session_proposal",{id:s,params:u,verifyContext:l})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(At(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const u=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:u});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const l=await this.client.core.crypto.generateSharedKey(u,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const p=await this.client.core.relayer.subscribe(l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:p}),await this.client.core.pairing.activate({topic:r})}else mt(i)&&(await this.client.proposal.delete(n,He("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:u,expiry:h,namespaces:l,requiredNamespaces:p,optionalNamespaces:w,sessionProperties:y,pairingTopic:m}=i.params,S=bt({topic:r,relay:a,expiry:h,namespaces:l,acknowledged:!0,pairingTopic:m,requiredNamespaces:p,optionalNamespaces:w,controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},y&&{sessionProperties:y});await this.sendResult(i.id,r,!0),this.events.emit(Ue("session_connect"),{session:S}),this.cleanupDuplicatePairings(S)}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;At(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",n),{})):mt(i)&&(await this.client.session.delete(r,He("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(bt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_update",n),{}):mt(i)&&this.events.emit(Ue("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ot(Ur)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_extend",n),{}):mt(i)&&this.events.emit(Ue("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{At(i)?this.events.emit(Ue("session_ping",n),{}):mt(i)&&this.events.emit(Ue("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await Promise.all([new Promise(s=>{this.client.core.relayer.once($e.publish,async()=>{s(await this.deleteSession(r))})}),this.sendResult(n,r,!0)]),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(bt({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s});const a=sr(JSON.stringify(i)),u=this.client.session.get(r),h=await this.getVerifyContext(a,u.peer.metadata);this.client.events.emit("session_request",{id:n,topic:r,params:s,verifyContext:h})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;At(i)?this.events.emit(Ue("session_request",n),{result:i.result}):mt(i)&&this.events.emit(Ue("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(bt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(a){await this.sendError(n,r,a),this.client.logger.error(a)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:h}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(h)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:u}=r;if(ut(i)||await this.isValidPairingTopic(i),!pp(u,!0)){const{message:h}=V("MISSING_OR_INVALID",`connect() relays: ${u}`);throw new Error(h)}!ut(n)&&Nr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ut(s)&&Nr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ut(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=dp(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!dt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(i);const u=this.client.proposal.get(i),h=ii(n,"approve()");if(h)throw new Error(h.message);const l=zo(u.requiredNamespaces,n,"approve()");if(l)throw new Error(l.message);if(!Ve(s,!0)){const{message:p}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(p)}ut(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!yp(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:l}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(l)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!jo(i)){const{message:l}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const u=ap(n,"onSessionSettleRequest()");if(u)throw new Error(u.message);const h=ii(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(Lt(a)){const{message:l}=V("EXPIRED","onSessionSettleRequest()");throw new Error(l)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:h}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=ii(n,"update()");if(a)throw new Error(a.message);const u=zo(s.requiredNamespaces,n,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!dt(r)){const{message:h}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:i,request:n,chainId:s,expiry:a}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!Bo(u,s)){const{message:h}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!_p(n)){const{message:h}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(h)}if(!wp(u,s,n.method)){const{message:h}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(h)}if(a&&!Dp(a,li)){const{message:h}=V("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${li.min} and ${li.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!bp(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!dt(r)){const{message:u}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(u)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!Bo(a,s)){const{message:u}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(u)}if(!vp(n)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}if(!mp(a,s,n.name)){const{message:u}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.getVerifyContext=async(r,i)=>{const n={verified:{verifyUrl:i.verifyUrl||"",validation:"UNKNOWN",origin:i.url||""}};try{const s=await this.client.core.verify.resolve({attestationId:r,verifyUrl:i.verifyUrl});s&&(n.verified.origin=s,n.verified.validation=s===i.url?"VALID":"INVALID")}catch(s){this.client.logger.error(s)}return this.client.logger.info(`Verify context: ${JSON.stringify(n)}`),n},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Ve(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on($e.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);mn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):si(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(_t.expired,async e=>{const{topic:r,id:i}=Fo(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Ve(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Ve(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ve(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!gp(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Zy extends ai{constructor(e,r){super(e,r,La,ci),this.core=e,this.logger=r}}class e_ extends ai{constructor(e,r){super(e,r,$a,ci),this.core=e,this.logger=r}}class t_ extends ai{constructor(e,r){super(e,r,ja,ci,i=>i.id),this.core=e,this.logger=r}}class hi extends fl{constructor(e){super(e),this.protocol=Pn,this.version=An,this.name=ui.name,this.events=new ht.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||ui.name,this.metadata=e?.metadata||Cd();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:_e.pino(_e.getDefaultLoggerOptions({level:e?.logger||ui.logger}));this.core=e?.core||new By(e),this.logger=_e.generateChildLogger(r,this.name),this.session=new e_(this.core,this.logger),this.proposal=new Zy(this.core,this.logger),this.pendingRequest=new t_(this.core,this.logger),this.engine=new Qy(this)}static async init(e){const r=new hi(e);return await r.initialize(),r}get context(){return _e.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const r_=hi;xe.ENGINE_CONTEXT=Ma,xe.ENGINE_RPC_OPTS=cr,xe.HISTORY_CONTEXT=Hy,xe.HISTORY_EVENTS=Ky,xe.HISTORY_STORAGE_VERSION=Vy,xe.METHODS_TO_VERIFY=Ba,xe.PROPOSAL_CONTEXT=La,xe.PROPOSAL_EXPIRY=Gy,xe.PROPOSAL_EXPIRY_MESSAGE=Ua,xe.REQUEST_CONTEXT=ja,xe.SESSION_CONTEXT=$a,xe.SESSION_EXPIRY=Ur,xe.SESSION_REQUEST_EXPIRY_BOUNDARIES=li,xe.SIGN_CLIENT_CONTEXT=Rn,xe.SIGN_CLIENT_DEFAULT=ui,xe.SIGN_CLIENT_EVENTS=zy,xe.SIGN_CLIENT_PROTOCOL=Pn,xe.SIGN_CLIENT_STORAGE_OPTIONS=qy,xe.SIGN_CLIENT_STORAGE_PREFIX=ci,xe.SIGN_CLIENT_VERSION=An,xe.SignClient=r_,xe.default=hi,Object.defineProperty(xe,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
