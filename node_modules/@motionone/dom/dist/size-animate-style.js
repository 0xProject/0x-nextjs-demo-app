class t{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const e=new WeakMap;function n(t){return e.has(t)||e.set(t,{transforms:[],values:new Map}),e.get(t)}const a={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},i=t=>"number"==typeof t,r=t=>Array.isArray(t)&&!i(t[0]),s=()=>{},o=t=>t,l=t=>"object"==typeof t&&Boolean(t.createAnimation),c=t=>"function"==typeof t,u=t=>1e3*t,f=["","X","Y","Z"],y={x:"translateX",y:"translateY",z:"translateZ"},d={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},p={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:d,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:o},skew:d},h=new Map,g=t=>`--motion-${t}`,m=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{f.forEach((e=>{m.push(t+e),h.set(g(t+e),p[t])}))}));const v=(t,e)=>m.indexOf(t)-m.indexOf(e),w=new Set(m),O=t=>w.has(t),b=t=>t.sort(v).reduce(x,"").trim(),x=(t,e)=>`${t} ${e}(var(${g(e)}))`,A=t=>t.startsWith("--"),D=new Set;const S=(t,e)=>document.createElement("div").animate(t,e),E={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{S({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(S({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{S({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}},P={},V={};for(const t in E)V[t]=()=>(void 0===P[t]&&(P[t]=E[t]()),P[t]);const $=(t,e)=>c(t)?V.linearEasing()?`linear(${((t,e)=>{let n="";const a=Math.round(e/.015);for(let e=0;e<a;e++)n+=t((s=e,(r=a-1)-(i=0)==0?1:(s-i)/(r-i)))+", ";var i,r,s;return n.substring(0,n.length-2)})(t,e)})`:a.easing:(t=>Array.isArray(t)&&i(t[0]))(t)?k(t):t,k=([t,e,n,a])=>`cubic-bezier(${t}, ${e}, ${n}, ${a})`;function U(t){return y[t]&&(t=y[t]),O(t)?g(t):t}const j=(t,e)=>{e=U(e);let n=A(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!n&&0!==n){const t=h.get(e);t&&(n=t.initialValue)}return n},C=(t,e,n)=>{e=U(e),A(e)?t.style.setProperty(e,n):t.style[e]=n};function M(e,f,d,p={},g){const m=window.__MOTION_DEV_TOOLS_RECORD,v=!1!==p.record&&m;let w,{duration:x=a.duration,delay:S=a.delay,endDelay:E=a.endDelay,repeat:P=a.repeat,easing:k=a.easing,persist:M=!1,direction:R,offset:_,allowWebkitAcceleration:z=!1}=p;const W=n(e),B=O(f);let F=V.waapi();B&&((t,e)=>{y[e]&&(e=y[e]);const{transforms:a}=n(t);var i,r;r=e,-1===(i=a).indexOf(r)&&i.push(r),t.style.transform=b(a)})(e,f);const K=U(f),T=function(e,n){return e.has(n)||e.set(n,new t),e.get(n)}(W.values,K),X=h.get(K);return function(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}(T.animation,!(l(k)&&T.generator)&&!1!==p.record),()=>{const t=()=>{var t,n;return null!==(n=null!==(t=j(e,K))&&void 0!==t?t:null==X?void 0:X.initialValue)&&void 0!==n?n:0};let n=function(t,e){for(let n=0;n<t.length;n++)null===t[n]&&(t[n]=n?t[n-1]:e());return t}((t=>Array.isArray(t)?t:[t])(d),t);const a=function(t,e){var n;let a=(null==e?void 0:e.toDefaultUnit)||o;const i=t[t.length-1];if("string"==typeof i){const t=(null===(n=i.match(/(-?[\d.]+)([a-z%]*)/))||void 0===n?void 0:n[2])||"";t&&(a=e=>e+t)}return a}(n,X);if(l(k)){const e=k.createAnimation(n,"opacity"!==f,t,K,T);k=e.easing,n=e.keyframes||n,x=e.duration||x}if(A(K)&&(V.cssRegisterProperty()?function(t){if(!D.has(t)){D.add(t);try{const{syntax:e,initialValue:n}=h.has(t)?h.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:n})}catch(t){}}}(K):F=!1),B&&!V.linearEasing()&&(c(k)||r(k)&&k.some(c))&&(F=!1),F){X&&(n=n.map((t=>i(t)?X.toDefaultUnit(t):t))),1!==n.length||V.partialKeyframes()&&!v||n.unshift(t());const a={delay:u(S),duration:u(x),endDelay:u(E),easing:r(k)?void 0:$(k,x),direction:R,iterations:P+1,fill:"both"};w=e.animate({[K]:n,offset:_,easing:r(k)?k.map((t=>$(t,x))):void 0},a),w.finished||(w.finished=new Promise(((t,e)=>{w.onfinish=t,w.oncancel=e})));const o=n[n.length-1];w.finished.then((()=>{M||(C(e,K,o),w.cancel())})).catch(s),z||(w.playbackRate=1.000001)}else if(g&&B)n=n.map((t=>"string"==typeof t?parseFloat(t):t)),1===n.length&&n.unshift(parseFloat(t())),w=new g((t=>{C(e,K,a?a(t):t)}),n,Object.assign(Object.assign({},p),{duration:x,easing:k}));else{const t=n[n.length-1];C(e,K,X&&i(t)?X.toDefaultUnit(t):t)}return v&&m(e,f,n,{duration:x,delay:S,easing:k,repeat:P,offset:_},"motion-one"),T.setAnimation(w),w}}export{M as animateStyle};
